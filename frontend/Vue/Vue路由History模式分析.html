<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Vue路由History模式分析</title>
    <meta name="description" content="Vite & Vue powered static site generator.">
    <link rel="stylesheet" href="/comK/assets/style.f9323aef.css">
    <link rel="modulepreload" href="/comK/assets/app.02c23f2e.js">
    <link rel="modulepreload" href="/comK/assets/frontend_Vue_Vue路由History模式分析.md.c9a929a8.lean.js">
    
    <meta name="keywords" content="个人博客">
  <link rel="icon" href="./my-logo.png/">
  <script id="check-dark-light">(()=>{const e=localStorage.getItem("vitepress-theme-appearance"),a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-ca9ccb7e><!--[--><!--]--><!--[--><span tabindex="-1" data-v-151f2593></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-151f2593> Skip to content </a><!--]--><!----><header class="VPNav" data-v-ca9ccb7e data-v-a71a30f1><div class="VPNavBar has-sidebar" data-v-a71a30f1 data-v-a35e6f52><div class="container" data-v-a35e6f52><div class="VPNavBarTitle has-sidebar" data-v-a35e6f52 data-v-d5925166><a class="title" href="/comK/" data-v-d5925166><!--[--><!--]--><!--[--><img class="VPImage logo" src="/comK/logo.svg" data-v-e13a1912><!--]--><!--[-->you best！<!--]--><!--[--><!--]--></a></div><div class="content" data-v-a35e6f52><!--[--><!--]--><!----><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-a35e6f52 data-v-f83db6ba><span id="main-nav-aria-label" class="visually-hidden" data-v-f83db6ba>Main Navigation</span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/comK/" data-v-f83db6ba data-v-47a2263e data-v-3c355974><!--[-->首页<!--]--><!----></a><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup active" data-v-f83db6ba data-v-6ffb57d3><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-6ffb57d3><span class="text" data-v-6ffb57d3><!----> 模板分组 <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="text-icon" data-v-6ffb57d3><path d="M12,16c-0.3,0-0.5-0.1-0.7-0.3l-6-6c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l5.3,5.3l5.3-5.3c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-6,6C12.5,15.9,12.3,16,12,16z"></path></svg></span></button><div class="menu" data-v-6ffb57d3><div class="VPMenu" data-v-6ffb57d3 data-v-1c5d0cfc><div class="items" data-v-1c5d0cfc><!--[--><!--[--><div class="VPMenuGroup" data-v-1c5d0cfc data-v-9ca52130><!----><!--[--><!--[--><div class="VPMenuLink" data-v-9ca52130 data-v-e8e0fb1d><a class="VPLink link" href="/comK/frontend/HTML/" data-v-e8e0fb1d data-v-3c355974><!--[-->HTML<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-9ca52130 data-v-e8e0fb1d><a class="VPLink link" href="/comK/frontend/Vue/" data-v-e8e0fb1d data-v-3c355974><!--[-->Vue<!--]--><!----></a></div><!--]--><!--]--></div><!--]--><!--[--><div class="VPMenuLink" data-v-1c5d0cfc data-v-e8e0fb1d><a class="VPLink link" href="/comK/frontend/Webpack/basic.html" data-v-e8e0fb1d data-v-3c355974><!--[-->Webpack<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuGroup" data-v-1c5d0cfc data-v-9ca52130><!----><!--[--><!--[--><div class="VPMenuLink" data-v-9ca52130 data-v-e8e0fb1d><a class="VPLink link" href="/comK/frontend/Pinia/" data-v-e8e0fb1d data-v-3c355974><!--[-->Pinia<!--]--><!----></a></div><!--]--><!--]--></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-f83db6ba data-v-6ffb57d3><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-6ffb57d3><span class="text" data-v-6ffb57d3><!----> 后端 <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="text-icon" data-v-6ffb57d3><path d="M12,16c-0.3,0-0.5-0.1-0.7-0.3l-6-6c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l5.3,5.3l5.3-5.3c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-6,6C12.5,15.9,12.3,16,12,16z"></path></svg></span></button><div class="menu" data-v-6ffb57d3><div class="VPMenu" data-v-6ffb57d3 data-v-1c5d0cfc><div class="items" data-v-1c5d0cfc><!--[--><!--[--><div class="VPMenuGroup" data-v-1c5d0cfc data-v-9ca52130><!----><!--[--><!--[--><div class="VPMenuLink" data-v-9ca52130 data-v-e8e0fb1d><a class="VPLink link" href="/comK/backend/JavaSE/" data-v-e8e0fb1d data-v-3c355974><!--[-->JavaSE<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-9ca52130 data-v-e8e0fb1d><a class="VPLink link" href="/comK/backend/Maven/" data-v-e8e0fb1d data-v-3c355974><!--[-->Maven<!--]--><!----></a></div><!--]--><!--]--></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-f83db6ba data-v-6ffb57d3><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-6ffb57d3><span class="text" data-v-6ffb57d3><!----> 工具软件 <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="text-icon" data-v-6ffb57d3><path d="M12,16c-0.3,0-0.5-0.1-0.7-0.3l-6-6c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l5.3,5.3l5.3-5.3c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-6,6C12.5,15.9,12.3,16,12,16z"></path></svg></span></button><div class="menu" data-v-6ffb57d3><div class="VPMenu" data-v-6ffb57d3 data-v-1c5d0cfc><div class="items" data-v-1c5d0cfc><!--[--><!--[--><div class="VPMenuGroup" data-v-1c5d0cfc data-v-9ca52130><!----><!--[--><!--[--><div class="VPMenuLink" data-v-9ca52130 data-v-e8e0fb1d><a class="VPLink link" href="/comK/toolSoftware/Linux/" data-v-e8e0fb1d data-v-3c355974><!--[-->linux<!--]--><!----></a></div><!--]--><!--]--></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-f83db6ba data-v-6ffb57d3><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-6ffb57d3><span class="text" data-v-6ffb57d3><!----> 插件扩展 <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="text-icon" data-v-6ffb57d3><path d="M12,16c-0.3,0-0.5-0.1-0.7-0.3l-6-6c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l5.3,5.3l5.3-5.3c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-6,6C12.5,15.9,12.3,16,12,16z"></path></svg></span></button><div class="menu" data-v-6ffb57d3><div class="VPMenu" data-v-6ffb57d3 data-v-1c5d0cfc><div class="items" data-v-1c5d0cfc><!--[--><!--[--><div class="VPMenuGroup" data-v-1c5d0cfc data-v-9ca52130><!----><!--[--><!--[--><div class="VPMenuLink" data-v-9ca52130 data-v-e8e0fb1d><a class="VPLink link" href="/comK/PlugInExtension/tuiEditor/" data-v-e8e0fb1d data-v-3c355974><!--[-->tui.editor<!--]--><!----></a></div><!--]--><!--]--></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="https://www.jianshu.com/u/94f29127275f" target="_blank" rel="noreferrer" data-v-f83db6ba data-v-47a2263e data-v-3c355974><!--[-->简书<!--]--><!----></a><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-a35e6f52 data-v-a3e7452b><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" aria-label="toggle dark mode" data-v-a3e7452b data-v-968780f1 data-v-086e8519><span class="check" data-v-086e8519><span class="icon" data-v-086e8519><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-968780f1><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-968780f1><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-a35e6f52 data-v-738bef5a data-v-f6988cfb><!--[--><a class="VPSocialLink" href="https://baidu.com" target="_blank" rel="noopener" data-v-f6988cfb data-v-e57698f6><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-a35e6f52 data-v-e89b88d7 data-v-6ffb57d3><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-6ffb57d3><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="icon" data-v-6ffb57d3><circle cx="12" cy="12" r="2"></circle><circle cx="19" cy="12" r="2"></circle><circle cx="5" cy="12" r="2"></circle></svg></button><div class="menu" data-v-6ffb57d3><div class="VPMenu" data-v-6ffb57d3 data-v-1c5d0cfc><!----><!--[--><!--[--><!----><div class="group" data-v-e89b88d7><div class="item appearance" data-v-e89b88d7><p class="label" data-v-e89b88d7>Appearance</p><div class="appearance-action" data-v-e89b88d7><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" aria-label="toggle dark mode" data-v-e89b88d7 data-v-968780f1 data-v-086e8519><span class="check" data-v-086e8519><span class="icon" data-v-086e8519><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-968780f1><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-968780f1><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div></div></div><div class="group" data-v-e89b88d7><div class="item social-links" data-v-e89b88d7><div class="VPSocialLinks social-links-list" data-v-e89b88d7 data-v-f6988cfb><!--[--><a class="VPSocialLink" href="https://baidu.com" target="_blank" rel="noopener" data-v-f6988cfb data-v-e57698f6><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-a35e6f52 data-v-e5dd9c1c><span class="container" data-v-e5dd9c1c><span class="top" data-v-e5dd9c1c></span><span class="middle" data-v-e5dd9c1c></span><span class="bottom" data-v-e5dd9c1c></span></span></button></div></div></div><!----></header><div class="VPLocalNav" data-v-ca9ccb7e data-v-aac27d5e><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-aac27d5e><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="menu-icon" data-v-aac27d5e><path d="M17,11H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h14c0.6,0,1,0.4,1,1S17.6,11,17,11z"></path><path d="M21,7H3C2.4,7,2,6.6,2,6s0.4-1,1-1h18c0.6,0,1,0.4,1,1S21.6,7,21,7z"></path><path d="M21,15H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h18c0.6,0,1,0.4,1,1S21.6,15,21,15z"></path><path d="M17,19H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h14c0.6,0,1,0.4,1,1S17.6,19,17,19z"></path></svg><span class="menu-text" data-v-aac27d5e>Menu</span></button><a class="top-link" href="#" data-v-aac27d5e> Return to top </a></div><aside class="VPSidebar" data-v-ca9ccb7e data-v-f332cb62><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-f332cb62><span class="visually-hidden" id="sidebar-aria-label" data-v-f332cb62> Sidebar Navigation </span><!--[--><div class="group" data-v-f332cb62><section class="VPSidebarGroup collapsible" data-v-f332cb62 data-v-2976c796><div class="title" role="button" data-v-2976c796><h2 class="title-text" data-v-2976c796>第一章</h2><div class="action" data-v-2976c796><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 24 24" class="icon minus" data-v-2976c796><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2zM20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h8c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg><svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="icon plus" data-v-2976c796><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2z M20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11h-3V8c0-0.6-0.4-1-1-1s-1,0.4-1,1v3H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h3v3c0,0.6,0.4,1,1,1s1-0.4,1-1v-3h3c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg></div></div><div class="items" data-v-2976c796><!--[--><a class="VPLink link link" href="/comK/frontend/Vue/" data-v-2976c796 data-v-f7e544fc data-v-3c355974><!--[--><span class="link-text" data-v-f7e544fc>Router初体验</span><!----><!--]--><!----></a><a class="VPLink link link" href="/comK/frontend/Vue/%E5%AF%B9keep-alive%E7%BB%84%E4%BB%B6%E7%9A%84%E7%90%86%E8%A7%A3.html" data-v-2976c796 data-v-f7e544fc data-v-3c355974><!--[--><span class="link-text" data-v-f7e544fc>对keep-alive组件的理解</span><!----><!--]--><!----></a><a class="VPLink link link" href="/comK/frontend/Vue/%E6%9C%8D%E5%8A%A1%E7%AB%AF%E6%B8%B2%E6%9F%93SSR%E7%9A%84%E7%90%86%E8%A7%A3.html" data-v-2976c796 data-v-f7e544fc data-v-3c355974><!--[--><span class="link-text" data-v-f7e544fc>服务端渲染SSR的理解</span><!----><!--]--><!----></a><a class="VPLink link link" href="/comK/frontend/Vue/data%E4%B8%BA%E4%BD%95%E4%BB%A5%E5%87%BD%E6%95%B0%E5%BD%A2%E5%BC%8F%E8%BF%94%E5%9B%9E.html" data-v-2976c796 data-v-f7e544fc data-v-3c355974><!--[--><span class="link-text" data-v-f7e544fc>data为何以函数形式返回</span><!----><!--]--><!----></a><a class="VPLink link link" href="/comK/frontend/Vue/MVVM%E6%A8%A1%E5%BC%8F%E7%9A%84%E7%90%86%E8%A7%A3.html" data-v-2976c796 data-v-f7e544fc data-v-3c355974><!--[--><span class="link-text" data-v-f7e544fc>MVVM模式的理解</span><!----><!--]--><!----></a><a class="VPLink link link" href="/comK/frontend/Vue/SPA%E5%8D%95%E9%A1%B5%E5%BA%94%E7%94%A8%E7%9A%84%E4%BC%98%E7%BC%BA%E7%82%B9.html" data-v-2976c796 data-v-f7e544fc data-v-3c355974><!--[--><span class="link-text" data-v-f7e544fc>SPA单页应用的优缺点</span><!----><!--]--><!----></a><a class="VPLink link link" href="/comK/frontend/Vue/v-html%E5%8F%AF%E8%83%BD%E5%AF%BC%E8%87%B4%E7%9A%84%E9%97%AE%E9%A2%98.html" data-v-2976c796 data-v-f7e544fc data-v-3c355974><!--[--><span class="link-text" data-v-f7e544fc>v-html可能导致的问题</span><!----><!--]--><!----></a><a class="VPLink link link" href="/comK/frontend/Vue/v-if%E4%B8%8Ev-show%E7%9A%84%E5%8C%BA%E5%88%AB.html" data-v-2976c796 data-v-f7e544fc data-v-3c355974><!--[--><span class="link-text" data-v-f7e544fc>v-if与v-show的区别</span><!----><!--]--><!----></a><a class="VPLink link link" href="/comK/frontend/Vue/v-model%E6%95%B0%E6%8D%AE%E7%BB%91%E5%AE%9A%E5%88%86%E6%9E%90.html" data-v-2976c796 data-v-f7e544fc data-v-3c355974><!--[--><span class="link-text" data-v-f7e544fc>v-model数据绑定分析</span><!----><!--]--><!----></a><!--]--></div></section></div><div class="group" data-v-f332cb62><section class="VPSidebarGroup collapsible" data-v-f332cb62 data-v-2976c796><div class="title" role="button" data-v-2976c796><h2 class="title-text" data-v-2976c796>第二章</h2><div class="action" data-v-2976c796><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 24 24" class="icon minus" data-v-2976c796><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2zM20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h8c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg><svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="icon plus" data-v-2976c796><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2z M20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11h-3V8c0-0.6-0.4-1-1-1s-1,0.4-1,1v3H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h3v3c0,0.6,0.4,1,1,1s1-0.4,1-1v-3h3c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg></div></div><div class="items" data-v-2976c796><!--[--><a class="VPLink link link" href="/comK/frontend/Vue/Vue3.0%E6%96%B0%E7%89%B9%E6%80%A7.html" data-v-2976c796 data-v-f7e544fc data-v-3c355974><!--[--><span class="link-text" data-v-f7e544fc>Vue3.0新特性</span><!----><!--]--><!----></a><a class="VPLink link link" href="/comK/frontend/Vue/Vue%E5%B8%B8%E7%94%A8%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96.html" data-v-2976c796 data-v-f7e544fc data-v-3c355974><!--[--><span class="link-text" data-v-f7e544fc>Vue常用性能优化</span><!----><!--]--><!----></a><a class="VPLink link link" href="/comK/frontend/Vue/Vue%E7%88%B6%E5%AD%90%E7%BB%84%E4%BB%B6%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F.html" data-v-2976c796 data-v-f7e544fc data-v-3c355974><!--[--><span class="link-text" data-v-f7e544fc>Vue父子组件生命周期</span><!----><!--]--><!----></a><a class="VPLink link link" href="/comK/frontend/Vue/Vue%E8%B7%AF%E7%94%B1%E6%87%92%E5%8A%A0%E8%BD%BD.html" data-v-2976c796 data-v-f7e544fc data-v-3c355974><!--[--><span class="link-text" data-v-f7e544fc>Vue路由懒加载</span><!----><!--]--><!----></a><a class="VPLink link link" href="/comK/frontend/Vue/Vue%E8%B7%AF%E7%94%B1Hash%E6%A8%A1%E5%BC%8F%E5%88%86%E6%9E%90.html" data-v-2976c796 data-v-f7e544fc data-v-3c355974><!--[--><span class="link-text" data-v-f7e544fc>Vue路由Hash模式分析</span><!----><!--]--><!----></a><a class="VPLink link link active" href="/comK/frontend/Vue/Vue%E8%B7%AF%E7%94%B1History%E6%A8%A1%E5%BC%8F%E5%88%86%E6%9E%90.html" data-v-2976c796 data-v-f7e544fc data-v-3c355974><!--[--><span class="link-text" data-v-f7e544fc>Vue路由History模式分析</span><!----><!--]--><!----></a><a class="VPLink link link" href="/comK/frontend/Vue/Vue%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F.html" data-v-2976c796 data-v-f7e544fc data-v-3c355974><!--[--><span class="link-text" data-v-f7e544fc>Vue生命周期</span><!----><!--]--><!----></a><a class="VPLink link link" href="/comK/frontend/Vue/Vue%E4%BA%8B%E4%BB%B6%E7%BB%91%E5%AE%9A%E5%8E%9F%E7%90%86.html" data-v-2976c796 data-v-f7e544fc data-v-3c355974><!--[--><span class="link-text" data-v-f7e544fc>Vue事件绑定原理</span><!----><!--]--><!----></a><a class="VPLink link link" href="/comK/frontend/Vue/Vue%E9%A6%96%E5%B1%8F%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E7%BB%84%E4%BB%B6.html" data-v-2976c796 data-v-f7e544fc data-v-3c355974><!--[--><span class="link-text" data-v-f7e544fc>Vue首屏性能优化组件</span><!----><!--]--><!----></a><a class="VPLink link link" href="/comK/frontend/Vue/Vue%E6%95%B0%E6%8D%AE%E5%8F%8C%E5%90%91%E7%BB%91%E5%AE%9A.html" data-v-2976c796 data-v-f7e544fc data-v-3c355974><!--[--><span class="link-text" data-v-f7e544fc>Vue数据双向绑定</span><!----><!--]--><!----></a><a class="VPLink link link" href="/comK/frontend/Vue/Vue%E4%B8%BA%E4%BD%95%E9%87%87%E7%94%A8%E5%BC%82%E6%AD%A5%E6%B8%B2%E6%9F%93.html" data-v-2976c796 data-v-f7e544fc data-v-3c355974><!--[--><span class="link-text" data-v-f7e544fc>Vue为何采用异步渲染</span><!----><!--]--><!----></a><a class="VPLink link link" href="/comK/frontend/Vue/Vue%E4%B8%ADnextTick%E7%9A%84%E7%90%86%E8%A7%A3.html" data-v-2976c796 data-v-f7e544fc data-v-3c355974><!--[--><span class="link-text" data-v-f7e544fc>Vue中$nextTick的理解</span><!----><!--]--><!----></a><a class="VPLink link link" href="/comK/frontend/Vue/Vue%E4%B8%ADrefs%E7%9A%84%E7%90%86%E8%A7%A3.html" data-v-2976c796 data-v-f7e544fc data-v-3c355974><!--[--><span class="link-text" data-v-f7e544fc>Vue中$refs的理解</span><!----><!--]--><!----></a><!--]--></div></section></div><div class="group" data-v-f332cb62><section class="VPSidebarGroup collapsible" data-v-f332cb62 data-v-2976c796><div class="title" role="button" data-v-2976c796><h2 class="title-text" data-v-2976c796>第三章</h2><div class="action" data-v-2976c796><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 24 24" class="icon minus" data-v-2976c796><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2zM20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h8c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg><svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="icon plus" data-v-2976c796><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2z M20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11h-3V8c0-0.6-0.4-1-1-1s-1,0.4-1,1v3H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h3v3c0,0.6,0.4,1,1,1s1-0.4,1-1v-3h3c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg></div></div><div class="items" data-v-2976c796><!--[--><a class="VPLink link link" href="/comK/frontend/Vue/Vue%E4%B8%AD%E7%9A%84%E4%B8%89%E7%A7%8DWatcher.html" data-v-2976c796 data-v-f7e544fc data-v-3c355974><!--[--><span class="link-text" data-v-f7e544fc>Vue中的三种Watcher</span><!----><!--]--><!----></a><a class="VPLink link link" href="/comK/frontend/Vue/Vue%E4%B8%AD%E6%95%B0%E7%BB%84%E5%8F%98%E5%8A%A8%E7%9B%91%E5%90%AC.html" data-v-2976c796 data-v-f7e544fc data-v-3c355974><!--[--><span class="link-text" data-v-f7e544fc>Vue中数组变动监听</span><!----><!--]--><!----></a><a class="VPLink link link" href="/comK/frontend/Vue/Vue%E4%B8%AD%E8%99%9A%E6%8B%9FDOM%E7%9A%84%E7%90%86%E8%A7%A3.html" data-v-2976c796 data-v-f7e544fc data-v-3c355974><!--[--><span class="link-text" data-v-f7e544fc>Vue中虚拟DOM的理解</span><!----><!--]--><!----></a><a class="VPLink link link" href="/comK/frontend/Vue/Vue%E4%B8%AD%E7%BB%84%E4%BB%B6%E9%97%B4%E9%80%9A%E4%BF%A1%E7%9A%84%E6%96%B9%E5%BC%8F.html" data-v-2976c796 data-v-f7e544fc data-v-3c355974><!--[--><span class="link-text" data-v-f7e544fc>Vue中组件间通信的方式</span><!----><!--]--><!----></a><a class="VPLink link link" href="/comK/frontend/Vue/Vue%E4%B8%ADcomputed%E5%88%86%E6%9E%90.html" data-v-2976c796 data-v-f7e544fc data-v-3c355974><!--[--><span class="link-text" data-v-f7e544fc>Vue中computed分析</span><!----><!--]--><!----></a><a class="VPLink link link" href="/comK/frontend/Vue/Vue%E4%B8%ADdiff%E7%AE%97%E6%B3%95%E7%9A%84%E7%90%86%E8%A7%A3.html" data-v-2976c796 data-v-f7e544fc data-v-3c355974><!--[--><span class="link-text" data-v-f7e544fc>Vue中diff算法的理解</span><!----><!--]--><!----></a><a class="VPLink link link" href="/comK/frontend/Vue/Vue%E4%B8%ADkey%E7%9A%84%E4%BD%9C%E7%94%A8.html" data-v-2976c796 data-v-f7e544fc data-v-3c355974><!--[--><span class="link-text" data-v-f7e544fc>Vue中key的作用</span><!----><!--]--><!----></a><a class="VPLink link link" href="/comK/frontend/Vue/VueRouter%E5%AF%BC%E8%88%AA%E5%AE%88%E5%8D%AB.html" data-v-2976c796 data-v-f7e544fc data-v-3c355974><!--[--><span class="link-text" data-v-f7e544fc>VueRouter导航守卫</span><!----><!--]--><!----></a><a class="VPLink link link" href="/comK/frontend/Vue/Vuex%E5%92%8C%E6%99%AE%E9%80%9A%E5%85%A8%E5%B1%80%E5%AF%B9%E8%B1%A1.html" data-v-2976c796 data-v-f7e544fc data-v-3c355974><!--[--><span class="link-text" data-v-f7e544fc>Vuex和普通全局对象</span><!----><!--]--><!----></a><a class="VPLink link link" href="/comK/frontend/Vue/Vuex%E4%B8%AD%E7%9A%84%E6%A0%B8%E5%BF%83%E6%96%B9%E6%B3%95.html" data-v-2976c796 data-v-f7e544fc data-v-3c355974><!--[--><span class="link-text" data-v-f7e544fc>Vuex中的核心方法</span><!----><!--]--><!----></a><!--]--></div></section></div><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-ca9ccb7e data-v-407bd980><div class="VPDoc has-sidebar has-aside" data-v-407bd980 data-v-f0af2311><div class="container" data-v-f0af2311><div class="aside" data-v-f0af2311><div class="aside-curtain" data-v-f0af2311></div><div class="aside-container" data-v-f0af2311><div class="aside-content" data-v-f0af2311><div class="VPDocAside" data-v-f0af2311 data-v-aea49c31><!--[--><!--]--><!--[--><!--]--><div class="VPDocAsideOutline has-outline" data-v-aea49c31 data-v-a3de185c><div class="content" data-v-a3de185c><div class="outline-marker" data-v-a3de185c></div><div class="outline-title" data-v-a3de185c>在本页面</div><nav aria-labelledby="doc-outline-aria-label" data-v-a3de185c><span class="visually-hidden" id="doc-outline-aria-label" data-v-a3de185c> Table of Contents for current page </span><ul class="root" data-v-a3de185c><!--[--><li data-v-a3de185c><a class="outline-link" href="#描述" data-v-a3de185c>描述</a><!----></li><li data-v-a3de185c><a class="outline-link" href="#分析" data-v-a3de185c>分析</a><!----></li><li data-v-a3de185c><a class="outline-link" href="#参考" data-v-a3de185c>参考</a><!----></li><!--]--></ul></nav></div></div><!--[--><!--]--><div class="spacer" data-v-aea49c31></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-f0af2311><div class="content-container" data-v-f0af2311><!--[--><!--]--><main class="main" data-v-f0af2311><div style="position:relative;" class="vp-doc _comK_frontend_Vue_Vue%E8%B7%AF%E7%94%B1History%E6%A8%A1%E5%BC%8F%E5%88%86%E6%9E%90" data-v-f0af2311><div><h1 id="vue路由history模式分析" tabindex="-1">Vue路由History模式分析 <a class="header-anchor" href="#vue路由history模式分析" aria-hidden="true">#</a></h1><p><code>Vue-router</code>是<code>Vue</code>的核心组件，主要是作为<code>Vue</code>的路由管理器，<code>Vue-router</code>默认<code>hash</code>模式，通过引入<code>Vue-router</code>对象模块时配置<code>mode</code>属性可以启用<code>history</code>模式。</p><h2 id="描述" tabindex="-1">描述 <a class="header-anchor" href="#描述" aria-hidden="true">#</a></h2><p><code>Vue-router</code>的<code>hash</code>模式使用<code>URL</code>的<code>Hash</code>来模拟一个完整的<code>URL</code>，当<code>URL</code>改变时页面不会重新加载，而<code>Vue-router</code>的<code>history</code>模式是充分利用<code>history.pushState</code>的<code>API</code>来完成<code>URL</code>跳转，同样在页面跳转时无须重新加载页面，当然也不会对于服务端进行请求，当然对于<code>history</code>模式仍然是需要后端的配置支持，由于应用是个单页客户端应用，如果后台没有正确的配置，当用户在浏览器直接访问<code>URL</code>时就会返回<code>404</code>，所以需要在服务端增加一个覆盖所有情况的候选资源，如果<code>URL</code>匹配不到任何静态资源时，则应该返回同一个<code>index.html</code>应用依赖页面，例如在<code>Nginx</code>下的配置。</p><div class="language- line-numbers-mode"><button class="copy"></button><span class="lang"></span><pre><code><span class="line"><span style="color:#c9d1d9;">location / {</span></span>
<span class="line"><span style="color:#c9d1d9;">  try_files $uri $uri/ /index.html;</span></span>
<span class="line"><span style="color:#c9d1d9;">}</span></span>
<span class="line"><span style="color:#c9d1d9;"></span></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="分析" tabindex="-1">分析 <a class="header-anchor" href="#分析" aria-hidden="true">#</a></h2><p><code>Vue-router</code>源码的实现比较复杂，会处理各种兼容问题与异常以及各种条件分支，文章分析比较核心的代码部分，精简过后的版本，重要部分做出注释，<code>commit id</code>为<code>560d11d</code>。</p><p>首先是在定义<code>Router</code>时调用<code>Vue.use(VueRouter)</code>，这是<code>Vue.js</code>插件的经典写法，给插件对象增加<code>install</code>方法用来安装插件具体逻辑，此时会调用<code>VueRouter</code>类上的静态方法，即<code>VueRouter.install = install</code>，<code>install</code>模块主要是保证<code>Vue-router</code>只被<code>use</code>一次，以及通过<code>mixin</code>在<code>Vue</code>的生命周期<code>beforeCreate</code>内注册实例，在<code>destroyed</code>内销毁实例，还有定义<code>$router</code>与<code>$route</code>属性为只读属性以及<code>&lt;router-view&gt;</code>与<code>&lt;router-link&gt;</code>全局组件的注册。</p><div class="language-javascript line-numbers-mode"><button class="copy"></button><span class="lang">javascript</span><pre><code><span class="line"><span style="color:#8B949E;">// dev/src/install.js line 6</span></span>
<span class="line"><span style="color:#FF7B72;">export</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">function</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">install</span><span style="color:#C9D1D9;"> (</span><span style="color:#FFA657;">Vue</span><span style="color:#C9D1D9;">) {</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (install.installed </span><span style="color:#FF7B72;">&amp;&amp;</span><span style="color:#C9D1D9;"> _Vue </span><span style="color:#FF7B72;">===</span><span style="color:#C9D1D9;"> Vue) </span><span style="color:#FF7B72;">return</span></span>
<span class="line"><span style="color:#C9D1D9;">  install.installed </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">true</span><span style="color:#C9D1D9;"> </span><span style="color:#8B949E;">// 保证 Vue-router 只被 use 一次</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C9D1D9;">  _Vue </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> Vue</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">isDef</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> </span><span style="color:#FFA657;">v</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=&gt;</span><span style="color:#C9D1D9;"> v </span><span style="color:#FF7B72;">!==</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">undefined</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">registerInstance</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> (</span><span style="color:#FFA657;">vm</span><span style="color:#C9D1D9;">, </span><span style="color:#FFA657;">callVal</span><span style="color:#C9D1D9;">) </span><span style="color:#FF7B72;">=&gt;</span><span style="color:#C9D1D9;"> {</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">let</span><span style="color:#C9D1D9;"> i </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> vm.$options._parentVnode</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (</span><span style="color:#D2A8FF;">isDef</span><span style="color:#C9D1D9;">(i) </span><span style="color:#FF7B72;">&amp;&amp;</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">isDef</span><span style="color:#C9D1D9;">(i </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> i.data) </span><span style="color:#FF7B72;">&amp;&amp;</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">isDef</span><span style="color:#C9D1D9;">(i </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> i.registerRouteInstance)) {</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#D2A8FF;">i</span><span style="color:#C9D1D9;">(vm, callVal)</span></span>
<span class="line"><span style="color:#C9D1D9;">    }</span></span>
<span class="line"><span style="color:#C9D1D9;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C9D1D9;">  Vue.</span><span style="color:#D2A8FF;">mixin</span><span style="color:#C9D1D9;">({</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#D2A8FF;">beforeCreate</span><span style="color:#C9D1D9;"> () { </span><span style="color:#8B949E;">// 注册实例</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (</span><span style="color:#D2A8FF;">isDef</span><span style="color:#C9D1D9;">(</span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">.$options.router)) { </span><span style="color:#8B949E;">// this.$options.router 来自于 VueRouter 的实例化 // 判断实例是否已经挂载</span></span>
<span class="line"><span style="color:#C9D1D9;">        </span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">._routerRoot </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">this</span></span>
<span class="line"><span style="color:#C9D1D9;">        </span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">._router </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">.$options.router</span></span>
<span class="line"><span style="color:#C9D1D9;">        </span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">._router.</span><span style="color:#D2A8FF;">init</span><span style="color:#C9D1D9;">(</span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">) </span><span style="color:#8B949E;">// // 调用 VueRouter 的 init 方法 // 后文会说明 init 方法的作用</span></span>
<span class="line"><span style="color:#C9D1D9;">        Vue.util.</span><span style="color:#D2A8FF;">defineReactive</span><span style="color:#C9D1D9;">(</span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">, </span><span style="color:#A5D6FF;">&#39;_route&#39;</span><span style="color:#C9D1D9;">, </span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">._router.history.current)</span></span>
<span class="line"><span style="color:#C9D1D9;">      } </span><span style="color:#FF7B72;">else</span><span style="color:#C9D1D9;"> {</span></span>
<span class="line"><span style="color:#C9D1D9;">        </span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">._routerRoot </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> (</span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">.$parent </span><span style="color:#FF7B72;">&amp;&amp;</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">.$parent._routerRoot) </span><span style="color:#FF7B72;">||</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;"> </span><span style="color:#8B949E;">// 将组件的 _routerRoot 都指向根 Vue 实例</span></span>
<span class="line"><span style="color:#C9D1D9;">      }</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#D2A8FF;">registerInstance</span><span style="color:#C9D1D9;">(</span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">, </span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">)</span></span>
<span class="line"><span style="color:#C9D1D9;">    },</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#D2A8FF;">destroyed</span><span style="color:#C9D1D9;"> () { </span><span style="color:#8B949E;">// 销毁实例 即挂载undefined</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#D2A8FF;">registerInstance</span><span style="color:#C9D1D9;">(</span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">)</span></span>
<span class="line"><span style="color:#C9D1D9;">    }</span></span>
<span class="line"><span style="color:#C9D1D9;">  })</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C9D1D9;">  Object.</span><span style="color:#D2A8FF;">defineProperty</span><span style="color:#C9D1D9;">(</span><span style="color:#79C0FF;">Vue</span><span style="color:#C9D1D9;">.</span><span style="color:#79C0FF;">prototype</span><span style="color:#C9D1D9;">, </span><span style="color:#A5D6FF;">&#39;$router&#39;</span><span style="color:#C9D1D9;">, {</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#D2A8FF;">get</span><span style="color:#C9D1D9;"> () { </span><span style="color:#FF7B72;">return</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">._routerRoot._router }</span></span>
<span class="line"><span style="color:#C9D1D9;">  })</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C9D1D9;">  Object.</span><span style="color:#D2A8FF;">defineProperty</span><span style="color:#C9D1D9;">(</span><span style="color:#79C0FF;">Vue</span><span style="color:#C9D1D9;">.</span><span style="color:#79C0FF;">prototype</span><span style="color:#C9D1D9;">, </span><span style="color:#A5D6FF;">&#39;$route&#39;</span><span style="color:#C9D1D9;">, {</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#D2A8FF;">get</span><span style="color:#C9D1D9;"> () { </span><span style="color:#FF7B72;">return</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">._routerRoot._route }</span></span>
<span class="line"><span style="color:#C9D1D9;">  })</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C9D1D9;">  Vue.</span><span style="color:#D2A8FF;">component</span><span style="color:#C9D1D9;">(</span><span style="color:#A5D6FF;">&#39;RouterView&#39;</span><span style="color:#C9D1D9;">, View) </span><span style="color:#8B949E;">// 注册全局组件 &lt;router-view&gt;</span></span>
<span class="line"><span style="color:#C9D1D9;">  Vue.</span><span style="color:#D2A8FF;">component</span><span style="color:#C9D1D9;">(</span><span style="color:#A5D6FF;">&#39;RouterLink&#39;</span><span style="color:#C9D1D9;">, Link) </span><span style="color:#8B949E;">// 注册全局组件 &lt;router-link&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">strats</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> Vue.config.optionMergeStrategies</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#8B949E;">// use the same hook merging strategy for route hooks</span></span>
<span class="line"><span style="color:#C9D1D9;">  strats.beforeRouteEnter </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> strats.beforeRouteLeave </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> strats.beforeRouteUpdate </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> strats.created</span></span>
<span class="line"><span style="color:#C9D1D9;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br></div></div><p>之后是<code>VueRouter</code>对象的构造函数，主要是先获取<code>mode</code>的值，如果<code>mode</code>的值为<code>history</code>但是浏览器不支持<code>history</code>模式,那么就强制设置<code>mode</code>值为<code>hash</code>，接下来根据<code>mode</code>的值，来选择<code>vue-router</code>使用哪种模式。</p><div class="language-javascript line-numbers-mode"><button class="copy"></button><span class="lang">javascript</span><pre><code><span class="line"><span style="color:#8B949E;">// dev/src/index.js line 40</span></span>
<span class="line"><span style="color:#D2A8FF;">constructor</span><span style="color:#C9D1D9;"> (options: RouterOptions </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> {}) {</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">.app </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">null</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">.apps </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> []</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">.options </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> options</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">.beforeHooks </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> []</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">.resolveHooks </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> []</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">.afterHooks </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> []</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">.matcher </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">createMatcher</span><span style="color:#C9D1D9;">(options.routes </span><span style="color:#FF7B72;">||</span><span style="color:#C9D1D9;"> [], </span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">) </span><span style="color:#8B949E;">// 创建路由匹配对象</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">let</span><span style="color:#C9D1D9;"> mode </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> options.mode </span><span style="color:#FF7B72;">||</span><span style="color:#C9D1D9;"> </span><span style="color:#A5D6FF;">&#39;hash&#39;</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">.fallback </span><span style="color:#FF7B72;">=</span></span>
<span class="line"><span style="color:#C9D1D9;">    mode </span><span style="color:#FF7B72;">===</span><span style="color:#C9D1D9;"> </span><span style="color:#A5D6FF;">&#39;history&#39;</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">&amp;&amp;</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">!</span><span style="color:#C9D1D9;">supportsPushState </span><span style="color:#FF7B72;">&amp;&amp;</span><span style="color:#C9D1D9;"> options.fallback </span><span style="color:#FF7B72;">!==</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">false</span><span style="color:#C9D1D9;"> </span><span style="color:#8B949E;">// 检车兼容</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (</span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">.fallback) {</span></span>
<span class="line"><span style="color:#C9D1D9;">    mode </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> </span><span style="color:#A5D6FF;">&#39;hash&#39;</span></span>
<span class="line"><span style="color:#C9D1D9;">  }</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (</span><span style="color:#FF7B72;">!</span><span style="color:#C9D1D9;">inBrowser) {</span></span>
<span class="line"><span style="color:#C9D1D9;">    mode </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> </span><span style="color:#A5D6FF;">&#39;abstract&#39;</span></span>
<span class="line"><span style="color:#C9D1D9;">  }</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">.mode </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> mode</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">switch</span><span style="color:#C9D1D9;"> (mode) {</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">case</span><span style="color:#C9D1D9;"> </span><span style="color:#A5D6FF;">&#39;history&#39;</span><span style="color:#C9D1D9;">:</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">.history </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">new</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">HTML5History</span><span style="color:#C9D1D9;">(</span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">, options.base) </span><span style="color:#8B949E;">// 实例化history模式</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#FF7B72;">break</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">case</span><span style="color:#C9D1D9;"> </span><span style="color:#A5D6FF;">&#39;hash&#39;</span><span style="color:#C9D1D9;">:</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">.history </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">new</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">HashHistory</span><span style="color:#C9D1D9;">(</span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">, options.base, </span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">.fallback) </span><span style="color:#8B949E;">// 实例化Hash模式</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#FF7B72;">break</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">case</span><span style="color:#C9D1D9;"> </span><span style="color:#A5D6FF;">&#39;abstract&#39;</span><span style="color:#C9D1D9;">:</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">.history </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">new</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">AbstractHistory</span><span style="color:#C9D1D9;">(</span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">, options.base)</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#FF7B72;">break</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">default</span><span style="color:#C9D1D9;">:</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (p<wbr>rocess.env.</span><span style="color:#79C0FF;">NODE_ENV</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">!==</span><span style="color:#C9D1D9;"> </span><span style="color:#A5D6FF;">&#39;production&#39;</span><span style="color:#C9D1D9;">) {</span></span>
<span class="line"><span style="color:#C9D1D9;">        </span><span style="color:#D2A8FF;">assert</span><span style="color:#C9D1D9;">(</span><span style="color:#79C0FF;">false</span><span style="color:#C9D1D9;">, </span><span style="color:#A5D6FF;">`invalid mode: ${</span><span style="color:#C9D1D9;">mode</span><span style="color:#A5D6FF;">}`</span><span style="color:#C9D1D9;">)</span></span>
<span class="line"><span style="color:#C9D1D9;">      }</span></span>
<span class="line"><span style="color:#C9D1D9;">  }</span></span>
<span class="line"><span style="color:#C9D1D9;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br></div></div><p>在构造函数中调用了创建路由匹配对象的方法<code>createMatcher</code>，而在<code>createMatcher</code>中又调用了实际用以创建路由映射表的方法<code>createRouteMap</code>，可以说<code>createMatcher</code>函数的作用就是创建路由映射表，然后通过闭包的方式让<code>addRoutes</code>和<code>match</code>函数能够使用路由映射表的几个对象，最后返回一个<code>Matcher</code>对象。</p><div class="language-javascript line-numbers-mode"><button class="copy"></button><span class="lang">javascript</span><pre><code><span class="line"><span style="color:#8B949E;">// dev/src/create-matcher.js line 16</span></span>
<span class="line"><span style="color:#FF7B72;">export</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">function</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">createMatcher</span><span style="color:#C9D1D9;"> (</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FFA657;">routes</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#FFA657;">Array</span><span style="color:#C9D1D9;">&lt;</span><span style="color:#FFA657;">RouteConfig</span><span style="color:#C9D1D9;">&gt;,</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FFA657;">router</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#FFA657;">VueRouter</span></span>
<span class="line"><span style="color:#C9D1D9;">)</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#FFA657;">Matcher</span><span style="color:#C9D1D9;"> {</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> { </span><span style="color:#79C0FF;">pathList</span><span style="color:#C9D1D9;">, </span><span style="color:#79C0FF;">pathMap</span><span style="color:#C9D1D9;">, </span><span style="color:#79C0FF;">nameMap</span><span style="color:#C9D1D9;"> } </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">createRouteMap</span><span style="color:#C9D1D9;">(routes) </span><span style="color:#8B949E;">// 创建路由映射表</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">function</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">addRoutes</span><span style="color:#C9D1D9;"> (</span><span style="color:#FFA657;">routes</span><span style="color:#C9D1D9;">) {</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#D2A8FF;">createRouteMap</span><span style="color:#C9D1D9;">(routes, pathList, pathMap, nameMap)</span></span>
<span class="line"><span style="color:#C9D1D9;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">function</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">match</span><span style="color:#C9D1D9;"> ( </span><span style="color:#8B949E;">// 路由匹配</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FFA657;">raw</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#FFA657;">RawLocation</span><span style="color:#C9D1D9;">,</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FFA657;">currentRoute</span><span style="color:#FF7B72;">?:</span><span style="color:#C9D1D9;"> </span><span style="color:#FFA657;">Route</span><span style="color:#C9D1D9;">,</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FFA657;">redirectedFrom</span><span style="color:#FF7B72;">?:</span><span style="color:#C9D1D9;"> </span><span style="color:#FFA657;">Location</span></span>
<span class="line"><span style="color:#C9D1D9;">  )</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#FFA657;">Route</span><span style="color:#C9D1D9;"> {</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">location</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">normalizeLocation</span><span style="color:#C9D1D9;">(raw, currentRoute, </span><span style="color:#79C0FF;">false</span><span style="color:#C9D1D9;">, router) </span><span style="color:#8B949E;">// location 是一个对象，类似于 {&quot;_normalized&quot;:true,&quot;path&quot;:&quot;/&quot;,&quot;query&quot;:{},&quot;hash&quot;:&quot;&quot;}</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> { </span><span style="color:#79C0FF;">name</span><span style="color:#C9D1D9;"> } </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> location</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (name) { </span><span style="color:#8B949E;">// 如果有路由名称 就进行nameMap映射</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">record</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> nameMap[name]  </span><span style="color:#8B949E;">// nameMap[name] = 路由记录</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (p<wbr>rocess.env.</span><span style="color:#79C0FF;">NODE_ENV</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">!==</span><span style="color:#C9D1D9;"> </span><span style="color:#A5D6FF;">&#39;production&#39;</span><span style="color:#C9D1D9;">) {</span></span>
<span class="line"><span style="color:#C9D1D9;">        </span><span style="color:#D2A8FF;">warn</span><span style="color:#C9D1D9;">(record, </span><span style="color:#A5D6FF;">`Route with name &#39;${</span><span style="color:#C9D1D9;">name</span><span style="color:#A5D6FF;">}&#39; does not exist`</span><span style="color:#C9D1D9;">)</span></span>
<span class="line"><span style="color:#C9D1D9;">      }</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (</span><span style="color:#FF7B72;">!</span><span style="color:#C9D1D9;">record) </span><span style="color:#FF7B72;">return</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">_createRoute</span><span style="color:#C9D1D9;">(</span><span style="color:#79C0FF;">null</span><span style="color:#C9D1D9;">, location)</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">paramNames</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> record.regex.keys</span></span>
<span class="line"><span style="color:#C9D1D9;">        .</span><span style="color:#D2A8FF;">filter</span><span style="color:#C9D1D9;">(</span><span style="color:#FFA657;">key</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=&gt;</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">!</span><span style="color:#C9D1D9;">key.optional)</span></span>
<span class="line"><span style="color:#C9D1D9;">        .</span><span style="color:#D2A8FF;">map</span><span style="color:#C9D1D9;">(</span><span style="color:#FFA657;">key</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=&gt;</span><span style="color:#C9D1D9;"> key.name)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (</span><span style="color:#FF7B72;">typeof</span><span style="color:#C9D1D9;"> location.params </span><span style="color:#FF7B72;">!==</span><span style="color:#C9D1D9;"> </span><span style="color:#A5D6FF;">&#39;object&#39;</span><span style="color:#C9D1D9;">) {</span></span>
<span class="line"><span style="color:#C9D1D9;">        location.params </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> {}</span></span>
<span class="line"><span style="color:#C9D1D9;">      }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (currentRoute </span><span style="color:#FF7B72;">&amp;&amp;</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">typeof</span><span style="color:#C9D1D9;"> currentRoute.params </span><span style="color:#FF7B72;">===</span><span style="color:#C9D1D9;"> </span><span style="color:#A5D6FF;">&#39;object&#39;</span><span style="color:#C9D1D9;">) {</span></span>
<span class="line"><span style="color:#C9D1D9;">        </span><span style="color:#FF7B72;">for</span><span style="color:#C9D1D9;"> (</span><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">key</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">in</span><span style="color:#C9D1D9;"> currentRoute.params) {</span></span>
<span class="line"><span style="color:#C9D1D9;">          </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (</span><span style="color:#FF7B72;">!</span><span style="color:#C9D1D9;">(key </span><span style="color:#FF7B72;">in</span><span style="color:#C9D1D9;"> location.params) </span><span style="color:#FF7B72;">&amp;&amp;</span><span style="color:#C9D1D9;"> paramNames.</span><span style="color:#D2A8FF;">indexOf</span><span style="color:#C9D1D9;">(key) </span><span style="color:#FF7B72;">&gt;</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">-</span><span style="color:#79C0FF;">1</span><span style="color:#C9D1D9;">) {</span></span>
<span class="line"><span style="color:#C9D1D9;">            location.params[key] </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> currentRoute.params[key]</span></span>
<span class="line"><span style="color:#C9D1D9;">          }</span></span>
<span class="line"><span style="color:#C9D1D9;">        }</span></span>
<span class="line"><span style="color:#C9D1D9;">      }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C9D1D9;">      location.path </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">fillParams</span><span style="color:#C9D1D9;">(record.path, location.params, </span><span style="color:#A5D6FF;">`named route &quot;${</span><span style="color:#C9D1D9;">name</span><span style="color:#A5D6FF;">}&quot;`</span><span style="color:#C9D1D9;">)</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#FF7B72;">return</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">_createRoute</span><span style="color:#C9D1D9;">(record, location, redirectedFrom)</span></span>
<span class="line"><span style="color:#C9D1D9;">    } </span><span style="color:#FF7B72;">else</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (location.path) { </span><span style="color:#8B949E;">// 如果路由配置了path，到pathList和PathMap里匹配到路由记录 </span></span>
<span class="line"><span style="color:#C9D1D9;">      location.params </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> {}</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#FF7B72;">for</span><span style="color:#C9D1D9;"> (</span><span style="color:#FF7B72;">let</span><span style="color:#C9D1D9;"> i </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">0</span><span style="color:#C9D1D9;">; i </span><span style="color:#FF7B72;">&lt;</span><span style="color:#C9D1D9;"> pathList.</span><span style="color:#79C0FF;">length</span><span style="color:#C9D1D9;">; i</span><span style="color:#FF7B72;">++</span><span style="color:#C9D1D9;">) {</span></span>
<span class="line"><span style="color:#C9D1D9;">        </span><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">path</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> pathList[i]</span></span>
<span class="line"><span style="color:#C9D1D9;">        </span><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">record</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> pathMap[path]</span></span>
<span class="line"><span style="color:#C9D1D9;">        </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (</span><span style="color:#D2A8FF;">matchRoute</span><span style="color:#C9D1D9;">(record.regex, location.path, location.params)) {</span></span>
<span class="line"><span style="color:#C9D1D9;">          </span><span style="color:#FF7B72;">return</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">_createRoute</span><span style="color:#C9D1D9;">(record, location, redirectedFrom)</span></span>
<span class="line"><span style="color:#C9D1D9;">        }</span></span>
<span class="line"><span style="color:#C9D1D9;">      }</span></span>
<span class="line"><span style="color:#C9D1D9;">    }</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#8B949E;">// no match</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">return</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">_createRoute</span><span style="color:#C9D1D9;">(</span><span style="color:#79C0FF;">null</span><span style="color:#C9D1D9;">, location)</span></span>
<span class="line"><span style="color:#C9D1D9;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">function</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">redirect</span><span style="color:#C9D1D9;"> ( </span><span style="color:#8B949E;">// 处理重定向</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FFA657;">record</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#FFA657;">RouteRecord</span><span style="color:#C9D1D9;">,</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FFA657;">location</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#FFA657;">Location</span></span>
<span class="line"><span style="color:#C9D1D9;">  )</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#FFA657;">Route</span><span style="color:#C9D1D9;"> {</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">originalRedirect</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> record.redirect</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">let</span><span style="color:#C9D1D9;"> redirect </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">typeof</span><span style="color:#C9D1D9;"> originalRedirect </span><span style="color:#FF7B72;">===</span><span style="color:#C9D1D9;"> </span><span style="color:#A5D6FF;">&#39;function&#39;</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#FF7B72;">?</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">originalRedirect</span><span style="color:#C9D1D9;">(</span><span style="color:#D2A8FF;">createRoute</span><span style="color:#C9D1D9;">(record, location, </span><span style="color:#79C0FF;">null</span><span style="color:#C9D1D9;">, router))</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> originalRedirect</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (</span><span style="color:#FF7B72;">typeof</span><span style="color:#C9D1D9;"> redirect </span><span style="color:#FF7B72;">===</span><span style="color:#C9D1D9;"> </span><span style="color:#A5D6FF;">&#39;string&#39;</span><span style="color:#C9D1D9;">) {</span></span>
<span class="line"><span style="color:#C9D1D9;">      redirect </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> { path: redirect }</span></span>
<span class="line"><span style="color:#C9D1D9;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (</span><span style="color:#FF7B72;">!</span><span style="color:#C9D1D9;">redirect </span><span style="color:#FF7B72;">||</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">typeof</span><span style="color:#C9D1D9;"> redirect </span><span style="color:#FF7B72;">!==</span><span style="color:#C9D1D9;"> </span><span style="color:#A5D6FF;">&#39;object&#39;</span><span style="color:#C9D1D9;">) {</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (p<wbr>rocess.env.</span><span style="color:#79C0FF;">NODE_ENV</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">!==</span><span style="color:#C9D1D9;"> </span><span style="color:#A5D6FF;">&#39;production&#39;</span><span style="color:#C9D1D9;">) {</span></span>
<span class="line"><span style="color:#C9D1D9;">        </span><span style="color:#D2A8FF;">warn</span><span style="color:#C9D1D9;">(</span></span>
<span class="line"><span style="color:#C9D1D9;">          </span><span style="color:#79C0FF;">false</span><span style="color:#C9D1D9;">, </span><span style="color:#A5D6FF;">`invalid redirect option: ${</span><span style="color:#79C0FF;">JSON</span><span style="color:#A5D6FF;">.</span><span style="color:#D2A8FF;">stringify</span><span style="color:#A5D6FF;">(</span><span style="color:#C9D1D9;">redirect</span><span style="color:#A5D6FF;">)</span><span style="color:#A5D6FF;">}`</span></span>
<span class="line"><span style="color:#C9D1D9;">        )</span></span>
<span class="line"><span style="color:#C9D1D9;">      }</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#FF7B72;">return</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">_createRoute</span><span style="color:#C9D1D9;">(</span><span style="color:#79C0FF;">null</span><span style="color:#C9D1D9;">, location)</span></span>
<span class="line"><span style="color:#C9D1D9;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">re</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#FFA657;">Object</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> redirect</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> { </span><span style="color:#79C0FF;">name</span><span style="color:#C9D1D9;">, </span><span style="color:#79C0FF;">path</span><span style="color:#C9D1D9;"> } </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> re</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">let</span><span style="color:#C9D1D9;"> { query, hash, params } </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> location</span></span>
<span class="line"><span style="color:#C9D1D9;">    query </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> re.</span><span style="color:#D2A8FF;">hasOwnProperty</span><span style="color:#C9D1D9;">(</span><span style="color:#A5D6FF;">&#39;query&#39;</span><span style="color:#C9D1D9;">) </span><span style="color:#FF7B72;">?</span><span style="color:#C9D1D9;"> re.query </span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> query</span></span>
<span class="line"><span style="color:#C9D1D9;">    hash </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> re.</span><span style="color:#D2A8FF;">hasOwnProperty</span><span style="color:#C9D1D9;">(</span><span style="color:#A5D6FF;">&#39;hash&#39;</span><span style="color:#C9D1D9;">) </span><span style="color:#FF7B72;">?</span><span style="color:#C9D1D9;"> re.hash </span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> hash</span></span>
<span class="line"><span style="color:#C9D1D9;">    params </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> re.</span><span style="color:#D2A8FF;">hasOwnProperty</span><span style="color:#C9D1D9;">(</span><span style="color:#A5D6FF;">&#39;params&#39;</span><span style="color:#C9D1D9;">) </span><span style="color:#FF7B72;">?</span><span style="color:#C9D1D9;"> re.params </span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> params</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (name) {</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#8B949E;">// resolved named direct</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">targetRecord</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> nameMap[name]</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (p<wbr>rocess.env.</span><span style="color:#79C0FF;">NODE_ENV</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">!==</span><span style="color:#C9D1D9;"> </span><span style="color:#A5D6FF;">&#39;production&#39;</span><span style="color:#C9D1D9;">) {</span></span>
<span class="line"><span style="color:#C9D1D9;">        </span><span style="color:#D2A8FF;">assert</span><span style="color:#C9D1D9;">(targetRecord, </span><span style="color:#A5D6FF;">`redirect failed: named route &quot;${</span><span style="color:#C9D1D9;">name</span><span style="color:#A5D6FF;">}&quot; not found.`</span><span style="color:#C9D1D9;">)</span></span>
<span class="line"><span style="color:#C9D1D9;">      }</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#FF7B72;">return</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">match</span><span style="color:#C9D1D9;">({</span></span>
<span class="line"><span style="color:#C9D1D9;">        _normalized: </span><span style="color:#79C0FF;">true</span><span style="color:#C9D1D9;">,</span></span>
<span class="line"><span style="color:#C9D1D9;">        name,</span></span>
<span class="line"><span style="color:#C9D1D9;">        query,</span></span>
<span class="line"><span style="color:#C9D1D9;">        hash,</span></span>
<span class="line"><span style="color:#C9D1D9;">        params</span></span>
<span class="line"><span style="color:#C9D1D9;">      }, </span><span style="color:#79C0FF;">undefined</span><span style="color:#C9D1D9;">, location)</span></span>
<span class="line"><span style="color:#C9D1D9;">    } </span><span style="color:#FF7B72;">else</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (path) {</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#8B949E;">// 1. resolve relative redirect</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">rawPath</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">resolveRecordPath</span><span style="color:#C9D1D9;">(path, record)</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#8B949E;">// 2. resolve params</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">resolvedPath</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">fillParams</span><span style="color:#C9D1D9;">(rawPath, params, </span><span style="color:#A5D6FF;">`redirect route with path &quot;${</span><span style="color:#C9D1D9;">rawPath</span><span style="color:#A5D6FF;">}&quot;`</span><span style="color:#C9D1D9;">)</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#8B949E;">// 3. rematch with existing query and hash</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#FF7B72;">return</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">match</span><span style="color:#C9D1D9;">({</span></span>
<span class="line"><span style="color:#C9D1D9;">        _normalized: </span><span style="color:#79C0FF;">true</span><span style="color:#C9D1D9;">,</span></span>
<span class="line"><span style="color:#C9D1D9;">        path: resolvedPath,</span></span>
<span class="line"><span style="color:#C9D1D9;">        query,</span></span>
<span class="line"><span style="color:#C9D1D9;">        hash</span></span>
<span class="line"><span style="color:#C9D1D9;">      }, </span><span style="color:#79C0FF;">undefined</span><span style="color:#C9D1D9;">, location)</span></span>
<span class="line"><span style="color:#C9D1D9;">    } </span><span style="color:#FF7B72;">else</span><span style="color:#C9D1D9;"> {</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (p<wbr>rocess.env.</span><span style="color:#79C0FF;">NODE_ENV</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">!==</span><span style="color:#C9D1D9;"> </span><span style="color:#A5D6FF;">&#39;production&#39;</span><span style="color:#C9D1D9;">) {</span></span>
<span class="line"><span style="color:#C9D1D9;">        </span><span style="color:#D2A8FF;">warn</span><span style="color:#C9D1D9;">(</span><span style="color:#79C0FF;">false</span><span style="color:#C9D1D9;">, </span><span style="color:#A5D6FF;">`invalid redirect option: ${</span><span style="color:#79C0FF;">JSON</span><span style="color:#A5D6FF;">.</span><span style="color:#D2A8FF;">stringify</span><span style="color:#A5D6FF;">(</span><span style="color:#C9D1D9;">redirect</span><span style="color:#A5D6FF;">)</span><span style="color:#A5D6FF;">}`</span><span style="color:#C9D1D9;">)</span></span>
<span class="line"><span style="color:#C9D1D9;">      }</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#FF7B72;">return</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">_createRoute</span><span style="color:#C9D1D9;">(</span><span style="color:#79C0FF;">null</span><span style="color:#C9D1D9;">, location)</span></span>
<span class="line"><span style="color:#C9D1D9;">    }</span></span>
<span class="line"><span style="color:#C9D1D9;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">function</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">alias</span><span style="color:#C9D1D9;"> ( </span><span style="color:#8B949E;">// 处理别名</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FFA657;">record</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#FFA657;">RouteRecord</span><span style="color:#C9D1D9;">,</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FFA657;">location</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#FFA657;">Location</span><span style="color:#C9D1D9;">,</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FFA657;">matchAs</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">string</span></span>
<span class="line"><span style="color:#C9D1D9;">  )</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#FFA657;">Route</span><span style="color:#C9D1D9;"> {</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">aliasedPath</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">fillParams</span><span style="color:#C9D1D9;">(matchAs, location.params, </span><span style="color:#A5D6FF;">`aliased route with path &quot;${</span><span style="color:#C9D1D9;">matchAs</span><span style="color:#A5D6FF;">}&quot;`</span><span style="color:#C9D1D9;">)</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">aliasedMatch</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">match</span><span style="color:#C9D1D9;">({</span></span>
<span class="line"><span style="color:#C9D1D9;">      _normalized: </span><span style="color:#79C0FF;">true</span><span style="color:#C9D1D9;">,</span></span>
<span class="line"><span style="color:#C9D1D9;">      path: aliasedPath</span></span>
<span class="line"><span style="color:#C9D1D9;">    })</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (aliasedMatch) {</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">matched</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> aliasedMatch.matched</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">aliasedRecord</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> matched[matched.</span><span style="color:#79C0FF;">length</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">-</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">1</span><span style="color:#C9D1D9;">]</span></span>
<span class="line"><span style="color:#C9D1D9;">      location.params </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> aliasedMatch.params</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#FF7B72;">return</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">_createRoute</span><span style="color:#C9D1D9;">(aliasedRecord, location)</span></span>
<span class="line"><span style="color:#C9D1D9;">    }</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">return</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">_createRoute</span><span style="color:#C9D1D9;">(</span><span style="color:#79C0FF;">null</span><span style="color:#C9D1D9;">, location)</span></span>
<span class="line"><span style="color:#C9D1D9;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">function</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">_createRoute</span><span style="color:#C9D1D9;"> (  </span><span style="color:#8B949E;">// 创建路由</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FFA657;">record</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">?</span><span style="color:#FFA657;">RouteRecord</span><span style="color:#C9D1D9;">,</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FFA657;">location</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#FFA657;">Location</span><span style="color:#C9D1D9;">,</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FFA657;">redirectedFrom</span><span style="color:#FF7B72;">?:</span><span style="color:#C9D1D9;"> </span><span style="color:#FFA657;">Location</span></span>
<span class="line"><span style="color:#C9D1D9;">  )</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#FFA657;">Route</span><span style="color:#C9D1D9;"> {</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (record </span><span style="color:#FF7B72;">&amp;&amp;</span><span style="color:#C9D1D9;"> record.redirect) {</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#FF7B72;">return</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">redirect</span><span style="color:#C9D1D9;">(record, redirectedFrom </span><span style="color:#FF7B72;">||</span><span style="color:#C9D1D9;"> location)</span></span>
<span class="line"><span style="color:#C9D1D9;">    }</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (record </span><span style="color:#FF7B72;">&amp;&amp;</span><span style="color:#C9D1D9;"> record.matchAs) {</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#FF7B72;">return</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">alias</span><span style="color:#C9D1D9;">(record, location, record.matchAs)</span></span>
<span class="line"><span style="color:#C9D1D9;">    }</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">return</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">createRoute</span><span style="color:#C9D1D9;">(record, location, redirectedFrom, router) </span><span style="color:#8B949E;">// 创建路由对象</span></span>
<span class="line"><span style="color:#C9D1D9;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">return</span><span style="color:#C9D1D9;"> {</span></span>
<span class="line"><span style="color:#C9D1D9;">    match,</span></span>
<span class="line"><span style="color:#C9D1D9;">    addRoutes</span></span>
<span class="line"><span style="color:#C9D1D9;">  }</span></span>
<span class="line"><span style="color:#C9D1D9;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8B949E;">// dev/src/create-route-map.js line 7</span></span>
<span class="line"><span style="color:#FF7B72;">export</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">function</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">createRouteMap</span><span style="color:#C9D1D9;"> (</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FFA657;">routes</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#FFA657;">Array</span><span style="color:#C9D1D9;">&lt;</span><span style="color:#FFA657;">RouteConfig</span><span style="color:#C9D1D9;">&gt;,</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FFA657;">oldPathList</span><span style="color:#FF7B72;">?:</span><span style="color:#C9D1D9;"> </span><span style="color:#FFA657;">Array</span><span style="color:#C9D1D9;">&lt;</span><span style="color:#79C0FF;">string</span><span style="color:#C9D1D9;">&gt;,</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FFA657;">oldPathMap</span><span style="color:#FF7B72;">?:</span><span style="color:#C9D1D9;"> </span><span style="color:#FFA657;">Dictionary</span><span style="color:#C9D1D9;">&lt;</span><span style="color:#FFA657;">RouteRecord</span><span style="color:#C9D1D9;">&gt;,</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FFA657;">oldNameMap</span><span style="color:#FF7B72;">?:</span><span style="color:#C9D1D9;"> </span><span style="color:#FFA657;">Dictionary</span><span style="color:#C9D1D9;">&lt;</span><span style="color:#FFA657;">RouteRecord</span><span style="color:#C9D1D9;">&gt;</span></span>
<span class="line"><span style="color:#C9D1D9;">)</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> {</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FFA657;">pathList</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#FFA657;">Array</span><span style="color:#C9D1D9;">&lt;</span><span style="color:#79C0FF;">string</span><span style="color:#C9D1D9;">&gt;,</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FFA657;">pathMap</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#FFA657;">Dictionary</span><span style="color:#C9D1D9;">&lt;</span><span style="color:#FFA657;">RouteRecord</span><span style="color:#C9D1D9;">&gt;,</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FFA657;">nameMap</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#FFA657;">Dictionary</span><span style="color:#C9D1D9;">&lt;</span><span style="color:#FFA657;">RouteRecord</span><span style="color:#C9D1D9;">&gt;</span></span>
<span class="line"><span style="color:#C9D1D9;">} {</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#8B949E;">// the path list is used to control path matching priority</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">pathList</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#FFA657;">Array</span><span style="color:#C9D1D9;">&lt;</span><span style="color:#79C0FF;">string</span><span style="color:#C9D1D9;">&gt; </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> oldPathList </span><span style="color:#FF7B72;">||</span><span style="color:#C9D1D9;"> [] </span><span style="color:#8B949E;">// 创建映射表</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#8B949E;">// $flow-disable-line</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">pathMap</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#FFA657;">Dictionary</span><span style="color:#C9D1D9;">&lt;</span><span style="color:#FFA657;">RouteRecord</span><span style="color:#C9D1D9;">&gt; </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> oldPathMap </span><span style="color:#FF7B72;">||</span><span style="color:#C9D1D9;"> Object.</span><span style="color:#D2A8FF;">create</span><span style="color:#C9D1D9;">(</span><span style="color:#79C0FF;">null</span><span style="color:#C9D1D9;">)</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#8B949E;">// $flow-disable-line</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">nameMap</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#FFA657;">Dictionary</span><span style="color:#C9D1D9;">&lt;</span><span style="color:#FFA657;">RouteRecord</span><span style="color:#C9D1D9;">&gt; </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> oldNameMap </span><span style="color:#FF7B72;">||</span><span style="color:#C9D1D9;"> Object.</span><span style="color:#D2A8FF;">create</span><span style="color:#C9D1D9;">(</span><span style="color:#79C0FF;">null</span><span style="color:#C9D1D9;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C9D1D9;">  routes.</span><span style="color:#D2A8FF;">forEach</span><span style="color:#C9D1D9;">(</span><span style="color:#FFA657;">route</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=&gt;</span><span style="color:#C9D1D9;"> { </span><span style="color:#8B949E;">// 遍历路由配置，为每个配置添加路由记录</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#D2A8FF;">addRouteRecord</span><span style="color:#C9D1D9;">(pathList, pathMap, nameMap, route)</span></span>
<span class="line"><span style="color:#C9D1D9;">  })</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#8B949E;">// ensure wildcard routes are always at the end</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">for</span><span style="color:#C9D1D9;"> (</span><span style="color:#FF7B72;">let</span><span style="color:#C9D1D9;"> i </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">0</span><span style="color:#C9D1D9;">, l </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> pathList.</span><span style="color:#79C0FF;">length</span><span style="color:#C9D1D9;">; i </span><span style="color:#FF7B72;">&lt;</span><span style="color:#C9D1D9;"> l; i</span><span style="color:#FF7B72;">++</span><span style="color:#C9D1D9;">) { </span><span style="color:#8B949E;">// 确保通配符在最后</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (pathList[i] </span><span style="color:#FF7B72;">===</span><span style="color:#C9D1D9;"> </span><span style="color:#A5D6FF;">&#39;*&#39;</span><span style="color:#C9D1D9;">) {</span></span>
<span class="line"><span style="color:#C9D1D9;">      pathList.</span><span style="color:#D2A8FF;">push</span><span style="color:#C9D1D9;">(pathList.</span><span style="color:#D2A8FF;">splice</span><span style="color:#C9D1D9;">(i, </span><span style="color:#79C0FF;">1</span><span style="color:#C9D1D9;">)[</span><span style="color:#79C0FF;">0</span><span style="color:#C9D1D9;">])</span></span>
<span class="line"><span style="color:#C9D1D9;">      l</span><span style="color:#FF7B72;">--</span></span>
<span class="line"><span style="color:#C9D1D9;">      i</span><span style="color:#FF7B72;">--</span></span>
<span class="line"><span style="color:#C9D1D9;">    }</span></span>
<span class="line"><span style="color:#C9D1D9;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (p<wbr>rocess.env.</span><span style="color:#79C0FF;">NODE_ENV</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">===</span><span style="color:#C9D1D9;"> </span><span style="color:#A5D6FF;">&#39;development&#39;</span><span style="color:#C9D1D9;">) {</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#8B949E;">// warn if routes do not include leading slashes</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">found</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> pathList</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#8B949E;">// check for missing leading slash</span></span>
<span class="line"><span style="color:#C9D1D9;">      .</span><span style="color:#D2A8FF;">filter</span><span style="color:#C9D1D9;">(</span><span style="color:#FFA657;">path</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=&gt;</span><span style="color:#C9D1D9;"> path </span><span style="color:#FF7B72;">&amp;&amp;</span><span style="color:#C9D1D9;"> path.</span><span style="color:#D2A8FF;">charAt</span><span style="color:#C9D1D9;">(</span><span style="color:#79C0FF;">0</span><span style="color:#C9D1D9;">) </span><span style="color:#FF7B72;">!==</span><span style="color:#C9D1D9;"> </span><span style="color:#A5D6FF;">&#39;*&#39;</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">&amp;&amp;</span><span style="color:#C9D1D9;"> path.</span><span style="color:#D2A8FF;">charAt</span><span style="color:#C9D1D9;">(</span><span style="color:#79C0FF;">0</span><span style="color:#C9D1D9;">) </span><span style="color:#FF7B72;">!==</span><span style="color:#C9D1D9;"> </span><span style="color:#A5D6FF;">&#39;/&#39;</span><span style="color:#C9D1D9;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (found.</span><span style="color:#79C0FF;">length</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">&gt;</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">0</span><span style="color:#C9D1D9;">) {</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">pathNames</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> found.</span><span style="color:#D2A8FF;">map</span><span style="color:#C9D1D9;">(</span><span style="color:#FFA657;">path</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=&gt;</span><span style="color:#C9D1D9;"> </span><span style="color:#A5D6FF;">`- ${</span><span style="color:#C9D1D9;">path</span><span style="color:#A5D6FF;">}`</span><span style="color:#C9D1D9;">).</span><span style="color:#D2A8FF;">join</span><span style="color:#C9D1D9;">(</span><span style="color:#A5D6FF;">&#39;</span><span style="color:#79C0FF;">\n</span><span style="color:#A5D6FF;">&#39;</span><span style="color:#C9D1D9;">)</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#D2A8FF;">warn</span><span style="color:#C9D1D9;">(</span><span style="color:#79C0FF;">false</span><span style="color:#C9D1D9;">, </span><span style="color:#A5D6FF;">`Non-nested routes must include a leading slash character. Fix the following routes: </span><span style="color:#79C0FF;">\n</span><span style="color:#A5D6FF;">${</span><span style="color:#C9D1D9;">pathNames</span><span style="color:#A5D6FF;">}`</span><span style="color:#C9D1D9;">)</span></span>
<span class="line"><span style="color:#C9D1D9;">    }</span></span>
<span class="line"><span style="color:#C9D1D9;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">return</span><span style="color:#C9D1D9;"> {</span></span>
<span class="line"><span style="color:#C9D1D9;">    pathList,</span></span>
<span class="line"><span style="color:#C9D1D9;">    pathMap,</span></span>
<span class="line"><span style="color:#C9D1D9;">    nameMap</span></span>
<span class="line"><span style="color:#C9D1D9;">  }</span></span>
<span class="line"><span style="color:#C9D1D9;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF7B72;">function</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">addRouteRecord</span><span style="color:#C9D1D9;"> ( </span><span style="color:#8B949E;">// 添加路由记录</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FFA657;">pathList</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#FFA657;">Array</span><span style="color:#C9D1D9;">&lt;</span><span style="color:#79C0FF;">string</span><span style="color:#C9D1D9;">&gt;,</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FFA657;">pathMap</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#FFA657;">Dictionary</span><span style="color:#C9D1D9;">&lt;</span><span style="color:#FFA657;">RouteRecord</span><span style="color:#C9D1D9;">&gt;,</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FFA657;">nameMap</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#FFA657;">Dictionary</span><span style="color:#C9D1D9;">&lt;</span><span style="color:#FFA657;">RouteRecord</span><span style="color:#C9D1D9;">&gt;,</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FFA657;">route</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#FFA657;">RouteConfig</span><span style="color:#C9D1D9;">,</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FFA657;">parent</span><span style="color:#FF7B72;">?:</span><span style="color:#C9D1D9;"> </span><span style="color:#FFA657;">RouteRecord</span><span style="color:#C9D1D9;">,</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FFA657;">matchAs</span><span style="color:#FF7B72;">?:</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">string</span></span>
<span class="line"><span style="color:#C9D1D9;">) {</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> { </span><span style="color:#79C0FF;">path</span><span style="color:#C9D1D9;">, </span><span style="color:#79C0FF;">name</span><span style="color:#C9D1D9;"> } </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> route </span><span style="color:#8B949E;">// 获得路由配置下的属性</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (p<wbr>rocess.env.</span><span style="color:#79C0FF;">NODE_ENV</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">!==</span><span style="color:#C9D1D9;"> </span><span style="color:#A5D6FF;">&#39;production&#39;</span><span style="color:#C9D1D9;">) {</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#D2A8FF;">assert</span><span style="color:#C9D1D9;">(path </span><span style="color:#FF7B72;">!=</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">null</span><span style="color:#C9D1D9;">, </span><span style="color:#A5D6FF;">`&quot;path&quot; is required in a route configuration.`</span><span style="color:#C9D1D9;">)</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#D2A8FF;">assert</span><span style="color:#C9D1D9;">(</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#FF7B72;">typeof</span><span style="color:#C9D1D9;"> route.component </span><span style="color:#FF7B72;">!==</span><span style="color:#C9D1D9;"> </span><span style="color:#A5D6FF;">&#39;string&#39;</span><span style="color:#C9D1D9;">,</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#A5D6FF;">`route config &quot;component&quot; for path: ${</span><span style="color:#D2A8FF;">String</span><span style="color:#A5D6FF;">(</span></span>
<span class="line"><span style="color:#A5D6FF;">        </span><span style="color:#C9D1D9;">path</span><span style="color:#A5D6FF;"> </span><span style="color:#FF7B72;">||</span><span style="color:#A5D6FF;"> </span><span style="color:#C9D1D9;">name</span></span>
<span class="line"><span style="color:#A5D6FF;">      )</span><span style="color:#A5D6FF;">} cannot be a `</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">+</span><span style="color:#C9D1D9;"> </span><span style="color:#A5D6FF;">`string id. Use an actual component instead.`</span></span>
<span class="line"><span style="color:#C9D1D9;">    )</span></span>
<span class="line"><span style="color:#C9D1D9;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">pathToRegexpOptions</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#FFA657;">PathToRegexpOptions</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span></span>
<span class="line"><span style="color:#C9D1D9;">    route.pathToRegexpOptions </span><span style="color:#FF7B72;">||</span><span style="color:#C9D1D9;"> {}</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">normalizedPath</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">normalizePath</span><span style="color:#C9D1D9;">(path, parent, pathToRegexpOptions.strict)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (</span><span style="color:#FF7B72;">typeof</span><span style="color:#C9D1D9;"> route.caseSensitive </span><span style="color:#FF7B72;">===</span><span style="color:#C9D1D9;"> </span><span style="color:#A5D6FF;">&#39;boolean&#39;</span><span style="color:#C9D1D9;">) {</span></span>
<span class="line"><span style="color:#C9D1D9;">    pathToRegexpOptions.sensitive </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> route.caseSensitive</span></span>
<span class="line"><span style="color:#C9D1D9;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">record</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#FFA657;">RouteRecord</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> { </span><span style="color:#8B949E;">// 生成记录对象</span></span>
<span class="line"><span style="color:#C9D1D9;">    path: normalizedPath,</span></span>
<span class="line"><span style="color:#C9D1D9;">    regex: </span><span style="color:#D2A8FF;">compileRouteRegex</span><span style="color:#C9D1D9;">(normalizedPath, pathToRegexpOptions),</span></span>
<span class="line"><span style="color:#C9D1D9;">    components: route.components </span><span style="color:#FF7B72;">||</span><span style="color:#C9D1D9;"> { default: route.component },</span></span>
<span class="line"><span style="color:#C9D1D9;">    instances: {},</span></span>
<span class="line"><span style="color:#C9D1D9;">    name,</span></span>
<span class="line"><span style="color:#C9D1D9;">    parent,</span></span>
<span class="line"><span style="color:#C9D1D9;">    matchAs,</span></span>
<span class="line"><span style="color:#C9D1D9;">    redirect: route.redirect,</span></span>
<span class="line"><span style="color:#C9D1D9;">    beforeEnter: route.beforeEnter,</span></span>
<span class="line"><span style="color:#C9D1D9;">    meta: route.meta </span><span style="color:#FF7B72;">||</span><span style="color:#C9D1D9;"> {},</span></span>
<span class="line"><span style="color:#C9D1D9;">    props:</span></span>
<span class="line"><span style="color:#C9D1D9;">      route.props </span><span style="color:#FF7B72;">==</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">null</span></span>
<span class="line"><span style="color:#C9D1D9;">        </span><span style="color:#FF7B72;">?</span><span style="color:#C9D1D9;"> {}</span></span>
<span class="line"><span style="color:#C9D1D9;">        </span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> route.components</span></span>
<span class="line"><span style="color:#C9D1D9;">          </span><span style="color:#FF7B72;">?</span><span style="color:#C9D1D9;"> route.props</span></span>
<span class="line"><span style="color:#C9D1D9;">          </span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> { default: route.props }</span></span>
<span class="line"><span style="color:#C9D1D9;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (route.children) { </span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#8B949E;">// Warn if route is named, does not redirect and has a default child route.</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#8B949E;">// If users navigate to this route by name, the default child will</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#8B949E;">// not be rendered (GH Issue #629)</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (p<wbr>rocess.env.</span><span style="color:#79C0FF;">NODE_ENV</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">!==</span><span style="color:#C9D1D9;"> </span><span style="color:#A5D6FF;">&#39;production&#39;</span><span style="color:#C9D1D9;">) {</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (</span></span>
<span class="line"><span style="color:#C9D1D9;">        route.name </span><span style="color:#FF7B72;">&amp;&amp;</span></span>
<span class="line"><span style="color:#C9D1D9;">        </span><span style="color:#FF7B72;">!</span><span style="color:#C9D1D9;">route.redirect </span><span style="color:#FF7B72;">&amp;&amp;</span></span>
<span class="line"><span style="color:#C9D1D9;">        route.children.</span><span style="color:#D2A8FF;">some</span><span style="color:#C9D1D9;">(</span><span style="color:#FFA657;">child</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=&gt;</span><span style="color:#A5D6FF;"> /</span><span style="color:#FF7B72;">^</span><span style="color:#7EE787;font-style:italic;">\/</span><span style="color:#FF7B72;">?$</span><span style="color:#A5D6FF;">/</span><span style="color:#C9D1D9;">.</span><span style="color:#D2A8FF;">test</span><span style="color:#C9D1D9;">(child.path))</span></span>
<span class="line"><span style="color:#C9D1D9;">      ) {</span></span>
<span class="line"><span style="color:#C9D1D9;">        </span><span style="color:#D2A8FF;">warn</span><span style="color:#C9D1D9;">(</span></span>
<span class="line"><span style="color:#C9D1D9;">          </span><span style="color:#79C0FF;">false</span><span style="color:#C9D1D9;">,</span></span>
<span class="line"><span style="color:#C9D1D9;">          </span><span style="color:#A5D6FF;">`Named Route &#39;${</span><span style="color:#C9D1D9;">route</span><span style="color:#A5D6FF;">.</span><span style="color:#C9D1D9;">name</span><span style="color:#A5D6FF;">}&#39; has a default child route. `</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">+</span></span>
<span class="line"><span style="color:#C9D1D9;">            </span><span style="color:#A5D6FF;">`When navigating to this named route (:to=&quot;{name: &#39;${</span></span>
<span class="line"><span style="color:#A5D6FF;">              </span><span style="color:#C9D1D9;">route</span><span style="color:#A5D6FF;">.</span><span style="color:#C9D1D9;">name</span></span>
<span class="line"><span style="color:#A5D6FF;">            </span><span style="color:#A5D6FF;">}&#39;&quot;), `</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">+</span></span>
<span class="line"><span style="color:#C9D1D9;">            </span><span style="color:#A5D6FF;">`the default child route will not be rendered. Remove the name from `</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">+</span></span>
<span class="line"><span style="color:#C9D1D9;">            </span><span style="color:#A5D6FF;">`this route and use the name of the default child route for named `</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">+</span></span>
<span class="line"><span style="color:#C9D1D9;">            </span><span style="color:#A5D6FF;">`links instead.`</span></span>
<span class="line"><span style="color:#C9D1D9;">        )</span></span>
<span class="line"><span style="color:#C9D1D9;">      }</span></span>
<span class="line"><span style="color:#C9D1D9;">    }</span></span>
<span class="line"><span style="color:#C9D1D9;">    route.children.</span><span style="color:#D2A8FF;">forEach</span><span style="color:#C9D1D9;">(</span><span style="color:#FFA657;">child</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=&gt;</span><span style="color:#C9D1D9;"> { </span><span style="color:#8B949E;">// 递归路由配置的 children 属性，添加路由记录</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">childMatchAs</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> matchAs</span></span>
<span class="line"><span style="color:#C9D1D9;">        </span><span style="color:#FF7B72;">?</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">cleanPath</span><span style="color:#C9D1D9;">(</span><span style="color:#A5D6FF;">`${</span><span style="color:#C9D1D9;">matchAs</span><span style="color:#A5D6FF;">}/${</span><span style="color:#C9D1D9;">child</span><span style="color:#A5D6FF;">.</span><span style="color:#C9D1D9;">path</span><span style="color:#A5D6FF;">}`</span><span style="color:#C9D1D9;">)</span></span>
<span class="line"><span style="color:#C9D1D9;">        </span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">undefined</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#D2A8FF;">addRouteRecord</span><span style="color:#C9D1D9;">(pathList, pathMap, nameMap, child, record, childMatchAs)</span></span>
<span class="line"><span style="color:#C9D1D9;">    })</span></span>
<span class="line"><span style="color:#C9D1D9;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (</span><span style="color:#FF7B72;">!</span><span style="color:#C9D1D9;">pathMap[record.path]) { </span><span style="color:#8B949E;">// 如果有多个相同的路径，只有第一个起作用，后面的会被忽略</span></span>
<span class="line"><span style="color:#C9D1D9;">    pathList.</span><span style="color:#D2A8FF;">push</span><span style="color:#C9D1D9;">(record.path)</span></span>
<span class="line"><span style="color:#C9D1D9;">    pathMap[record.path] </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> record</span></span>
<span class="line"><span style="color:#C9D1D9;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (route.alias </span><span style="color:#FF7B72;">!==</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">undefined</span><span style="color:#C9D1D9;">) { </span><span style="color:#8B949E;">// 如果路由有别名的话，给别名也添加路由记录</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">aliases</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> Array.</span><span style="color:#D2A8FF;">isArray</span><span style="color:#C9D1D9;">(route.alias) </span><span style="color:#FF7B72;">?</span><span style="color:#C9D1D9;"> route.alias </span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> [route.alias]</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">for</span><span style="color:#C9D1D9;"> (</span><span style="color:#FF7B72;">let</span><span style="color:#C9D1D9;"> i </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">0</span><span style="color:#C9D1D9;">; i </span><span style="color:#FF7B72;">&lt;</span><span style="color:#C9D1D9;"> aliases.</span><span style="color:#79C0FF;">length</span><span style="color:#C9D1D9;">; </span><span style="color:#FF7B72;">++</span><span style="color:#C9D1D9;">i) {</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">alias</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> aliases[i]</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (p<wbr>rocess.env.</span><span style="color:#79C0FF;">NODE_ENV</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">!==</span><span style="color:#C9D1D9;"> </span><span style="color:#A5D6FF;">&#39;production&#39;</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">&amp;&amp;</span><span style="color:#C9D1D9;"> alias </span><span style="color:#FF7B72;">===</span><span style="color:#C9D1D9;"> path) {</span></span>
<span class="line"><span style="color:#C9D1D9;">        </span><span style="color:#D2A8FF;">warn</span><span style="color:#C9D1D9;">(</span></span>
<span class="line"><span style="color:#C9D1D9;">          </span><span style="color:#79C0FF;">false</span><span style="color:#C9D1D9;">,</span></span>
<span class="line"><span style="color:#C9D1D9;">          </span><span style="color:#A5D6FF;">`Found an alias with the same value as the path: &quot;${</span><span style="color:#C9D1D9;">path</span><span style="color:#A5D6FF;">}&quot;. You have to remove that alias. It will be ignored in development.`</span></span>
<span class="line"><span style="color:#C9D1D9;">        )</span></span>
<span class="line"><span style="color:#C9D1D9;">        </span><span style="color:#8B949E;">// skip in dev to make it work</span></span>
<span class="line"><span style="color:#C9D1D9;">        </span><span style="color:#FF7B72;">continue</span></span>
<span class="line"><span style="color:#C9D1D9;">      }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">aliasRoute</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> {</span></span>
<span class="line"><span style="color:#C9D1D9;">        path: alias,</span></span>
<span class="line"><span style="color:#C9D1D9;">        children: route.children</span></span>
<span class="line"><span style="color:#C9D1D9;">      }</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#D2A8FF;">addRouteRecord</span><span style="color:#C9D1D9;">(</span></span>
<span class="line"><span style="color:#C9D1D9;">        pathList,</span></span>
<span class="line"><span style="color:#C9D1D9;">        pathMap,</span></span>
<span class="line"><span style="color:#C9D1D9;">        nameMap,</span></span>
<span class="line"><span style="color:#C9D1D9;">        aliasRoute,</span></span>
<span class="line"><span style="color:#C9D1D9;">        parent,</span></span>
<span class="line"><span style="color:#C9D1D9;">        record.path </span><span style="color:#FF7B72;">||</span><span style="color:#C9D1D9;"> </span><span style="color:#A5D6FF;">&#39;/&#39;</span><span style="color:#C9D1D9;"> </span><span style="color:#8B949E;">// matchAs</span></span>
<span class="line"><span style="color:#C9D1D9;">      )</span></span>
<span class="line"><span style="color:#C9D1D9;">    }</span></span>
<span class="line"><span style="color:#C9D1D9;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (name) {</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (</span><span style="color:#FF7B72;">!</span><span style="color:#C9D1D9;">nameMap[name]) {</span></span>
<span class="line"><span style="color:#C9D1D9;">      nameMap[name] </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> record</span></span>
<span class="line"><span style="color:#C9D1D9;">    } </span><span style="color:#FF7B72;">else</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (p<wbr>rocess.env.</span><span style="color:#79C0FF;">NODE_ENV</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">!==</span><span style="color:#C9D1D9;"> </span><span style="color:#A5D6FF;">&#39;production&#39;</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">&amp;&amp;</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">!</span><span style="color:#C9D1D9;">matchAs) {</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#D2A8FF;">warn</span><span style="color:#C9D1D9;">(</span></span>
<span class="line"><span style="color:#C9D1D9;">        </span><span style="color:#79C0FF;">false</span><span style="color:#C9D1D9;">,</span></span>
<span class="line"><span style="color:#C9D1D9;">        </span><span style="color:#A5D6FF;">`Duplicate named routes definition: `</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">+</span></span>
<span class="line"><span style="color:#C9D1D9;">          </span><span style="color:#A5D6FF;">`{ name: &quot;${</span><span style="color:#C9D1D9;">name</span><span style="color:#A5D6FF;">}&quot;, path: &quot;${</span><span style="color:#C9D1D9;">record</span><span style="color:#A5D6FF;">.</span><span style="color:#C9D1D9;">path</span><span style="color:#A5D6FF;">}&quot; }`</span></span>
<span class="line"><span style="color:#C9D1D9;">      )</span></span>
<span class="line"><span style="color:#C9D1D9;">    }</span></span>
<span class="line"><span style="color:#C9D1D9;">  }</span></span>
<span class="line"><span style="color:#C9D1D9;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br><span class="line-number">182</span><br><span class="line-number">183</span><br><span class="line-number">184</span><br><span class="line-number">185</span><br><span class="line-number">186</span><br><span class="line-number">187</span><br><span class="line-number">188</span><br><span class="line-number">189</span><br><span class="line-number">190</span><br><span class="line-number">191</span><br><span class="line-number">192</span><br><span class="line-number">193</span><br><span class="line-number">194</span><br><span class="line-number">195</span><br><span class="line-number">196</span><br><span class="line-number">197</span><br><span class="line-number">198</span><br><span class="line-number">199</span><br><span class="line-number">200</span><br><span class="line-number">201</span><br><span class="line-number">202</span><br><span class="line-number">203</span><br><span class="line-number">204</span><br><span class="line-number">205</span><br><span class="line-number">206</span><br><span class="line-number">207</span><br><span class="line-number">208</span><br><span class="line-number">209</span><br><span class="line-number">210</span><br><span class="line-number">211</span><br><span class="line-number">212</span><br><span class="line-number">213</span><br><span class="line-number">214</span><br><span class="line-number">215</span><br><span class="line-number">216</span><br><span class="line-number">217</span><br><span class="line-number">218</span><br><span class="line-number">219</span><br><span class="line-number">220</span><br><span class="line-number">221</span><br><span class="line-number">222</span><br><span class="line-number">223</span><br><span class="line-number">224</span><br><span class="line-number">225</span><br><span class="line-number">226</span><br><span class="line-number">227</span><br><span class="line-number">228</span><br><span class="line-number">229</span><br><span class="line-number">230</span><br><span class="line-number">231</span><br><span class="line-number">232</span><br><span class="line-number">233</span><br><span class="line-number">234</span><br><span class="line-number">235</span><br><span class="line-number">236</span><br><span class="line-number">237</span><br><span class="line-number">238</span><br><span class="line-number">239</span><br><span class="line-number">240</span><br><span class="line-number">241</span><br><span class="line-number">242</span><br><span class="line-number">243</span><br><span class="line-number">244</span><br><span class="line-number">245</span><br><span class="line-number">246</span><br><span class="line-number">247</span><br><span class="line-number">248</span><br><span class="line-number">249</span><br><span class="line-number">250</span><br><span class="line-number">251</span><br><span class="line-number">252</span><br><span class="line-number">253</span><br><span class="line-number">254</span><br><span class="line-number">255</span><br><span class="line-number">256</span><br><span class="line-number">257</span><br><span class="line-number">258</span><br><span class="line-number">259</span><br><span class="line-number">260</span><br><span class="line-number">261</span><br><span class="line-number">262</span><br><span class="line-number">263</span><br><span class="line-number">264</span><br><span class="line-number">265</span><br><span class="line-number">266</span><br><span class="line-number">267</span><br><span class="line-number">268</span><br><span class="line-number">269</span><br><span class="line-number">270</span><br><span class="line-number">271</span><br><span class="line-number">272</span><br><span class="line-number">273</span><br><span class="line-number">274</span><br><span class="line-number">275</span><br><span class="line-number">276</span><br><span class="line-number">277</span><br><span class="line-number">278</span><br><span class="line-number">279</span><br><span class="line-number">280</span><br><span class="line-number">281</span><br><span class="line-number">282</span><br><span class="line-number">283</span><br><span class="line-number">284</span><br><span class="line-number">285</span><br><span class="line-number">286</span><br><span class="line-number">287</span><br><span class="line-number">288</span><br><span class="line-number">289</span><br><span class="line-number">290</span><br><span class="line-number">291</span><br><span class="line-number">292</span><br><span class="line-number">293</span><br><span class="line-number">294</span><br><span class="line-number">295</span><br><span class="line-number">296</span><br><span class="line-number">297</span><br><span class="line-number">298</span><br><span class="line-number">299</span><br><span class="line-number">300</span><br><span class="line-number">301</span><br><span class="line-number">302</span><br><span class="line-number">303</span><br><span class="line-number">304</span><br><span class="line-number">305</span><br><span class="line-number">306</span><br><span class="line-number">307</span><br><span class="line-number">308</span><br><span class="line-number">309</span><br><span class="line-number">310</span><br><span class="line-number">311</span><br><span class="line-number">312</span><br><span class="line-number">313</span><br><span class="line-number">314</span><br><span class="line-number">315</span><br><span class="line-number">316</span><br><span class="line-number">317</span><br><span class="line-number">318</span><br><span class="line-number">319</span><br><span class="line-number">320</span><br><span class="line-number">321</span><br><span class="line-number">322</span><br><span class="line-number">323</span><br><span class="line-number">324</span><br><span class="line-number">325</span><br><span class="line-number">326</span><br><span class="line-number">327</span><br><span class="line-number">328</span><br><span class="line-number">329</span><br></div></div><p>在上文的构造函数中实例化的<code>HTML5History</code>对象就是对于<code>history</code>模式下的路由的处理，主要是通过继承<code>History</code>对象以及自身实现的方法完成路由。在初始化<code>VueRouter</code>时调用的<code>init</code>方法调用了路由切换以及调用了<code>setupListeners</code>方法实现了路由的切换的监听回调，注意此时并没有在<code>HTML5History</code>对象的构造函数中直接添加事件监听，这是因为需要避免在某些浏览器中调度第一个<code>popstate</code>事件，但是由于异步保护，第一个历史记录路由未同时更新的问题。<code>history</code>模式的代码结构以及更新视图的逻辑与<code>hash</code>模式基本类似，主要是监听<code>popstate</code>事件以及对于<code>push()</code>和<code>replace()</code>方法的变动，使用<code>History</code>对象的<code>pushState()</code>与<code>replaceState()</code>等方法进行路由的变换。</p><div class="language-javascript line-numbers-mode"><button class="copy"></button><span class="lang">javascript</span><pre><code><span class="line"><span style="color:#8B949E;">// dev/src/index.js line 21</span></span>
<span class="line"><span style="color:#FF7B72;">export</span><span style="color:#FFA657;"> </span><span style="color:#FF7B72;">default</span><span style="color:#FFA657;"> </span><span style="color:#FF7B72;">class</span><span style="color:#FFA657;"> VueRouter {</span></span>
<span class="line"><span style="color:#FFA657;">  </span><span style="color:#8B949E;">//...</span></span>
<span class="line"><span style="color:#FFA657;">  </span><span style="color:#D2A8FF;">init</span><span style="color:#FFA657;"> (app</span><span style="color:#FF7B72;">:</span><span style="color:#FFA657;"> </span><span style="color:#79C0FF;">any</span><span style="color:#FFA657;"> </span><span style="color:#8B949E;">/* Vue component instance */</span><span style="color:#FFA657;">) </span><span style="color:#C9D1D9;">{</span></span>
<span class="line"><span style="color:#C9D1D9;">    p<wbr>rocess.env.</span><span style="color:#79C0FF;">NODE_ENV</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">!==</span><span style="color:#C9D1D9;"> </span><span style="color:#A5D6FF;">&#39;production&#39;</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">&amp;&amp;</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#D2A8FF;">assert</span><span style="color:#C9D1D9;">(</span></span>
<span class="line"><span style="color:#C9D1D9;">        install.installed,</span></span>
<span class="line"><span style="color:#C9D1D9;">        </span><span style="color:#A5D6FF;">`not installed. Make sure to call </span><span style="color:#79C0FF;">\`</span><span style="color:#A5D6FF;">Vue.use(VueRouter)</span><span style="color:#79C0FF;">\`</span><span style="color:#A5D6FF;"> `</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">+</span></span>
<span class="line"><span style="color:#C9D1D9;">          </span><span style="color:#A5D6FF;">`before creating root instance.`</span></span>
<span class="line"><span style="color:#C9D1D9;">      )</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">.apps.</span><span style="color:#D2A8FF;">push</span><span style="color:#C9D1D9;">(app)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#8B949E;">// set up app destroyed handler</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#8B949E;">// https://github.com/vuejs/vue-router/issues/2639</span></span>
<span class="line"><span style="color:#C9D1D9;">    app.</span><span style="color:#D2A8FF;">$once</span><span style="color:#C9D1D9;">(</span><span style="color:#A5D6FF;">&#39;hook:destroyed&#39;</span><span style="color:#C9D1D9;">, () </span><span style="color:#FF7B72;">=&gt;</span><span style="color:#C9D1D9;"> {</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#8B949E;">// clean out app from this.apps array once destroyed</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">index</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">.apps.</span><span style="color:#D2A8FF;">indexOf</span><span style="color:#C9D1D9;">(app)</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (index </span><span style="color:#FF7B72;">&gt;</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">-</span><span style="color:#79C0FF;">1</span><span style="color:#C9D1D9;">) </span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">.apps.</span><span style="color:#D2A8FF;">splice</span><span style="color:#C9D1D9;">(index, </span><span style="color:#79C0FF;">1</span><span style="color:#C9D1D9;">)</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#8B949E;">// ensure we still have a main app or null if no apps</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#8B949E;">// we do not release the router so it can be reused</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (</span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">.app </span><span style="color:#FF7B72;">===</span><span style="color:#C9D1D9;"> app) </span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">.app </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">.apps[</span><span style="color:#79C0FF;">0</span><span style="color:#C9D1D9;">] </span><span style="color:#FF7B72;">||</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">null</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (</span><span style="color:#FF7B72;">!</span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">.app) </span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">.history.</span><span style="color:#D2A8FF;">teardown</span><span style="color:#C9D1D9;">()</span></span>
<span class="line"><span style="color:#C9D1D9;">    })</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#8B949E;">// main app previously initialized</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#8B949E;">// return as we don&#39;t need to set up new history listener</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (</span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">.app) {</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#FF7B72;">return</span></span>
<span class="line"><span style="color:#C9D1D9;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">.app </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> app</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">history</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">.history</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (history </span><span style="color:#FF7B72;">instanceof</span><span style="color:#C9D1D9;"> </span><span style="color:#FFA657;">HTML5History</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">||</span><span style="color:#C9D1D9;"> history </span><span style="color:#FF7B72;">instanceof</span><span style="color:#C9D1D9;"> </span><span style="color:#FFA657;">HashHistory</span><span style="color:#C9D1D9;">) {</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">handleInitialScroll</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> </span><span style="color:#FFA657;">routeOrError</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=&gt;</span><span style="color:#C9D1D9;"> {</span></span>
<span class="line"><span style="color:#C9D1D9;">        </span><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">from</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> history.current</span></span>
<span class="line"><span style="color:#C9D1D9;">        </span><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">expectScroll</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">.options.scrollBehavior</span></span>
<span class="line"><span style="color:#C9D1D9;">        </span><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">supportsScroll</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> supportsPushState </span><span style="color:#FF7B72;">&amp;&amp;</span><span style="color:#C9D1D9;"> expectScroll</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C9D1D9;">        </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (supportsScroll </span><span style="color:#FF7B72;">&amp;&amp;</span><span style="color:#C9D1D9;"> </span><span style="color:#A5D6FF;">&#39;fullPath&#39;</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">in</span><span style="color:#C9D1D9;"> routeOrError) {</span></span>
<span class="line"><span style="color:#C9D1D9;">          </span><span style="color:#D2A8FF;">handleScroll</span><span style="color:#C9D1D9;">(</span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">, routeOrError, from, </span><span style="color:#79C0FF;">false</span><span style="color:#C9D1D9;">)</span></span>
<span class="line"><span style="color:#C9D1D9;">        }</span></span>
<span class="line"><span style="color:#C9D1D9;">      }</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">setupListeners</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> </span><span style="color:#FFA657;">routeOrError</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=&gt;</span><span style="color:#C9D1D9;"> {</span></span>
<span class="line"><span style="color:#C9D1D9;">        history.</span><span style="color:#D2A8FF;">setupListeners</span><span style="color:#C9D1D9;">() </span><span style="color:#8B949E;">// 初始化添加事件监听</span></span>
<span class="line"><span style="color:#C9D1D9;">        </span><span style="color:#D2A8FF;">handleInitialScroll</span><span style="color:#C9D1D9;">(routeOrError)</span></span>
<span class="line"><span style="color:#C9D1D9;">      }</span></span>
<span class="line"><span style="color:#C9D1D9;">      history.</span><span style="color:#D2A8FF;">transitionTo</span><span style="color:#C9D1D9;">( </span><span style="color:#8B949E;">// 如果默认页，需要根据当前浏览器地址栏里的 path 或者 hash 来激活对应的路由</span></span>
<span class="line"><span style="color:#C9D1D9;">        history.</span><span style="color:#D2A8FF;">getCurrentLocation</span><span style="color:#C9D1D9;">(),</span></span>
<span class="line"><span style="color:#C9D1D9;">        setupListeners,</span></span>
<span class="line"><span style="color:#C9D1D9;">        setupListeners</span></span>
<span class="line"><span style="color:#C9D1D9;">      )</span></span>
<span class="line"><span style="color:#C9D1D9;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C9D1D9;">    history.</span><span style="color:#D2A8FF;">listen</span><span style="color:#C9D1D9;">(</span><span style="color:#FFA657;">route</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=&gt;</span><span style="color:#C9D1D9;"> {</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">.apps.</span><span style="color:#D2A8FF;">forEach</span><span style="color:#C9D1D9;">(</span><span style="color:#FFA657;">app</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=&gt;</span><span style="color:#C9D1D9;"> {</span></span>
<span class="line"><span style="color:#C9D1D9;">        app._route </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> route</span></span>
<span class="line"><span style="color:#C9D1D9;">      })</span></span>
<span class="line"><span style="color:#C9D1D9;">    })</span></span>
<span class="line"><span style="color:#C9D1D9;">  }</span></span>
<span class="line"><span style="color:#FFA657;">  </span><span style="color:#8B949E;">//...</span></span>
<span class="line"><span style="color:#FFA657;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8B949E;">// dev/src/history/base.js line 24</span></span>
<span class="line"><span style="color:#FF7B72;">export</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">class</span><span style="color:#C9D1D9;"> </span><span style="color:#FFA657;">History</span><span style="color:#C9D1D9;"> {</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#8B949E;">// ...</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#D2A8FF;">transitionTo</span><span style="color:#C9D1D9;"> (</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FFA657;">location</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#FFA657;">RawLocation</span><span style="color:#C9D1D9;">,</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#D2A8FF;">onComplete</span><span style="color:#FF7B72;">?:</span><span style="color:#C9D1D9;"> </span><span style="color:#FFA657;">Function</span><span style="color:#C9D1D9;">,</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#D2A8FF;">onAbort</span><span style="color:#FF7B72;">?:</span><span style="color:#C9D1D9;"> </span><span style="color:#FFA657;">Function</span></span>
<span class="line"><span style="color:#C9D1D9;">  ) {</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">let</span><span style="color:#C9D1D9;"> route</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#8B949E;">// catch redirect option https://github.com/vuejs/vue-router/issues/3201</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">try</span><span style="color:#C9D1D9;"> {</span></span>
<span class="line"><span style="color:#C9D1D9;">      route </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">.router.</span><span style="color:#D2A8FF;">match</span><span style="color:#C9D1D9;">(location, </span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">.current) </span><span style="color:#8B949E;">// // 获取匹配的路由信息</span></span>
<span class="line"><span style="color:#C9D1D9;">    } </span><span style="color:#FF7B72;">catch</span><span style="color:#C9D1D9;"> (e) {</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">.errorCbs.</span><span style="color:#D2A8FF;">forEach</span><span style="color:#C9D1D9;">(</span><span style="color:#FFA657;">cb</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=&gt;</span><span style="color:#C9D1D9;"> {</span></span>
<span class="line"><span style="color:#C9D1D9;">        </span><span style="color:#D2A8FF;">cb</span><span style="color:#C9D1D9;">(e)</span></span>
<span class="line"><span style="color:#C9D1D9;">      })</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#8B949E;">// Exception should still be thrown</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#FF7B72;">throw</span><span style="color:#C9D1D9;"> e</span></span>
<span class="line"><span style="color:#C9D1D9;">    }</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">prev</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">.current</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">.</span><span style="color:#D2A8FF;">confirmTransition</span><span style="color:#C9D1D9;">( </span><span style="color:#8B949E;">// 确认跳转</span></span>
<span class="line"><span style="color:#C9D1D9;">      route,</span></span>
<span class="line"><span style="color:#C9D1D9;">      () </span><span style="color:#FF7B72;">=&gt;</span><span style="color:#C9D1D9;"> {</span></span>
<span class="line"><span style="color:#C9D1D9;">        </span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">.</span><span style="color:#D2A8FF;">updateRoute</span><span style="color:#C9D1D9;">(route) </span><span style="color:#8B949E;">// 更新当前 route 对象</span></span>
<span class="line"><span style="color:#C9D1D9;">        onComplete </span><span style="color:#FF7B72;">&amp;&amp;</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">onComplete</span><span style="color:#C9D1D9;">(route)</span></span>
<span class="line"><span style="color:#C9D1D9;">        </span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">.</span><span style="color:#D2A8FF;">ensureURL</span><span style="color:#C9D1D9;">() </span><span style="color:#8B949E;">// 子类实现的更新url地址 对于 hash 模式的话 就是更新 hash 的值</span></span>
<span class="line"><span style="color:#C9D1D9;">        </span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">.router.afterHooks.</span><span style="color:#D2A8FF;">forEach</span><span style="color:#C9D1D9;">(</span><span style="color:#FFA657;">hook</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=&gt;</span><span style="color:#C9D1D9;"> {</span></span>
<span class="line"><span style="color:#C9D1D9;">          hook </span><span style="color:#FF7B72;">&amp;&amp;</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">hook</span><span style="color:#C9D1D9;">(route, prev)</span></span>
<span class="line"><span style="color:#C9D1D9;">        })</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C9D1D9;">        </span><span style="color:#8B949E;">// fire ready cbs once</span></span>
<span class="line"><span style="color:#C9D1D9;">        </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (</span><span style="color:#FF7B72;">!</span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">.ready) {</span></span>
<span class="line"><span style="color:#C9D1D9;">          </span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">.ready </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">true</span></span>
<span class="line"><span style="color:#C9D1D9;">          </span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">.readyCbs.</span><span style="color:#D2A8FF;">forEach</span><span style="color:#C9D1D9;">(</span><span style="color:#FFA657;">cb</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=&gt;</span><span style="color:#C9D1D9;"> {</span></span>
<span class="line"><span style="color:#C9D1D9;">            </span><span style="color:#D2A8FF;">cb</span><span style="color:#C9D1D9;">(route)</span></span>
<span class="line"><span style="color:#C9D1D9;">          })</span></span>
<span class="line"><span style="color:#C9D1D9;">        }</span></span>
<span class="line"><span style="color:#C9D1D9;">      },</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#FFA657;">err</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=&gt;</span><span style="color:#C9D1D9;"> {</span></span>
<span class="line"><span style="color:#C9D1D9;">        </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (onAbort) {</span></span>
<span class="line"><span style="color:#C9D1D9;">          </span><span style="color:#D2A8FF;">onAbort</span><span style="color:#C9D1D9;">(err)</span></span>
<span class="line"><span style="color:#C9D1D9;">        }</span></span>
<span class="line"><span style="color:#C9D1D9;">        </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (err </span><span style="color:#FF7B72;">&amp;&amp;</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">!</span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">.ready) {</span></span>
<span class="line"><span style="color:#C9D1D9;">          </span><span style="color:#8B949E;">// Initial redirection should not mark the history as ready yet</span></span>
<span class="line"><span style="color:#C9D1D9;">          </span><span style="color:#8B949E;">// because it&#39;s triggered by the redirection instead</span></span>
<span class="line"><span style="color:#C9D1D9;">          </span><span style="color:#8B949E;">// https://github.com/vuejs/vue-router/issues/3225</span></span>
<span class="line"><span style="color:#C9D1D9;">          </span><span style="color:#8B949E;">// https://github.com/vuejs/vue-router/issues/3331</span></span>
<span class="line"><span style="color:#C9D1D9;">          </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (</span><span style="color:#FF7B72;">!</span><span style="color:#D2A8FF;">isNavigationFailure</span><span style="color:#C9D1D9;">(err, NavigationFailureType.redirected) </span><span style="color:#FF7B72;">||</span><span style="color:#C9D1D9;"> prev </span><span style="color:#FF7B72;">!==</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">START</span><span style="color:#C9D1D9;">) {</span></span>
<span class="line"><span style="color:#C9D1D9;">            </span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">.ready </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">true</span></span>
<span class="line"><span style="color:#C9D1D9;">            </span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">.readyErrorCbs.</span><span style="color:#D2A8FF;">forEach</span><span style="color:#C9D1D9;">(</span><span style="color:#FFA657;">cb</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=&gt;</span><span style="color:#C9D1D9;"> {</span></span>
<span class="line"><span style="color:#C9D1D9;">              </span><span style="color:#D2A8FF;">cb</span><span style="color:#C9D1D9;">(err)</span></span>
<span class="line"><span style="color:#C9D1D9;">            })</span></span>
<span class="line"><span style="color:#C9D1D9;">          }</span></span>
<span class="line"><span style="color:#C9D1D9;">        }</span></span>
<span class="line"><span style="color:#C9D1D9;">      }</span></span>
<span class="line"><span style="color:#C9D1D9;">    )</span></span>
<span class="line"><span style="color:#C9D1D9;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#D2A8FF;">confirmTransition</span><span style="color:#C9D1D9;"> (</span><span style="color:#FFA657;">route</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#FFA657;">Route</span><span style="color:#C9D1D9;">, </span><span style="color:#D2A8FF;">onComplete</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#FFA657;">Function</span><span style="color:#C9D1D9;">, </span><span style="color:#D2A8FF;">onAbort</span><span style="color:#FF7B72;">?:</span><span style="color:#C9D1D9;"> </span><span style="color:#FFA657;">Function</span><span style="color:#C9D1D9;">) {</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">current</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">.current</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">.pending </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> route</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">abort</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> </span><span style="color:#FFA657;">err</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=&gt;</span><span style="color:#C9D1D9;"> {</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#8B949E;">// changed after adding errors with</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#8B949E;">// https://github.com/vuejs/vue-router/pull/3047 before that change,</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#8B949E;">// redirect and aborted navigation would produce an err == null</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (</span><span style="color:#FF7B72;">!</span><span style="color:#D2A8FF;">isNavigationFailure</span><span style="color:#C9D1D9;">(err) </span><span style="color:#FF7B72;">&amp;&amp;</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">isError</span><span style="color:#C9D1D9;">(err)) {</span></span>
<span class="line"><span style="color:#C9D1D9;">        </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (</span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">.errorCbs.</span><span style="color:#79C0FF;">length</span><span style="color:#C9D1D9;">) {</span></span>
<span class="line"><span style="color:#C9D1D9;">          </span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">.errorCbs.</span><span style="color:#D2A8FF;">forEach</span><span style="color:#C9D1D9;">(</span><span style="color:#FFA657;">cb</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=&gt;</span><span style="color:#C9D1D9;"> {</span></span>
<span class="line"><span style="color:#C9D1D9;">            </span><span style="color:#D2A8FF;">cb</span><span style="color:#C9D1D9;">(err)</span></span>
<span class="line"><span style="color:#C9D1D9;">          })</span></span>
<span class="line"><span style="color:#C9D1D9;">        } </span><span style="color:#FF7B72;">else</span><span style="color:#C9D1D9;"> {</span></span>
<span class="line"><span style="color:#C9D1D9;">          </span><span style="color:#D2A8FF;">warn</span><span style="color:#C9D1D9;">(</span><span style="color:#79C0FF;">false</span><span style="color:#C9D1D9;">, </span><span style="color:#A5D6FF;">&#39;uncaught error during route navigation:&#39;</span><span style="color:#C9D1D9;">)</span></span>
<span class="line"><span style="color:#C9D1D9;">          console.</span><span style="color:#D2A8FF;">error</span><span style="color:#C9D1D9;">(err)</span></span>
<span class="line"><span style="color:#C9D1D9;">        }</span></span>
<span class="line"><span style="color:#C9D1D9;">      }</span></span>
<span class="line"><span style="color:#C9D1D9;">      onAbort </span><span style="color:#FF7B72;">&amp;&amp;</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">onAbort</span><span style="color:#C9D1D9;">(err)</span></span>
<span class="line"><span style="color:#C9D1D9;">    }</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">lastRouteIndex</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> route.matched.</span><span style="color:#79C0FF;">length</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">-</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">1</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">lastCurrentIndex</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> current.matched.</span><span style="color:#79C0FF;">length</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">-</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">1</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#D2A8FF;">isSameRoute</span><span style="color:#C9D1D9;">(route, current) </span><span style="color:#FF7B72;">&amp;&amp;</span><span style="color:#C9D1D9;"> </span><span style="color:#8B949E;">// 如果是相同的路由就不跳转</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#8B949E;">// in the case the route map has been dynamically appended to</span></span>
<span class="line"><span style="color:#C9D1D9;">      lastRouteIndex </span><span style="color:#FF7B72;">===</span><span style="color:#C9D1D9;"> lastCurrentIndex </span><span style="color:#FF7B72;">&amp;&amp;</span></span>
<span class="line"><span style="color:#C9D1D9;">      route.matched[lastRouteIndex] </span><span style="color:#FF7B72;">===</span><span style="color:#C9D1D9;"> current.matched[lastCurrentIndex]</span></span>
<span class="line"><span style="color:#C9D1D9;">    ) {</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">.</span><span style="color:#D2A8FF;">ensureURL</span><span style="color:#C9D1D9;">()</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#FF7B72;">return</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">abort</span><span style="color:#C9D1D9;">(</span><span style="color:#D2A8FF;">createNavigationDuplicatedError</span><span style="color:#C9D1D9;">(current, route))</span></span>
<span class="line"><span style="color:#C9D1D9;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> { </span><span style="color:#79C0FF;">updated</span><span style="color:#C9D1D9;">, </span><span style="color:#79C0FF;">deactivated</span><span style="color:#C9D1D9;">, </span><span style="color:#79C0FF;">activated</span><span style="color:#C9D1D9;"> } </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">resolveQueue</span><span style="color:#C9D1D9;">( </span><span style="color:#8B949E;">// 通过对比路由解析出可复用的组件，需要渲染的组件，失活的组件</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">.current.matched,</span></span>
<span class="line"><span style="color:#C9D1D9;">      route.matched</span></span>
<span class="line"><span style="color:#C9D1D9;">    )</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">queue</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#FFA657;">Array</span><span style="color:#C9D1D9;">&lt;</span><span style="color:#FF7B72;">?</span><span style="color:#FFA657;">NavigationGuard</span><span style="color:#C9D1D9;">&gt; </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> [].</span><span style="color:#D2A8FF;">concat</span><span style="color:#C9D1D9;">( </span><span style="color:#8B949E;">// 导航守卫数组</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#8B949E;">// in-component leave guards</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#D2A8FF;">extractLeaveGuards</span><span style="color:#C9D1D9;">(deactivated),  </span><span style="color:#8B949E;">// 失活的组件钩子</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#8B949E;">// global before hooks</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">.router.beforeHooks, </span><span style="color:#8B949E;">// 全局 beforeEach 钩子</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#8B949E;">// in-component update hooks</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#D2A8FF;">extractUpdateHooks</span><span style="color:#C9D1D9;">(updated), </span><span style="color:#8B949E;">// 在当前路由改变，但是该组件被复用时调用</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#8B949E;">// in-config enter guards</span></span>
<span class="line"><span style="color:#C9D1D9;">      activated.</span><span style="color:#D2A8FF;">map</span><span style="color:#C9D1D9;">(</span><span style="color:#FFA657;">m</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=&gt;</span><span style="color:#C9D1D9;"> m.beforeEnter), </span><span style="color:#8B949E;">// 需要渲染组件 enter 守卫钩子</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#8B949E;">// async components</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#D2A8FF;">resolveAsyncComponents</span><span style="color:#C9D1D9;">(activated) </span><span style="color:#8B949E;">// 解析异步路由组件</span></span>
<span class="line"><span style="color:#C9D1D9;">    )</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">iterator</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> (</span><span style="color:#FFA657;">hook</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#FFA657;">NavigationGuard</span><span style="color:#C9D1D9;">, </span><span style="color:#FFA657;">next</span><span style="color:#C9D1D9;">) </span><span style="color:#FF7B72;">=&gt;</span><span style="color:#C9D1D9;"> {</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (</span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">.pending </span><span style="color:#FF7B72;">!==</span><span style="color:#C9D1D9;"> route) { </span><span style="color:#8B949E;">// 路由不相等就不跳转路由</span></span>
<span class="line"><span style="color:#C9D1D9;">        </span><span style="color:#FF7B72;">return</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">abort</span><span style="color:#C9D1D9;">(</span><span style="color:#D2A8FF;">createNavigationCancelledError</span><span style="color:#C9D1D9;">(current, route))</span></span>
<span class="line"><span style="color:#C9D1D9;">      }</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#FF7B72;">try</span><span style="color:#C9D1D9;"> {</span></span>
<span class="line"><span style="color:#C9D1D9;">        </span><span style="color:#D2A8FF;">hook</span><span style="color:#C9D1D9;">(route, current, (</span><span style="color:#FFA657;">to</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">any</span><span style="color:#C9D1D9;">) </span><span style="color:#FF7B72;">=&gt;</span><span style="color:#C9D1D9;"> { </span><span style="color:#8B949E;">// 只有执行了钩子函数中的next，才会继续执行下一个钩子函数，否则会暂停跳转，以下逻辑是在判断 next() 中的传参</span></span>
<span class="line"><span style="color:#C9D1D9;">          </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (to </span><span style="color:#FF7B72;">===</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">false</span><span style="color:#C9D1D9;">) {</span></span>
<span class="line"><span style="color:#C9D1D9;">            </span><span style="color:#8B949E;">// next(false) -&gt; abort navigation, ensure current URL</span></span>
<span class="line"><span style="color:#C9D1D9;">            </span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">.</span><span style="color:#D2A8FF;">ensureURL</span><span style="color:#C9D1D9;">(</span><span style="color:#79C0FF;">true</span><span style="color:#C9D1D9;">)</span></span>
<span class="line"><span style="color:#C9D1D9;">            </span><span style="color:#D2A8FF;">abort</span><span style="color:#C9D1D9;">(</span><span style="color:#D2A8FF;">createNavigationAbortedError</span><span style="color:#C9D1D9;">(current, route))</span></span>
<span class="line"><span style="color:#C9D1D9;">          } </span><span style="color:#FF7B72;">else</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (</span><span style="color:#D2A8FF;">isError</span><span style="color:#C9D1D9;">(to)) {</span></span>
<span class="line"><span style="color:#C9D1D9;">            </span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">.</span><span style="color:#D2A8FF;">ensureURL</span><span style="color:#C9D1D9;">(</span><span style="color:#79C0FF;">true</span><span style="color:#C9D1D9;">)</span></span>
<span class="line"><span style="color:#C9D1D9;">            </span><span style="color:#D2A8FF;">abort</span><span style="color:#C9D1D9;">(to)</span></span>
<span class="line"><span style="color:#C9D1D9;">          } </span><span style="color:#FF7B72;">else</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (</span></span>
<span class="line"><span style="color:#C9D1D9;">            </span><span style="color:#FF7B72;">typeof</span><span style="color:#C9D1D9;"> to </span><span style="color:#FF7B72;">===</span><span style="color:#C9D1D9;"> </span><span style="color:#A5D6FF;">&#39;string&#39;</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">||</span></span>
<span class="line"><span style="color:#C9D1D9;">            (</span><span style="color:#FF7B72;">typeof</span><span style="color:#C9D1D9;"> to </span><span style="color:#FF7B72;">===</span><span style="color:#C9D1D9;"> </span><span style="color:#A5D6FF;">&#39;object&#39;</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">&amp;&amp;</span></span>
<span class="line"><span style="color:#C9D1D9;">              (</span><span style="color:#FF7B72;">typeof</span><span style="color:#C9D1D9;"> to.path </span><span style="color:#FF7B72;">===</span><span style="color:#C9D1D9;"> </span><span style="color:#A5D6FF;">&#39;string&#39;</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">||</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">typeof</span><span style="color:#C9D1D9;"> to.name </span><span style="color:#FF7B72;">===</span><span style="color:#C9D1D9;"> </span><span style="color:#A5D6FF;">&#39;string&#39;</span><span style="color:#C9D1D9;">))</span></span>
<span class="line"><span style="color:#C9D1D9;">          ) {</span></span>
<span class="line"><span style="color:#C9D1D9;">            </span><span style="color:#8B949E;">// next(&#39;/&#39;) or next({ path: &#39;/&#39; }) -&gt; redirect</span></span>
<span class="line"><span style="color:#C9D1D9;">            </span><span style="color:#D2A8FF;">abort</span><span style="color:#C9D1D9;">(</span><span style="color:#D2A8FF;">createNavigationRedirectedError</span><span style="color:#C9D1D9;">(current, route))</span></span>
<span class="line"><span style="color:#C9D1D9;">            </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (</span><span style="color:#FF7B72;">typeof</span><span style="color:#C9D1D9;"> to </span><span style="color:#FF7B72;">===</span><span style="color:#C9D1D9;"> </span><span style="color:#A5D6FF;">&#39;object&#39;</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">&amp;&amp;</span><span style="color:#C9D1D9;"> to.replace) {</span></span>
<span class="line"><span style="color:#C9D1D9;">              </span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">.</span><span style="color:#D2A8FF;">replace</span><span style="color:#C9D1D9;">(to)</span></span>
<span class="line"><span style="color:#C9D1D9;">            } </span><span style="color:#FF7B72;">else</span><span style="color:#C9D1D9;"> {</span></span>
<span class="line"><span style="color:#C9D1D9;">              </span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">.</span><span style="color:#D2A8FF;">push</span><span style="color:#C9D1D9;">(to)</span></span>
<span class="line"><span style="color:#C9D1D9;">            }</span></span>
<span class="line"><span style="color:#C9D1D9;">          } </span><span style="color:#FF7B72;">else</span><span style="color:#C9D1D9;"> {</span></span>
<span class="line"><span style="color:#C9D1D9;">            </span><span style="color:#8B949E;">// confirm transition and pass on the value</span></span>
<span class="line"><span style="color:#C9D1D9;">            </span><span style="color:#D2A8FF;">next</span><span style="color:#C9D1D9;">(to)</span></span>
<span class="line"><span style="color:#C9D1D9;">          }</span></span>
<span class="line"><span style="color:#C9D1D9;">        })</span></span>
<span class="line"><span style="color:#C9D1D9;">      } </span><span style="color:#FF7B72;">catch</span><span style="color:#C9D1D9;"> (e) {</span></span>
<span class="line"><span style="color:#C9D1D9;">        </span><span style="color:#D2A8FF;">abort</span><span style="color:#C9D1D9;">(e)</span></span>
<span class="line"><span style="color:#C9D1D9;">      }</span></span>
<span class="line"><span style="color:#C9D1D9;">    }</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#8B949E;">// ...</span></span>
<span class="line"><span style="color:#C9D1D9;">  }</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#8B949E;">// ...</span></span>
<span class="line"><span style="color:#C9D1D9;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8B949E;">// dev/src/history/html5.js line 10</span></span>
<span class="line"><span style="color:#FF7B72;">export</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">class</span><span style="color:#C9D1D9;"> </span><span style="color:#FFA657;">HTML5History</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">extends</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">History</span><span style="color:#C9D1D9;"> {</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FFA657;">_startLocation</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">string</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">constructor</span><span style="color:#C9D1D9;"> (</span><span style="color:#FFA657;">router</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#FFA657;">Router</span><span style="color:#C9D1D9;">, </span><span style="color:#FFA657;">base</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">?</span><span style="color:#79C0FF;">string</span><span style="color:#C9D1D9;">) {</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#79C0FF;">super</span><span style="color:#C9D1D9;">(router, base)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">._startLocation </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">getLocation</span><span style="color:#C9D1D9;">(</span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">.base)</span></span>
<span class="line"><span style="color:#C9D1D9;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#D2A8FF;">setupListeners</span><span style="color:#C9D1D9;"> () { </span><span style="color:#8B949E;">// 初始化</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (</span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">.listeners.</span><span style="color:#79C0FF;">length</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">&gt;</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">0</span><span style="color:#C9D1D9;">) {</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#FF7B72;">return</span></span>
<span class="line"><span style="color:#C9D1D9;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">router</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">.router</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">expectScroll</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> router.options.scrollBehavior</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">supportsScroll</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> supportsPushState </span><span style="color:#FF7B72;">&amp;&amp;</span><span style="color:#C9D1D9;"> expectScroll</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (supportsScroll) {</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">.listeners.</span><span style="color:#D2A8FF;">push</span><span style="color:#C9D1D9;">(</span><span style="color:#D2A8FF;">setupScroll</span><span style="color:#C9D1D9;">())</span></span>
<span class="line"><span style="color:#C9D1D9;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">handleRoutingEvent</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> () </span><span style="color:#FF7B72;">=&gt;</span><span style="color:#C9D1D9;"> {</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">current</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">.current</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#8B949E;">// Avoiding first `popstate` event dispatched in some browsers but first</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#8B949E;">// history route not updated since async guard at the same time.</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">location</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">getLocation</span><span style="color:#C9D1D9;">(</span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">.base)</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (</span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">.current </span><span style="color:#FF7B72;">===</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">START</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">&amp;&amp;</span><span style="color:#C9D1D9;"> location </span><span style="color:#FF7B72;">===</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">._startLocation) {</span></span>
<span class="line"><span style="color:#C9D1D9;">        </span><span style="color:#FF7B72;">return</span></span>
<span class="line"><span style="color:#C9D1D9;">      }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">.</span><span style="color:#D2A8FF;">transitionTo</span><span style="color:#C9D1D9;">(location, </span><span style="color:#FFA657;">route</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=&gt;</span><span style="color:#C9D1D9;"> {</span></span>
<span class="line"><span style="color:#C9D1D9;">        </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (supportsScroll) {</span></span>
<span class="line"><span style="color:#C9D1D9;">          </span><span style="color:#D2A8FF;">handleScroll</span><span style="color:#C9D1D9;">(router, route, current, </span><span style="color:#79C0FF;">true</span><span style="color:#C9D1D9;">)</span></span>
<span class="line"><span style="color:#C9D1D9;">        }</span></span>
<span class="line"><span style="color:#C9D1D9;">      })</span></span>
<span class="line"><span style="color:#C9D1D9;">    }</span></span>
<span class="line"><span style="color:#C9D1D9;">    window.</span><span style="color:#D2A8FF;">addEventListener</span><span style="color:#C9D1D9;">(</span><span style="color:#A5D6FF;">&#39;popstate&#39;</span><span style="color:#C9D1D9;">, handleRoutingEvent) </span><span style="color:#8B949E;">// 事件监听</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">.listeners.</span><span style="color:#D2A8FF;">push</span><span style="color:#C9D1D9;">(() </span><span style="color:#FF7B72;">=&gt;</span><span style="color:#C9D1D9;"> {</span></span>
<span class="line"><span style="color:#C9D1D9;">      window.</span><span style="color:#D2A8FF;">removeEventListener</span><span style="color:#C9D1D9;">(</span><span style="color:#A5D6FF;">&#39;popstate&#39;</span><span style="color:#C9D1D9;">, handleRoutingEvent)</span></span>
<span class="line"><span style="color:#C9D1D9;">    })</span></span>
<span class="line"><span style="color:#C9D1D9;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#D2A8FF;">go</span><span style="color:#C9D1D9;"> (</span><span style="color:#FFA657;">n</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">number</span><span style="color:#C9D1D9;">) {</span></span>
<span class="line"><span style="color:#C9D1D9;">    window.history.</span><span style="color:#D2A8FF;">go</span><span style="color:#C9D1D9;">(n)</span></span>
<span class="line"><span style="color:#C9D1D9;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#D2A8FF;">push</span><span style="color:#C9D1D9;"> (</span><span style="color:#FFA657;">location</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#FFA657;">RawLocation</span><span style="color:#C9D1D9;">, </span><span style="color:#D2A8FF;">onComplete</span><span style="color:#FF7B72;">?:</span><span style="color:#C9D1D9;"> </span><span style="color:#FFA657;">Function</span><span style="color:#C9D1D9;">, </span><span style="color:#D2A8FF;">onAbort</span><span style="color:#FF7B72;">?:</span><span style="color:#C9D1D9;"> </span><span style="color:#FFA657;">Function</span><span style="color:#C9D1D9;">) {</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> { </span><span style="color:#FFA657;">current</span><span style="color:#C9D1D9;">: </span><span style="color:#79C0FF;">fromRoute</span><span style="color:#C9D1D9;"> } </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">this</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">.</span><span style="color:#D2A8FF;">transitionTo</span><span style="color:#C9D1D9;">(location, </span><span style="color:#FFA657;">route</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=&gt;</span><span style="color:#C9D1D9;"> {</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#D2A8FF;">pushState</span><span style="color:#C9D1D9;">(</span><span style="color:#D2A8FF;">cleanPath</span><span style="color:#C9D1D9;">(</span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">.base </span><span style="color:#FF7B72;">+</span><span style="color:#C9D1D9;"> route.fullPath))</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#D2A8FF;">handleScroll</span><span style="color:#C9D1D9;">(</span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">.router, route, fromRoute, </span><span style="color:#79C0FF;">false</span><span style="color:#C9D1D9;">)</span></span>
<span class="line"><span style="color:#C9D1D9;">      onComplete </span><span style="color:#FF7B72;">&amp;&amp;</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">onComplete</span><span style="color:#C9D1D9;">(route)</span></span>
<span class="line"><span style="color:#C9D1D9;">    }, onAbort)</span></span>
<span class="line"><span style="color:#C9D1D9;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#D2A8FF;">replace</span><span style="color:#C9D1D9;"> (</span><span style="color:#FFA657;">location</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#FFA657;">RawLocation</span><span style="color:#C9D1D9;">, </span><span style="color:#D2A8FF;">onComplete</span><span style="color:#FF7B72;">?:</span><span style="color:#C9D1D9;"> </span><span style="color:#FFA657;">Function</span><span style="color:#C9D1D9;">, </span><span style="color:#D2A8FF;">onAbort</span><span style="color:#FF7B72;">?:</span><span style="color:#C9D1D9;"> </span><span style="color:#FFA657;">Function</span><span style="color:#C9D1D9;">) {</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> { </span><span style="color:#FFA657;">current</span><span style="color:#C9D1D9;">: </span><span style="color:#79C0FF;">fromRoute</span><span style="color:#C9D1D9;"> } </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">this</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">.</span><span style="color:#D2A8FF;">transitionTo</span><span style="color:#C9D1D9;">(location, </span><span style="color:#FFA657;">route</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=&gt;</span><span style="color:#C9D1D9;"> {</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#D2A8FF;">replaceState</span><span style="color:#C9D1D9;">(</span><span style="color:#D2A8FF;">cleanPath</span><span style="color:#C9D1D9;">(</span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">.base </span><span style="color:#FF7B72;">+</span><span style="color:#C9D1D9;"> route.fullPath))</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#D2A8FF;">handleScroll</span><span style="color:#C9D1D9;">(</span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">.router, route, fromRoute, </span><span style="color:#79C0FF;">false</span><span style="color:#C9D1D9;">)</span></span>
<span class="line"><span style="color:#C9D1D9;">      onComplete </span><span style="color:#FF7B72;">&amp;&amp;</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">onComplete</span><span style="color:#C9D1D9;">(route)</span></span>
<span class="line"><span style="color:#C9D1D9;">    }, onAbort)</span></span>
<span class="line"><span style="color:#C9D1D9;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#D2A8FF;">ensureURL</span><span style="color:#C9D1D9;"> (</span><span style="color:#FFA657;">push</span><span style="color:#FF7B72;">?:</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">boolean</span><span style="color:#C9D1D9;">) {</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (</span><span style="color:#D2A8FF;">getLocation</span><span style="color:#C9D1D9;">(</span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">.base) </span><span style="color:#FF7B72;">!==</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">.current.fullPath) {</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">current</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">cleanPath</span><span style="color:#C9D1D9;">(</span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">.base </span><span style="color:#FF7B72;">+</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">.current.fullPath)</span></span>
<span class="line"><span style="color:#C9D1D9;">      push </span><span style="color:#FF7B72;">?</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">pushState</span><span style="color:#C9D1D9;">(current) </span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">replaceState</span><span style="color:#C9D1D9;">(current)</span></span>
<span class="line"><span style="color:#C9D1D9;">    }</span></span>
<span class="line"><span style="color:#C9D1D9;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#D2A8FF;">getCurrentLocation</span><span style="color:#C9D1D9;"> ()</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">string</span><span style="color:#C9D1D9;"> {</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">return</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">getLocation</span><span style="color:#C9D1D9;">(</span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">.base)</span></span>
<span class="line"><span style="color:#C9D1D9;">  }</span></span>
<span class="line"><span style="color:#C9D1D9;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br><span class="line-number">182</span><br><span class="line-number">183</span><br><span class="line-number">184</span><br><span class="line-number">185</span><br><span class="line-number">186</span><br><span class="line-number">187</span><br><span class="line-number">188</span><br><span class="line-number">189</span><br><span class="line-number">190</span><br><span class="line-number">191</span><br><span class="line-number">192</span><br><span class="line-number">193</span><br><span class="line-number">194</span><br><span class="line-number">195</span><br><span class="line-number">196</span><br><span class="line-number">197</span><br><span class="line-number">198</span><br><span class="line-number">199</span><br><span class="line-number">200</span><br><span class="line-number">201</span><br><span class="line-number">202</span><br><span class="line-number">203</span><br><span class="line-number">204</span><br><span class="line-number">205</span><br><span class="line-number">206</span><br><span class="line-number">207</span><br><span class="line-number">208</span><br><span class="line-number">209</span><br><span class="line-number">210</span><br><span class="line-number">211</span><br><span class="line-number">212</span><br><span class="line-number">213</span><br><span class="line-number">214</span><br><span class="line-number">215</span><br><span class="line-number">216</span><br><span class="line-number">217</span><br><span class="line-number">218</span><br><span class="line-number">219</span><br><span class="line-number">220</span><br><span class="line-number">221</span><br><span class="line-number">222</span><br><span class="line-number">223</span><br><span class="line-number">224</span><br><span class="line-number">225</span><br><span class="line-number">226</span><br><span class="line-number">227</span><br><span class="line-number">228</span><br><span class="line-number">229</span><br><span class="line-number">230</span><br><span class="line-number">231</span><br><span class="line-number">232</span><br><span class="line-number">233</span><br><span class="line-number">234</span><br><span class="line-number">235</span><br><span class="line-number">236</span><br><span class="line-number">237</span><br><span class="line-number">238</span><br><span class="line-number">239</span><br><span class="line-number">240</span><br><span class="line-number">241</span><br><span class="line-number">242</span><br><span class="line-number">243</span><br><span class="line-number">244</span><br><span class="line-number">245</span><br><span class="line-number">246</span><br><span class="line-number">247</span><br><span class="line-number">248</span><br><span class="line-number">249</span><br><span class="line-number">250</span><br><span class="line-number">251</span><br><span class="line-number">252</span><br><span class="line-number">253</span><br><span class="line-number">254</span><br><span class="line-number">255</span><br><span class="line-number">256</span><br><span class="line-number">257</span><br><span class="line-number">258</span><br><span class="line-number">259</span><br><span class="line-number">260</span><br><span class="line-number">261</span><br><span class="line-number">262</span><br><span class="line-number">263</span><br><span class="line-number">264</span><br><span class="line-number">265</span><br><span class="line-number">266</span><br><span class="line-number">267</span><br><span class="line-number">268</span><br><span class="line-number">269</span><br><span class="line-number">270</span><br><span class="line-number">271</span><br><span class="line-number">272</span><br><span class="line-number">273</span><br><span class="line-number">274</span><br><span class="line-number">275</span><br><span class="line-number">276</span><br><span class="line-number">277</span><br><span class="line-number">278</span><br><span class="line-number">279</span><br><span class="line-number">280</span><br><span class="line-number">281</span><br><span class="line-number">282</span><br><span class="line-number">283</span><br><span class="line-number">284</span><br><span class="line-number">285</span><br><span class="line-number">286</span><br><span class="line-number">287</span><br><span class="line-number">288</span><br><span class="line-number">289</span><br><span class="line-number">290</span><br><span class="line-number">291</span><br></div></div><h2 id="参考" tabindex="-1">参考 <a class="header-anchor" href="#参考" aria-hidden="true">#</a></h2><div class="language- line-numbers-mode"><button class="copy"></button><span class="lang"></span><pre><code><span class="line"><span style="color:#c9d1d9;">https://www.jianshu.com/p/557f2ba86892</span></span>
<span class="line"><span style="color:#c9d1d9;">https://juejin.im/post/6844904159678824456</span></span>
<span class="line"><span style="color:#c9d1d9;">https://juejin.im/post/6844904012630720526</span></span>
<span class="line"><span style="color:#c9d1d9;">https://juejin.im/post/6844904062698127367</span></span>
<span class="line"><span style="color:#c9d1d9;">https://developer.mozilla.org/zh-CN/docs/Web/API/History/pushState</span></span>
<span class="line"><span style="color:#c9d1d9;">https://liyucang-git.github.io/2019/08/15/vue-router%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/</span></span>
<span class="line"><span style="color:#c9d1d9;">https://router.vuejs.org/zh/guide/essentials/history-mode.html#%E5%90%8E%E7%AB%AF%E9%85%8D%E7%BD%AE%E4%BE%8B%E5%AD%90</span></span>
<span class="line"><span style="color:#c9d1d9;"></span></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div></div></div></main><!--[--><!--]--><footer class="VPDocFooter" data-v-f0af2311 data-v-a54a85bd><div class="edit-info" data-v-a54a85bd><!----><div class="last-updated" data-v-a54a85bd><p class="VPLastUpdated" data-v-a54a85bd data-v-f7d51a9c>最近更新时间: <time datatime="2024-08-18T01:34:12.000Z" data-v-f7d51a9c></time></p></div></div><div class="prev-next" data-v-a54a85bd><div class="pager" data-v-a54a85bd><a class="pager-link prev" href="/comK/frontend/Vue/Vue%E8%B7%AF%E7%94%B1Hash%E6%A8%A1%E5%BC%8F%E5%88%86%E6%9E%90.html" data-v-a54a85bd><span class="desc" data-v-a54a85bd> 上一页 </span><span class="title" data-v-a54a85bd>Vue路由Hash模式分析</span></a></div><div class="has-prev pager" data-v-a54a85bd><a class="pager-link next" href="/comK/frontend/Vue/Vue%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F.html" data-v-a54a85bd><span class="desc" data-v-a54a85bd> 下一页 </span><span class="title" data-v-a54a85bd>Vue生命周期</span></a></div></div></footer><!--[--><!--]--></div></div></div></div></div><footer class="VPFooter has-sidebar" data-v-ca9ccb7e data-v-9f24cc86><div class="container" data-v-9f24cc86><p class="message" data-v-9f24cc86>Released under the MIT License.</p><p class="copyright" data-v-9f24cc86>Copyright © 2022-present wxf</p></div></footer><!--[--><!--]--></div></div>
    <script>__VP_HASH_MAP__ = JSON.parse("{\"pluginextension_tuieditor_index.md\":\"0030f23a\",\"backend_javase_index.md\":\"aea5e1b6\",\"backend_maven_index.md\":\"62b0acbd\",\"frontend_html_300ms点击延迟.md\":\"99e21b01\",\"frontend_html_attribute和property的区别.md\":\"c921be10\",\"frontend_html_canvas基础.md\":\"9d1e38f2\",\"frontend_html_cookie与session.md\":\"94ceb305\",\"frontend_html_dom和bom的区别.md\":\"b9229a57\",\"frontend_html_html与xhtml区别.md\":\"0ce6e569\",\"frontend_html_html节点操作.md\":\"a16ad9ee\",\"frontend_html_iframe框架及优缺点.md\":\"28131477\",\"frontend_html_localstorage与sessionstorage.md\":\"7f0a6f13\",\"frontend_html_service worker的应用.md\":\"b4e7e1ac\",\"frontend_html_shadow dom的理解.md\":\"a1599a14\",\"frontend_html_web worker.md\":\"b7a5ec42\",\"frontend_html_index.md\":\"02606e6c\",\"frontend_html_前端性能优化方案.md\":\"581e898f\",\"frontend_html_可替换元素和非替换元素.md\":\"c3d56a8f\",\"frontend_html_图片等比例缩放方案.md\":\"7e963c7f\",\"frontend_html_实现三栏布局.md\":\"4554c5b3\",\"frontend_html_实现加载提示组件.md\":\"eb4473f9\",\"frontend_html_实现图片懒加载.md\":\"bdec0cb8\",\"frontend_html_实现拼图滑动验证码.md\":\"495afa8c\",\"frontend_html_实现消息提示组件.md\":\"b7da3b4a\",\"frontend_html_实现瀑布流布局.md\":\"d20ba659\",\"frontend_html_手动实现轮播图功能.md\":\"2b549b7b\",\"frontend_html_蒙层禁止页面滚动的方案.md\":\"3a7f91bf\",\"frontend_html_行内元素和块级元素.md\":\"212c3b1b\",\"frontend_html_默认行为及阻止.md\":\"05054d8d\",\"frontend_node_index.md\":\"d90ab25e\",\"frontend_pinia_index.md\":\"3a02f348\",\"frontend_vue_mvvm模式的理解.md\":\"83cb18dd\",\"frontend_vue_spa单页应用的优缺点.md\":\"efadd364\",\"frontend_vue_vue3.0新特性.md\":\"49f98a3c\",\"frontend_vue_vuerouter导航守卫.md\":\"cab81646\",\"frontend_vue_vuex中的核心方法.md\":\"fb7e5a22\",\"frontend_vue_vuex和普通全局对象.md\":\"8f6e7090\",\"frontend_vue_vue中computed分析.md\":\"4bf4e0f8\",\"frontend_vue_vue中diff算法的理解.md\":\"bbb3464a\",\"frontend_vue_vue中key的作用.md\":\"f72294f0\",\"frontend_vue_vue中nexttick的理解.md\":\"1ed351e8\",\"frontend_vue_vue中refs的理解.md\":\"12a9ffd3\",\"frontend_vue_vue中数组变动监听.md\":\"ae74f163\",\"frontend_vue_vue中的三种watcher.md\":\"3d4c9155\",\"frontend_vue_vue中组件间通信的方式.md\":\"aa1bfe5d\",\"frontend_vue_vue中虚拟dom的理解.md\":\"4c4be670\",\"frontend_vue_vue为何采用异步渲染.md\":\"3e0700bd\",\"frontend_vue_vue事件绑定原理.md\":\"7319177a\",\"frontend_vue_vue常用性能优化.md\":\"7960322c\",\"frontend_vue_vue数据双向绑定.md\":\"aed064d5\",\"frontend_vue_vue父子组件生命周期.md\":\"11fa88ad\",\"frontend_vue_vue生命周期.md\":\"91bd44c3\",\"frontend_vue_vue路由hash模式分析.md\":\"96aedadb\",\"frontend_vue_vue路由history模式分析.md\":\"c9a929a8\",\"frontend_vue_vue路由懒加载.md\":\"49f1e09e\",\"frontend_vue_vue首屏性能优化组件.md\":\"db1632dc\",\"frontend_vue_data为何以函数形式返回.md\":\"59d86cb9\",\"frontend_vue_index.md\":\"72a7cb3c\",\"frontend_vue_v-html可能导致的问题.md\":\"95b09b94\",\"frontend_vue_v-if与v-show的区别.md\":\"62a1c0b0\",\"frontend_vue_v-model数据绑定分析.md\":\"75fec827\",\"frontend_vue_对keep-alive组件的理解.md\":\"2bed5dcf\",\"frontend_vue_服务端渲染ssr的理解.md\":\"ac2d41f0\",\"frontend_webpack_basic.md\":\"d3becd5e\",\"frontend_webpack_support.md\":\"0df8feea\",\"frontend_webpack_usesteps.md\":\"ee1c519e\",\"index.md\":\"819a0748\",\"personal_start.md\":\"9a06ac15\",\"toolsoftware_linux_aspell命令.md\":\"7c09d77e\",\"toolsoftware_linux_awk命令.md\":\"7a24403d\",\"toolsoftware_linux_chattr命令.md\":\"b8f97308\",\"toolsoftware_linux_chmod命令.md\":\"bf4d79d0\",\"toolsoftware_linux_chown命令.md\":\"23b701b7\",\"toolsoftware_linux_cmp命令.md\":\"fe8458ad\",\"toolsoftware_linux_colrm命令.md\":\"e07685ed\",\"toolsoftware_linux_col命令.md\":\"0385b7d9\",\"toolsoftware_linux_comm命令.md\":\"422cd163\",\"toolsoftware_linux_csplit命令.md\":\"8df0fe06\",\"toolsoftware_linux_curl命令.md\":\"c05f1fd4\",\"toolsoftware_linux_cut命令.md\":\"618b8e57\",\"toolsoftware_linux_diffstat命令.md\":\"7c28ac6b\",\"toolsoftware_linux_diff命令.md\":\"caf62c65\",\"toolsoftware_linux_ed命令.md\":\"b9863bb3\",\"toolsoftware_linux_egrep命令.md\":\"fd74097f\",\"toolsoftware_linux_expr命令.md\":\"1e7b7b3f\",\"toolsoftware_linux_ex命令.md\":\"838f0066\",\"toolsoftware_linux_fgrep命令.md\":\"0b49cc95\",\"toolsoftware_linux_file命令.md\":\"82c92acb\",\"toolsoftware_linux_find命令.md\":\"444784a6\",\"toolsoftware_linux_fmt命令.md\":\"2fe826c2\",\"toolsoftware_linux_fold命令.md\":\"6535a6b2\",\"toolsoftware_linux_grep命令.md\":\"cb3d1f2c\",\"toolsoftware_linux_index.md\":\"f860a9dd\",\"toolsoftware_linux_ip命令.md\":\"e65e88ac\",\"toolsoftware_linux_join命令.md\":\"26de81de\",\"toolsoftware_linux_journalctl命令.md\":\"d4c09cba\",\"toolsoftware_linux_less命令.md\":\"dc830ab0\",\"toolsoftware_linux_ln命令.md\":\"9a293412\",\"toolsoftware_linux_locate命令.md\":\"c573091d\",\"toolsoftware_linux_look命令.md\":\"4b8ec859\",\"toolsoftware_linux_lsattr命令.md\":\"ad0405ed\",\"toolsoftware_linux_mc命令.md\":\"78a07c19\",\"toolsoftware_linux_more命令.md\":\"a82fe005\",\"toolsoftware_linux_mv命令.md\":\"e0812cea\",\"toolsoftware_linux_netstat命令.md\":\"43c8f870\",\"toolsoftware_linux_od命令.md\":\"3baf3913\",\"toolsoftware_linux_paste命令.md\":\"0c45be47\",\"toolsoftware_linux_patch命令.md\":\"a6d9698d\",\"toolsoftware_linux_pico命令.md\":\"b5c9b8f2\",\"toolsoftware_linux_ps命令.md\":\"d9f04539\",\"toolsoftware_linux_rcp命令.md\":\"0c80d396\",\"toolsoftware_linux_read命令.md\":\"28a83faf\",\"toolsoftware_linux_rm命令.md\":\"19a3a814\",\"toolsoftware_linux_scp命令.md\":\"75bd8957\",\"toolsoftware_linux_sed命令.md\":\"d5e16b3b\",\"toolsoftware_linux_sort命令.md\":\"c5ae099c\",\"toolsoftware_linux_split命令.md\":\"7d6a7a3c\",\"toolsoftware_linux_systemctl命令.md\":\"e8aa2298\",\"toolsoftware_linux_tee命令.md\":\"a1a4d6aa\",\"toolsoftware_linux_tmpwatch命令.md\":\"574cf072\",\"toolsoftware_linux_top命令.md\":\"f078cf15\",\"toolsoftware_linux_touch命令.md\":\"0e947e6d\",\"toolsoftware_linux_traceroute命令.md\":\"9f0ee746\",\"toolsoftware_linux_tr命令.md\":\"49c1ebd2\",\"toolsoftware_linux_umask命令.md\":\"7dd287c3\",\"toolsoftware_linux_updatedb命令.md\":\"4042bc64\",\"toolsoftware_linux_whereis命令.md\":\"97737abc\",\"toolsoftware_linux_which命令.md\":\"dae01ea1\"}")</script>
    <script type="module" async src="/comK/assets/app.02c23f2e.js"></script>
    
  </body>
</html>