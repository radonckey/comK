import{_ as s,c as n,o as a,a as l}from"./app.02c23f2e.js";const b=JSON.parse('{"title":"Vue\u4E8B\u4EF6\u7ED1\u5B9A\u539F\u7406","description":"","frontmatter":{},"headers":[{"level":2,"title":"\u63CF\u8FF0","slug":"\u63CF\u8FF0","link":"#\u63CF\u8FF0","children":[{"level":3,"title":"\u4FEE\u9970\u7B26","slug":"\u4FEE\u9970\u7B26","link":"#\u4FEE\u9970\u7B26","children":[]},{"level":3,"title":"\u666E\u901A\u5143\u7D20","slug":"\u666E\u901A\u5143\u7D20","link":"#\u666E\u901A\u5143\u7D20","children":[]},{"level":3,"title":"\u7EC4\u4EF6\u5143\u7D20","slug":"\u7EC4\u4EF6\u5143\u7D20","link":"#\u7EC4\u4EF6\u5143\u7D20","children":[]}]},{"level":2,"title":"\u5206\u6790","slug":"\u5206\u6790","link":"#\u5206\u6790","children":[{"level":3,"title":"\u7F16\u8BD1\u9636\u6BB5","slug":"\u7F16\u8BD1\u9636\u6BB5","link":"#\u7F16\u8BD1\u9636\u6BB5","children":[]},{"level":3,"title":"\u4EE3\u7801\u751F\u6210","slug":"\u4EE3\u7801\u751F\u6210","link":"#\u4EE3\u7801\u751F\u6210","children":[]},{"level":3,"title":"\u4E8B\u4EF6\u7ED1\u5B9A","slug":"\u4E8B\u4EF6\u7ED1\u5B9A","link":"#\u4E8B\u4EF6\u7ED1\u5B9A","children":[]}]},{"level":2,"title":"\u53C2\u8003","slug":"\u53C2\u8003","link":"#\u53C2\u8003","children":[]}],"relativePath":"frontend/Vue/Vue\u4E8B\u4EF6\u7ED1\u5B9A\u539F\u7406.md","lastUpdated":1723944852000}'),p={name:"frontend/Vue/Vue\u4E8B\u4EF6\u7ED1\u5B9A\u539F\u7406.md"},e=l(`<h1 id="vue\u4E8B\u4EF6\u7ED1\u5B9A\u539F\u7406" tabindex="-1">Vue\u4E8B\u4EF6\u7ED1\u5B9A\u539F\u7406 <a class="header-anchor" href="#vue\u4E8B\u4EF6\u7ED1\u5B9A\u539F\u7406" aria-hidden="true">#</a></h1><p><code>Vue</code>\u4E2D\u901A\u8FC7<code>v-on</code>\u6216\u5176\u8BED\u6CD5\u7CD6<code>@</code>\u6307\u4EE4\u6765\u7ED9\u5143\u7D20\u7ED1\u5B9A\u4E8B\u4EF6\u5E76\u4E14\u63D0\u4F9B\u4E86\u4E8B\u4EF6\u4FEE\u9970\u7B26\uFF0C\u57FA\u672C\u6D41\u7A0B\u662F\u8FDB\u884C\u6A21\u677F\u7F16\u8BD1\u751F\u6210<code>AST</code>\uFF0C\u751F\u6210<code>render</code>\u51FD\u6570\u540E\u5E76\u6267\u884C\u5F97\u5230<code>VNode</code>\uFF0C<code>VNode</code>\u751F\u6210\u771F\u5B9E<code>DOM</code>\u8282\u70B9\u6216\u8005\u7EC4\u4EF6\u65F6\u5019\u4F7F\u7528<code>addEventListener</code>\u65B9\u6CD5\u8FDB\u884C\u4E8B\u4EF6\u7ED1\u5B9A\u3002</p><h2 id="\u63CF\u8FF0" tabindex="-1">\u63CF\u8FF0 <a class="header-anchor" href="#\u63CF\u8FF0" aria-hidden="true">#</a></h2><p><code>v-on</code>\u4E0E<code>@</code>\u7528\u4E8E\u7ED1\u5B9A\u4E8B\u4EF6\u76D1\u542C\u5668\uFF0C\u4E8B\u4EF6\u7C7B\u578B\u7531\u53C2\u6570\u6307\u5B9A\uFF0C\u8868\u8FBE\u5F0F\u53EF\u4EE5\u662F\u4E00\u4E2A\u65B9\u6CD5\u7684\u540D\u5B57\u6216\u4E00\u4E2A\u5185\u8054\u8BED\u53E5\uFF0C\u5982\u679C\u6CA1\u6709\u4FEE\u9970\u7B26\u4E5F\u53EF\u4EE5\u7701\u7565\uFF0C\u7528\u5728\u666E\u901A\u5143\u7D20\u4E0A\u65F6\uFF0C\u53EA\u80FD\u76D1\u542C\u539F\u751F<code>DOM</code>\u4E8B\u4EF6\uFF0C\u7528\u5728\u81EA\u5B9A\u4E49\u5143\u7D20\u7EC4\u4EF6\u4E0A\u65F6\uFF0C\u4E5F\u53EF\u4EE5\u76D1\u542C\u5B50\u7EC4\u4EF6\u89E6\u53D1\u7684\u81EA\u5B9A\u4E49\u4E8B\u4EF6\uFF0C\u5728\u76D1\u542C\u539F\u751F<code>DOM</code>\u4E8B\u4EF6\u65F6\uFF0C\u65B9\u6CD5\u4EE5\u4E8B\u4EF6\u4E3A\u552F\u4E00\u7684\u53C2\u6570\uFF0C\u5982\u679C\u4F7F\u7528\u5185\u8054\u8BED\u53E5\uFF0C\u8BED\u53E5\u53EF\u4EE5\u8BBF\u95EE\u4E00\u4E2A<code>$event property\uFF1Av-on:click=&quot;handle(&#39;param&#39;, $event)&quot;</code>\uFF0C\u81EA<code>2.4.0</code>\u5F00\u59CB<code>v-on</code>\u540C\u6837\u652F\u6301\u4E0D\u5E26\u53C2\u6570\u7ED1\u5B9A\u4E00\u4E2A\u4E8B\u4EF6\u6216\u76D1\u542C\u5668\u952E\u503C\u5BF9\u7684\u5BF9\u8C61\uFF0C\u6CE8\u610F\u5F53\u4F7F\u7528\u5BF9\u8C61\u8BED\u6CD5\u65F6\uFF0C\u662F\u4E0D\u652F\u6301\u4EFB\u4F55\u4FEE\u9970\u5668\u7684\u3002</p><h3 id="\u4FEE\u9970\u7B26" tabindex="-1">\u4FEE\u9970\u7B26 <a class="header-anchor" href="#\u4FEE\u9970\u7B26" aria-hidden="true">#</a></h3><ul><li><code>.stop</code>: \u8C03\u7528<code>event.stopPropagation()</code>\uFF0C\u5373\u963B\u6B62\u4E8B\u4EF6\u5192\u6CE1\u3002</li><li><code>.prevent</code>: \u8C03\u7528<code>event.preventDefault()</code>\uFF0C\u5373\u963B\u6B62\u9ED8\u8BA4\u4E8B\u4EF6\u3002</li><li><code>.capture</code>: \u6DFB\u52A0\u4E8B\u4EF6\u4FA6\u542C\u5668\u65F6\u4F7F\u7528<code>capture</code>\u6A21\u5F0F\uFF0C\u5373\u4F7F\u7528\u4E8B\u4EF6\u6355\u83B7\u6A21\u5F0F\u5904\u7406\u4E8B\u4EF6\u3002</li><li><code>.self</code>: \u53EA\u5F53\u4E8B\u4EF6\u662F\u4ECE\u4FA6\u542C\u5668\u7ED1\u5B9A\u7684\u5143\u7D20\u672C\u8EAB\u89E6\u53D1\u65F6\u624D\u89E6\u53D1\u56DE\u8C03\u3002</li><li><code>.{keyCode | keyAlias}</code>: \u53EA\u5F53\u4E8B\u4EF6\u662F\u4ECE\u7279\u5B9A\u952E\u89E6\u53D1\u65F6\u624D\u89E6\u53D1\u56DE\u8C03\u3002</li><li><code>.native</code>: \u76D1\u542C\u7EC4\u4EF6\u6839\u5143\u7D20\u7684\u539F\u751F\u4E8B\u4EF6\uFF0C\u5373\u6CE8\u518C\u7EC4\u4EF6\u6839\u5143\u7D20\u7684\u539F\u751F\u4E8B\u4EF6\u800C\u4E0D\u662F\u7EC4\u4EF6\u81EA\u5B9A\u4E49\u4E8B\u4EF6\u7684\u3002</li><li><code>.once</code>: \u53EA\u89E6\u53D1\u4E00\u6B21\u56DE\u8C03\u3002</li><li><code>.left(2.2.0)</code>: \u53EA\u5F53\u70B9\u51FB\u9F20\u6807\u5DE6\u952E\u65F6\u89E6\u53D1\u3002</li><li><code>.right(2.2.0)</code>: \u53EA\u5F53\u70B9\u51FB\u9F20\u6807\u53F3\u952E\u65F6\u89E6\u53D1\u3002</li><li><code>.middle(2.2.0)</code>: \u53EA\u5F53\u70B9\u51FB\u9F20\u6807\u4E2D\u952E\u65F6\u89E6\u53D1\u3002</li><li><code>.passive(2.3.0)</code>: \u4EE5<code>{ passive: true }</code>\u6A21\u5F0F\u6DFB\u52A0\u4FA6\u542C\u5668\uFF0C\u8868\u793A<code>listener</code>\u6C38\u8FDC\u4E0D\u4F1A\u8C03\u7528<code>preventDefault()</code>\u3002</li></ul><h3 id="\u666E\u901A\u5143\u7D20" tabindex="-1">\u666E\u901A\u5143\u7D20 <a class="header-anchor" href="#\u666E\u901A\u5143\u7D20" aria-hidden="true">#</a></h3><div class="language-html line-numbers-mode"><button class="copy"></button><span class="lang">html</span><pre><code><span class="line"><span style="color:#8B949E;">&lt;!-- \u65B9\u6CD5\u5904\u7406\u5668 --&gt;</span></span>
<span class="line"><span style="color:#C9D1D9;">&lt;</span><span style="color:#7EE787;">button</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">v-on:click</span><span style="color:#C9D1D9;">=</span><span style="color:#A5D6FF;">&quot;doThis&quot;</span><span style="color:#C9D1D9;">&gt;&lt;/</span><span style="color:#7EE787;">button</span><span style="color:#C9D1D9;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8B949E;">&lt;!-- \u52A8\u6001\u4E8B\u4EF6 (2.6.0+) --&gt;</span></span>
<span class="line"><span style="color:#C9D1D9;">&lt;</span><span style="color:#7EE787;">button</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">v-on:[event]</span><span style="color:#C9D1D9;">=</span><span style="color:#A5D6FF;">&quot;doThis&quot;</span><span style="color:#C9D1D9;">&gt;&lt;/</span><span style="color:#7EE787;">button</span><span style="color:#C9D1D9;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8B949E;">&lt;!-- \u5185\u8054\u8BED\u53E5 --&gt;</span></span>
<span class="line"><span style="color:#C9D1D9;">&lt;</span><span style="color:#7EE787;">button</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">v-on:click</span><span style="color:#C9D1D9;">=</span><span style="color:#A5D6FF;">&quot;doThat(&#39;param&#39;, $event)&quot;</span><span style="color:#C9D1D9;">&gt;&lt;/</span><span style="color:#7EE787;">button</span><span style="color:#C9D1D9;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8B949E;">&lt;!-- \u7F29\u5199 --&gt;</span></span>
<span class="line"><span style="color:#C9D1D9;">&lt;</span><span style="color:#7EE787;">button</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">@click</span><span style="color:#C9D1D9;">=</span><span style="color:#A5D6FF;">&quot;doThis&quot;</span><span style="color:#C9D1D9;">&gt;&lt;/</span><span style="color:#7EE787;">button</span><span style="color:#C9D1D9;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8B949E;">&lt;!-- \u52A8\u6001\u4E8B\u4EF6\u7F29\u5199 (2.6.0+) --&gt;</span></span>
<span class="line"><span style="color:#C9D1D9;">&lt;</span><span style="color:#7EE787;">button</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">@[event]</span><span style="color:#C9D1D9;">=</span><span style="color:#A5D6FF;">&quot;doThis&quot;</span><span style="color:#C9D1D9;">&gt;&lt;/</span><span style="color:#7EE787;">button</span><span style="color:#C9D1D9;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8B949E;">&lt;!-- \u505C\u6B62\u5192\u6CE1 --&gt;</span></span>
<span class="line"><span style="color:#C9D1D9;">&lt;</span><span style="color:#7EE787;">button</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">@click.stop</span><span style="color:#C9D1D9;">=</span><span style="color:#A5D6FF;">&quot;doThis&quot;</span><span style="color:#C9D1D9;">&gt;&lt;/</span><span style="color:#7EE787;">button</span><span style="color:#C9D1D9;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8B949E;">&lt;!-- \u963B\u6B62\u9ED8\u8BA4\u884C\u4E3A --&gt;</span></span>
<span class="line"><span style="color:#C9D1D9;">&lt;</span><span style="color:#7EE787;">button</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">@click.prevent</span><span style="color:#C9D1D9;">=</span><span style="color:#A5D6FF;">&quot;doThis&quot;</span><span style="color:#C9D1D9;">&gt;&lt;/</span><span style="color:#7EE787;">button</span><span style="color:#C9D1D9;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8B949E;">&lt;!-- \u963B\u6B62\u9ED8\u8BA4\u884C\u4E3A\uFF0C\u6CA1\u6709\u8868\u8FBE\u5F0F --&gt;</span></span>
<span class="line"><span style="color:#C9D1D9;">&lt;</span><span style="color:#7EE787;">form</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">@submit.prevent</span><span style="color:#C9D1D9;">&gt;&lt;/</span><span style="color:#7EE787;">form</span><span style="color:#C9D1D9;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8B949E;">&lt;!--  \u4E32\u8054\u4FEE\u9970\u7B26 --&gt;</span></span>
<span class="line"><span style="color:#C9D1D9;">&lt;</span><span style="color:#7EE787;">button</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">@click.stop.prevent</span><span style="color:#C9D1D9;">=</span><span style="color:#A5D6FF;">&quot;doThis&quot;</span><span style="color:#C9D1D9;">&gt;&lt;/</span><span style="color:#7EE787;">button</span><span style="color:#C9D1D9;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8B949E;">&lt;!-- \u952E\u4FEE\u9970\u7B26\uFF0C\u952E\u522B\u540D --&gt;</span></span>
<span class="line"><span style="color:#C9D1D9;">&lt;</span><span style="color:#7EE787;">input</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">@keyup.enter</span><span style="color:#C9D1D9;">=</span><span style="color:#A5D6FF;">&quot;onEnter&quot;</span><span style="color:#C9D1D9;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8B949E;">&lt;!-- \u952E\u4FEE\u9970\u7B26\uFF0C\u952E\u4EE3\u7801 --&gt;</span></span>
<span class="line"><span style="color:#C9D1D9;">&lt;</span><span style="color:#7EE787;">input</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">@keyup.13</span><span style="color:#C9D1D9;">=</span><span style="color:#A5D6FF;">&quot;onEnter&quot;</span><span style="color:#C9D1D9;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8B949E;">&lt;!-- \u70B9\u51FB\u56DE\u8C03\u53EA\u4F1A\u89E6\u53D1\u4E00\u6B21 --&gt;</span></span>
<span class="line"><span style="color:#C9D1D9;">&lt;</span><span style="color:#7EE787;">button</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">v-on:click.once</span><span style="color:#C9D1D9;">=</span><span style="color:#A5D6FF;">&quot;doThis&quot;</span><span style="color:#C9D1D9;">&gt;&lt;/</span><span style="color:#7EE787;">button</span><span style="color:#C9D1D9;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8B949E;">&lt;!-- \u5BF9\u8C61\u8BED\u6CD5 (2.4.0+) --&gt;</span></span>
<span class="line"><span style="color:#C9D1D9;">&lt;</span><span style="color:#7EE787;">button</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">v-on</span><span style="color:#C9D1D9;">=</span><span style="color:#A5D6FF;">&quot;{ mousedown: doThis, mouseup: doThat }&quot;</span><span style="color:#C9D1D9;">&gt;&lt;/</span><span style="color:#7EE787;">button</span><span style="color:#C9D1D9;">&gt;</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br></div></div><h3 id="\u7EC4\u4EF6\u5143\u7D20" tabindex="-1">\u7EC4\u4EF6\u5143\u7D20 <a class="header-anchor" href="#\u7EC4\u4EF6\u5143\u7D20" aria-hidden="true">#</a></h3><div class="language-html line-numbers-mode"><button class="copy"></button><span class="lang">html</span><pre><code><span class="line"><span style="color:#8B949E;">&lt;!-- \u81EA\u5B9A\u4E49\u4E8B\u4EF6 --&gt;</span></span>
<span class="line"><span style="color:#C9D1D9;">&lt;</span><span style="color:#7EE787;">my-component</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">@my-event</span><span style="color:#C9D1D9;">=</span><span style="color:#A5D6FF;">&quot;handleThis&quot;</span><span style="color:#C9D1D9;">&gt;&lt;/</span><span style="color:#7EE787;">my-component</span><span style="color:#C9D1D9;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8B949E;">&lt;!-- \u5185\u8054\u8BED\u53E5 --&gt;</span></span>
<span class="line"><span style="color:#C9D1D9;">&lt;</span><span style="color:#7EE787;">my-component</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">@my-event</span><span style="color:#C9D1D9;">=</span><span style="color:#A5D6FF;">&quot;handleThis(&#39;param&#39;, $event)&quot;</span><span style="color:#C9D1D9;">&gt;&lt;/</span><span style="color:#7EE787;">my-component</span><span style="color:#C9D1D9;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8B949E;">&lt;!-- \u7EC4\u4EF6\u4E2D\u7684\u539F\u751F\u4E8B\u4EF6 --&gt;</span></span>
<span class="line"><span style="color:#C9D1D9;">&lt;</span><span style="color:#7EE787;">my-component</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">@click.native</span><span style="color:#C9D1D9;">=</span><span style="color:#A5D6FF;">&quot;onClick&quot;</span><span style="color:#C9D1D9;">&gt;&lt;/</span><span style="color:#7EE787;">my-component</span><span style="color:#C9D1D9;">&gt;</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h2 id="\u5206\u6790" tabindex="-1">\u5206\u6790 <a class="header-anchor" href="#\u5206\u6790" aria-hidden="true">#</a></h2><p><code>Vue</code>\u6E90\u7801\u7684\u5B9E\u73B0\u6BD4\u8F83\u590D\u6742\uFF0C\u4F1A\u5904\u7406\u5404\u79CD\u517C\u5BB9\u95EE\u9898\u4E0E\u5F02\u5E38\u4EE5\u53CA\u5404\u79CD\u6761\u4EF6\u5206\u652F\uFF0C\u6587\u7AE0\u5206\u6790\u6BD4\u8F83\u6838\u5FC3\u7684\u4EE3\u7801\u90E8\u5206\uFF0C\u7CBE\u7B80\u8FC7\u540E\u7684\u7248\u672C\uFF0C\u91CD\u8981\u90E8\u5206\u505A\u51FA\u6CE8\u91CA\uFF0C<code>commit id</code>\u4E3A<code>ef56410</code>\u3002</p><h3 id="\u7F16\u8BD1\u9636\u6BB5" tabindex="-1">\u7F16\u8BD1\u9636\u6BB5 <a class="header-anchor" href="#\u7F16\u8BD1\u9636\u6BB5" aria-hidden="true">#</a></h3><p><code>Vue</code>\u5728\u6302\u8F7D\u5B9E\u4F8B\u524D\uFF0C\u6709\u76F8\u5F53\u591A\u7684\u5DE5\u4F5C\u662F\u8FDB\u884C\u6A21\u677F\u7684\u7F16\u8BD1\uFF0C\u5C06<code>template</code>\u6A21\u677F\u8FDB\u884C\u7F16\u8BD1\uFF0C\u89E3\u6790\u6210<code>AST</code>\u6811\uFF0C\u518D\u8F6C\u6362\u6210<code>render</code>\u51FD\u6570\uFF0C\u800C\u5728\u7F16\u8BD1\u9636\u6BB5\uFF0C\u5C31\u662F\u5BF9\u4E8B\u4EF6\u7684\u6307\u4EE4\u505A\u6536\u96C6\u5904\u7406\u3002<br> \u5728<code>template</code>\u6A21\u677F\u4E2D\uFF0C\u5B9A\u4E49\u4E8B\u4EF6\u7684\u90E8\u5206\u662F\u5C5E\u4E8E<code>XML</code>\u7684<code>Attribute</code>\uFF0C\u6240\u4EE5\u6536\u96C6\u6307\u4EE4\u65F6\u9700\u8981\u5339\u914D<code>Attributes</code>\u4EE5\u786E\u5B9A\u54EA\u4E2A<code>Attribute</code>\u662F\u5C5E\u4E8E\u4E8B\u4EF6\u3002</p><div class="language-javascript line-numbers-mode"><button class="copy"></button><span class="lang">javascript</span><pre><code><span class="line"><span style="color:#8B949E;">// dev/src/compiler/parser/index.js line 23</span></span>
<span class="line"><span style="color:#FF7B72;">export</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">onRE</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#A5D6FF;"> /</span><span style="color:#FF7B72;">^</span><span style="color:#A5D6FF;">@</span><span style="color:#FF7B72;">|^</span><span style="color:#A5D6FF;">v-on:/</span></span>
<span class="line"><span style="color:#FF7B72;">export</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">dirRE</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> p<wbr>rocess.env.</span><span style="color:#79C0FF;">VBIND_PROP_SHORTHAND</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">?</span><span style="color:#A5D6FF;"> /</span><span style="color:#FF7B72;">^</span><span style="color:#A5D6FF;">v-</span><span style="color:#FF7B72;">|^</span><span style="color:#A5D6FF;">@</span><span style="color:#FF7B72;">|^</span><span style="color:#A5D6FF;">:</span><span style="color:#FF7B72;">|^</span><span style="color:#7EE787;font-style:italic;">\\.</span><span style="color:#FF7B72;">|^</span><span style="color:#A5D6FF;">#/</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">:</span><span style="color:#A5D6FF;"> /</span><span style="color:#FF7B72;">^</span><span style="color:#A5D6FF;">v-</span><span style="color:#FF7B72;">|^</span><span style="color:#A5D6FF;">@</span><span style="color:#FF7B72;">|^</span><span style="color:#A5D6FF;">:</span><span style="color:#FF7B72;">|^</span><span style="color:#A5D6FF;">#/</span></span>
<span class="line"><span style="color:#8B949E;">// ...</span></span>
<span class="line"><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">dynamicArgRE</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#A5D6FF;"> /</span><span style="color:#FF7B72;">^</span><span style="color:#7EE787;font-style:italic;">\\[</span><span style="color:#79C0FF;">.</span><span style="color:#FF7B72;">*</span><span style="color:#7EE787;font-style:italic;">\\]</span><span style="color:#FF7B72;">$</span><span style="color:#A5D6FF;">/</span></span>
<span class="line"><span style="color:#8B949E;">// ...</span></span>
<span class="line"><span style="color:#FF7B72;">export</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">bindRE</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#A5D6FF;"> /</span><span style="color:#FF7B72;">^</span><span style="color:#A5D6FF;">:</span><span style="color:#FF7B72;">|^</span><span style="color:#7EE787;font-style:italic;">\\.</span><span style="color:#FF7B72;">|^</span><span style="color:#A5D6FF;">v-bind:/</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span></span>
<span class="line"><span style="color:#8B949E;">// dev/src/compiler/parser/index.js line 757</span></span>
<span class="line"><span style="color:#FF7B72;">function</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">processAttrs</span><span style="color:#C9D1D9;"> (</span><span style="color:#FFA657;">el</span><span style="color:#C9D1D9;">) {</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">list</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> el.attrsList</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">let</span><span style="color:#C9D1D9;"> i, l, name, rawName, value, modifiers, syncGen, isDynamic</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">for</span><span style="color:#C9D1D9;"> (i </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">0</span><span style="color:#C9D1D9;">, l </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> list.</span><span style="color:#79C0FF;">length</span><span style="color:#C9D1D9;">; i </span><span style="color:#FF7B72;">&lt;</span><span style="color:#C9D1D9;"> l; i</span><span style="color:#FF7B72;">++</span><span style="color:#C9D1D9;">) {</span></span>
<span class="line"><span style="color:#C9D1D9;">    name </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> rawName </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> list[i].name</span></span>
<span class="line"><span style="color:#C9D1D9;">    value </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> list[i].value</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (dirRE.</span><span style="color:#D2A8FF;">test</span><span style="color:#C9D1D9;">(name)) { </span><span style="color:#8B949E;">// \u5339\u914D\u6307\u4EE4\u5C5E\u6027</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#8B949E;">// mark element as dynamic</span></span>
<span class="line"><span style="color:#C9D1D9;">      el.hasBindings </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">true</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#8B949E;">// modifiers</span></span>
<span class="line"><span style="color:#C9D1D9;">      modifiers </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">parseModifiers</span><span style="color:#C9D1D9;">(name.</span><span style="color:#D2A8FF;">replace</span><span style="color:#C9D1D9;">(dirRE, </span><span style="color:#A5D6FF;">&#39;&#39;</span><span style="color:#C9D1D9;">)) </span><span style="color:#8B949E;">// \u5C06\u4FEE\u9970\u7B26\u89E3\u6790</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#8B949E;">// support .foo shorthand syntax for the .prop modifier</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (p<wbr>rocess.env.</span><span style="color:#79C0FF;">VBIND_PROP_SHORTHAND</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">&amp;&amp;</span><span style="color:#C9D1D9;"> propBindRE.</span><span style="color:#D2A8FF;">test</span><span style="color:#C9D1D9;">(name)) {</span></span>
<span class="line"><span style="color:#C9D1D9;">        (modifiers </span><span style="color:#FF7B72;">||</span><span style="color:#C9D1D9;"> (modifiers </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> {})).prop </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">true</span></span>
<span class="line"><span style="color:#C9D1D9;">        name </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> </span><span style="color:#A5D6FF;">\`.\`</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">+</span><span style="color:#C9D1D9;"> name.</span><span style="color:#D2A8FF;">slice</span><span style="color:#C9D1D9;">(</span><span style="color:#79C0FF;">1</span><span style="color:#C9D1D9;">).</span><span style="color:#D2A8FF;">replace</span><span style="color:#C9D1D9;">(modifierRE, </span><span style="color:#A5D6FF;">&#39;&#39;</span><span style="color:#C9D1D9;">)</span></span>
<span class="line"><span style="color:#C9D1D9;">      } </span><span style="color:#FF7B72;">else</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (modifiers) {</span></span>
<span class="line"><span style="color:#C9D1D9;">        name </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> name.</span><span style="color:#D2A8FF;">replace</span><span style="color:#C9D1D9;">(modifierRE, </span><span style="color:#A5D6FF;">&#39;&#39;</span><span style="color:#C9D1D9;">)</span></span>
<span class="line"><span style="color:#C9D1D9;">      }</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (bindRE.</span><span style="color:#D2A8FF;">test</span><span style="color:#C9D1D9;">(name)) { </span><span style="color:#8B949E;">// v-bind // \u5904\u7406v-bind\u7684\u60C5\u51B5</span></span>
<span class="line"><span style="color:#C9D1D9;">        </span><span style="color:#8B949E;">// ...</span></span>
<span class="line"><span style="color:#C9D1D9;">      } </span><span style="color:#FF7B72;">else</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (onRE.</span><span style="color:#D2A8FF;">test</span><span style="color:#C9D1D9;">(name)) { </span><span style="color:#8B949E;">// v-on // \u5904\u7406\u4E8B\u4EF6\u7ED1\u5B9A</span></span>
<span class="line"><span style="color:#C9D1D9;">        name </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> name.</span><span style="color:#D2A8FF;">replace</span><span style="color:#C9D1D9;">(onRE, </span><span style="color:#A5D6FF;">&#39;&#39;</span><span style="color:#C9D1D9;">) </span><span style="color:#8B949E;">// \u5C06\u4E8B\u4EF6\u540D\u5339\u914D</span></span>
<span class="line"><span style="color:#C9D1D9;">        isDynamic </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> dynamicArgRE.</span><span style="color:#D2A8FF;">test</span><span style="color:#C9D1D9;">(name) </span><span style="color:#8B949E;">// \u52A8\u6001\u4E8B\u4EF6\u7ED1\u5B9A</span></span>
<span class="line"><span style="color:#C9D1D9;">        </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (isDynamic) { </span><span style="color:#8B949E;">// \u5982\u679C\u662F\u52A8\u6001\u4E8B\u4EF6</span></span>
<span class="line"><span style="color:#C9D1D9;">          name </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> name.</span><span style="color:#D2A8FF;">slice</span><span style="color:#C9D1D9;">(</span><span style="color:#79C0FF;">1</span><span style="color:#C9D1D9;">, </span><span style="color:#FF7B72;">-</span><span style="color:#79C0FF;">1</span><span style="color:#C9D1D9;">) </span><span style="color:#8B949E;">// \u53BB\u6389\u4E24\u7AEF\u7684 []</span></span>
<span class="line"><span style="color:#C9D1D9;">        }</span></span>
<span class="line"><span style="color:#C9D1D9;">        </span><span style="color:#D2A8FF;">addHandler</span><span style="color:#C9D1D9;">(el, name, value, modifiers, </span><span style="color:#79C0FF;">false</span><span style="color:#C9D1D9;">, warn, list[i], isDynamic) </span><span style="color:#8B949E;">// \u5904\u7406\u4E8B\u4EF6\u6536\u96C6</span></span>
<span class="line"><span style="color:#C9D1D9;">      } </span><span style="color:#FF7B72;">else</span><span style="color:#C9D1D9;"> { </span><span style="color:#8B949E;">// normal directives // \u5904\u7406\u5176\u4ED6\u6307\u4EE4</span></span>
<span class="line"><span style="color:#C9D1D9;">        </span><span style="color:#8B949E;">// ...</span></span>
<span class="line"><span style="color:#C9D1D9;">      }</span></span>
<span class="line"><span style="color:#C9D1D9;">    } </span><span style="color:#FF7B72;">else</span><span style="color:#C9D1D9;"> {</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#8B949E;">// literal attribute // \u5904\u7406\u6587\u5B57\u5C5E\u6027</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#8B949E;">// ...</span></span>
<span class="line"><span style="color:#C9D1D9;">    }</span></span>
<span class="line"><span style="color:#C9D1D9;">  }</span></span>
<span class="line"><span style="color:#C9D1D9;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br></div></div><p>\u901A\u8FC7<code>addHandler</code>\u65B9\u6CD5\uFF0C\u4E3A<code>AST</code>\u6811\u6DFB\u52A0\u4E8B\u4EF6\u76F8\u5173\u7684\u5C5E\u6027\u4EE5\u53CA\u5BF9\u4E8B\u4EF6\u4FEE\u9970\u7B26\u8FDB\u884C\u5904\u7406\u3002</p><div class="language-javascript line-numbers-mode"><button class="copy"></button><span class="lang">javascript</span><pre><code><span class="line"><span style="color:#8B949E;">// dev/src/compiler/helpers.js line 69</span></span>
<span class="line"><span style="color:#FF7B72;">export</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">function</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">addHandler</span><span style="color:#C9D1D9;"> (</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FFA657;">el</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#FFA657;">ASTElement</span><span style="color:#C9D1D9;">,</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FFA657;">name</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">string</span><span style="color:#C9D1D9;">,</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FFA657;">value</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">string</span><span style="color:#C9D1D9;">,</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FFA657;">modifiers</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">?</span><span style="color:#FFA657;">ASTModifiers</span><span style="color:#C9D1D9;">,</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FFA657;">important</span><span style="color:#FF7B72;">?:</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">boolean</span><span style="color:#C9D1D9;">,</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FFA657;">warn</span><span style="color:#FF7B72;">?:</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">?</span><span style="color:#FFA657;">Function</span><span style="color:#C9D1D9;">,</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FFA657;">range</span><span style="color:#FF7B72;">?:</span><span style="color:#C9D1D9;"> </span><span style="color:#FFA657;">Range</span><span style="color:#C9D1D9;">,</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FFA657;">dynamic</span><span style="color:#FF7B72;">?:</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">boolean</span></span>
<span class="line"><span style="color:#C9D1D9;">) {</span></span>
<span class="line"><span style="color:#C9D1D9;">  modifiers </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> modifiers </span><span style="color:#FF7B72;">||</span><span style="color:#C9D1D9;"> emptyObject</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#8B949E;">// passive \u548C prevent \u4E0D\u80FD\u540C\u65F6\u4F7F\u7528\uFF0C\u5177\u4F53\u662F\u7531passive\u6A21\u5F0F\u7684\u6027\u8D28\u51B3\u5B9A\u7684</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#8B949E;">// \u8BE6\u7EC6\u53EF\u4EE5\u53C2\u9605 https://developer.mozilla.org/zh-CN/docs/Web/API/EventTarget/addEventListener</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#8B949E;">// warn prevent and passive modifier</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#8B949E;">/* istanbul ignore if */</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (</span></span>
<span class="line"><span style="color:#C9D1D9;">    p<wbr>rocess.env.</span><span style="color:#79C0FF;">NODE_ENV</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">!==</span><span style="color:#C9D1D9;"> </span><span style="color:#A5D6FF;">&#39;production&#39;</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">&amp;&amp;</span><span style="color:#C9D1D9;"> warn </span><span style="color:#FF7B72;">&amp;&amp;</span></span>
<span class="line"><span style="color:#C9D1D9;">    modifiers.prevent </span><span style="color:#FF7B72;">&amp;&amp;</span><span style="color:#C9D1D9;"> modifiers.passive</span></span>
<span class="line"><span style="color:#C9D1D9;">  ) {</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#D2A8FF;">warn</span><span style="color:#C9D1D9;">(</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#A5D6FF;">&#39;passive and prevent can</span><span style="color:#79C0FF;">\\&#39;</span><span style="color:#A5D6FF;">t be used together. &#39;</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">+</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#A5D6FF;">&#39;Passive handler can</span><span style="color:#79C0FF;">\\&#39;</span><span style="color:#A5D6FF;">t prevent default event.&#39;</span><span style="color:#C9D1D9;">,</span></span>
<span class="line"><span style="color:#C9D1D9;">      range</span></span>
<span class="line"><span style="color:#C9D1D9;">    )</span></span>
<span class="line"><span style="color:#C9D1D9;">  }</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#8B949E;">// \u6807\u51C6\u5316click.right\u548Cclick.middle\uFF0C\u56E0\u4E3A\u5B83\u4EEC\u5B9E\u9645\u4E0A\u4E0D\u4F1A\u89E6\u53D1\u3002</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#8B949E;">// \u4ECE\u6280\u672F\u4E0A\u8BB2\uFF0C\u8FD9\u662F\u7279\u5B9A\u4E8E\u6D4F\u89C8\u5668\u7684\uFF0C\u4F46\u662F\u81F3\u5C11\u76EE\u524D\u6765\u8BF4\uFF0C\u6D4F\u89C8\u5668\u662F\u552F\u4E00\u5177\u6709\u53F3\u952E/\u4E2D\u95F4\u70B9\u51FB\u7684\u76EE\u6807\u73AF\u5883\u3002</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#8B949E;">// normalize click.right and click.middle since they don&#39;t actually fire</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#8B949E;">// this is technically browser-specific, but at least for now browsers are</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#8B949E;">// the only target envs that have right/middle clicks.</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (modifiers.right) { </span><span style="color:#8B949E;">// \u5C06\u9F20\u6807\u53F3\u952E\u70B9\u51FB\u6807\u51C6\u5316 \u53F3\u952E\u70B9\u51FB\u9ED8\u8BA4\u7684\u662F contextmenu \u4E8B\u4EF6</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (dynamic) { </span><span style="color:#8B949E;">// \u5982\u679C\u662F\u52A8\u6001\u4E8B\u4EF6</span></span>
<span class="line"><span style="color:#C9D1D9;">      name </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> </span><span style="color:#A5D6FF;">\`(\${</span><span style="color:#C9D1D9;">name</span><span style="color:#A5D6FF;">})===&#39;click&#39;?&#39;contextmenu&#39;:(\${</span><span style="color:#C9D1D9;">name</span><span style="color:#A5D6FF;">})\`</span><span style="color:#C9D1D9;"> </span><span style="color:#8B949E;">// \u52A8\u6001\u786E\u5B9A\u4E8B\u4EF6\u540D</span></span>
<span class="line"><span style="color:#C9D1D9;">    } </span><span style="color:#FF7B72;">else</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (name </span><span style="color:#FF7B72;">===</span><span style="color:#C9D1D9;"> </span><span style="color:#A5D6FF;">&#39;click&#39;</span><span style="color:#C9D1D9;">) { </span><span style="color:#8B949E;">// \u5982\u679C\u4E0D\u662F\u52A8\u6001\u4E8B\u4EF6\u4E14\u662F\u9F20\u6807\u53F3\u51FB</span></span>
<span class="line"><span style="color:#C9D1D9;">      name </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> </span><span style="color:#A5D6FF;">&#39;contextmenu&#39;</span><span style="color:#C9D1D9;"> </span><span style="color:#8B949E;">// \u5219\u76F4\u63A5\u66FF\u6362\u4E3Acontextmenu\u4E8B\u4EF6</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#FF7B72;">delete</span><span style="color:#C9D1D9;"> modifiers.right </span><span style="color:#8B949E;">// \u5220\u9664modifiers\u7684right\u5C5E\u6027</span></span>
<span class="line"><span style="color:#C9D1D9;">    }</span></span>
<span class="line"><span style="color:#C9D1D9;">  } </span><span style="color:#FF7B72;">else</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (modifiers.middle) { </span><span style="color:#8B949E;">// \u540C\u6837\u6807\u51C6\u5316\u5904\u7406\u9F20\u6807\u4E2D\u952E\u70B9\u51FB\u7684\u4E8B\u4EF6</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (dynamic) { </span><span style="color:#8B949E;">// \u5982\u679C\u662F\u52A8\u6001\u4E8B\u4EF6</span></span>
<span class="line"><span style="color:#C9D1D9;">      name </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> </span><span style="color:#A5D6FF;">\`(\${</span><span style="color:#C9D1D9;">name</span><span style="color:#A5D6FF;">})===&#39;click&#39;?&#39;mouseup&#39;:(\${</span><span style="color:#C9D1D9;">name</span><span style="color:#A5D6FF;">})\`</span><span style="color:#C9D1D9;"> </span><span style="color:#8B949E;">// \u52A8\u6001\u786E\u5B9A\u4E8B\u4EF6\u540D</span></span>
<span class="line"><span style="color:#C9D1D9;">    } </span><span style="color:#FF7B72;">else</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (name </span><span style="color:#FF7B72;">===</span><span style="color:#C9D1D9;"> </span><span style="color:#A5D6FF;">&#39;click&#39;</span><span style="color:#C9D1D9;">) { </span><span style="color:#8B949E;">// \u5982\u679C\u4E0D\u662F\u52A8\u6001\u4E8B\u4EF6\u4E14\u662F\u9F20\u6807\u4E2D\u952E\u70B9\u51FB</span></span>
<span class="line"><span style="color:#C9D1D9;">      name </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> </span><span style="color:#A5D6FF;">&#39;mouseup&#39;</span><span style="color:#C9D1D9;"> </span><span style="color:#8B949E;">// \u5904\u7406\u4E3Amouseup\u4E8B\u4EF6</span></span>
<span class="line"><span style="color:#C9D1D9;">    }</span></span>
<span class="line"><span style="color:#C9D1D9;">  }</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#8B949E;">// \u4E0B\u9762\u662F\u5BF9\u6355\u83B7\u3001\u4E00\u6B21\u89E6\u53D1\u3001passive\u6A21\u5F0F\u7684modifiers\u5904\u7406\uFF0C\u4E3B\u8981\u662F\u4E3A\u4E8B\u4EF6\u6DFB\u52A0 !\u3001~\u3001&amp; \u6807\u8BB0</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#8B949E;">// \u8FD9\u4E00\u90E8\u5206\u6807\u8BB0\u53EF\u4EE5\u5728Vue\u5B98\u65B9\u6587\u6863\u4E2D\u67E5\u9605 </span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#8B949E;">// https://cn.vuejs.org/v2/guide/render-function.html#%E4%BA%8B%E4%BB%B6-amp-%E6%8C%89%E9%94%AE%E4%BF%AE%E9%A5%B0%E7%AC%A6</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#8B949E;">// check capture modifier</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (modifiers.capture) {</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">delete</span><span style="color:#C9D1D9;"> modifiers.capture</span></span>
<span class="line"><span style="color:#C9D1D9;">    name </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">prependModifierMarker</span><span style="color:#C9D1D9;">(</span><span style="color:#A5D6FF;">&#39;!&#39;</span><span style="color:#C9D1D9;">, name, dynamic)</span></span>
<span class="line"><span style="color:#C9D1D9;">  }</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (modifiers.once) {</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">delete</span><span style="color:#C9D1D9;"> modifiers.once</span></span>
<span class="line"><span style="color:#C9D1D9;">    name </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">prependModifierMarker</span><span style="color:#C9D1D9;">(</span><span style="color:#A5D6FF;">&#39;~&#39;</span><span style="color:#C9D1D9;">, name, dynamic)</span></span>
<span class="line"><span style="color:#C9D1D9;">  }</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#8B949E;">/* istanbul ignore if */</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (modifiers.passive) {</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">delete</span><span style="color:#C9D1D9;"> modifiers.passive</span></span>
<span class="line"><span style="color:#C9D1D9;">    name </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">prependModifierMarker</span><span style="color:#C9D1D9;">(</span><span style="color:#A5D6FF;">&#39;&amp;&#39;</span><span style="color:#C9D1D9;">, name, dynamic)</span></span>
<span class="line"><span style="color:#C9D1D9;">  }</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#8B949E;">// events \u7528\u6765\u8BB0\u5F55\u7ED1\u5B9A\u7684\u4E8B\u4EF6</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">let</span><span style="color:#C9D1D9;"> events</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (modifiers.native) { </span><span style="color:#8B949E;">// \u5982\u679C\u662F\u8981\u89E6\u53D1\u6839\u5143\u7D20\u539F\u751F\u4E8B\u4EF6\u5219\u76F4\u63A5\u53D6\u5F97nativeEvents</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">delete</span><span style="color:#C9D1D9;"> modifiers.native</span></span>
<span class="line"><span style="color:#C9D1D9;">    events </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> el.nativeEvents </span><span style="color:#FF7B72;">||</span><span style="color:#C9D1D9;"> (el.nativeEvents </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> {})</span></span>
<span class="line"><span style="color:#C9D1D9;">  } </span><span style="color:#FF7B72;">else</span><span style="color:#C9D1D9;"> { </span><span style="color:#8B949E;">// \u5426\u5219\u53D6\u5F97events</span></span>
<span class="line"><span style="color:#C9D1D9;">    events </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> el.events </span><span style="color:#FF7B72;">||</span><span style="color:#C9D1D9;"> (el.events </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> {})</span></span>
<span class="line"><span style="color:#C9D1D9;">  }</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#8B949E;">// \u5C06\u4E8B\u4EF6\u5904\u7406\u51FD\u6570\u4F5C\u4E3Ahandler</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">newHandler</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">any</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">rangeSetItem</span><span style="color:#C9D1D9;">({ value: value.</span><span style="color:#D2A8FF;">trim</span><span style="color:#C9D1D9;">(), dynamic }, range)</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (modifiers </span><span style="color:#FF7B72;">!==</span><span style="color:#C9D1D9;"> emptyObject) {</span></span>
<span class="line"><span style="color:#C9D1D9;">    newHandler.modifiers </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> modifiers</span></span>
<span class="line"><span style="color:#C9D1D9;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C9D1D9;"> </span><span style="color:#8B949E;">// \u7ED1\u5B9A\u7684\u4E8B\u4EF6\u53EF\u4EE5\u591A\u4E2A\uFF0C\u56DE\u8C03\u4E5F\u53EF\u4EE5\u591A\u4E2A\uFF0C\u6700\u7EC8\u4F1A\u5408\u5E76\u5230\u6570\u7EC4\u4E2D</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">handlers</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> events[name]</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#8B949E;">/* istanbul ignore if */</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (Array.</span><span style="color:#D2A8FF;">isArray</span><span style="color:#C9D1D9;">(handlers)) {</span></span>
<span class="line"><span style="color:#C9D1D9;">    important </span><span style="color:#FF7B72;">?</span><span style="color:#C9D1D9;"> handlers.</span><span style="color:#D2A8FF;">unshift</span><span style="color:#C9D1D9;">(newHandler) </span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> handlers.</span><span style="color:#D2A8FF;">push</span><span style="color:#C9D1D9;">(newHandler)</span></span>
<span class="line"><span style="color:#C9D1D9;">  } </span><span style="color:#FF7B72;">else</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (handlers) {</span></span>
<span class="line"><span style="color:#C9D1D9;">    events[name] </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> important </span><span style="color:#FF7B72;">?</span><span style="color:#C9D1D9;"> [newHandler, handlers] </span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> [handlers, newHandler]</span></span>
<span class="line"><span style="color:#C9D1D9;">  } </span><span style="color:#FF7B72;">else</span><span style="color:#C9D1D9;"> {</span></span>
<span class="line"><span style="color:#C9D1D9;">    events[name] </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> newHandler</span></span>
<span class="line"><span style="color:#C9D1D9;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C9D1D9;">  el.plain </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">false</span></span>
<span class="line"><span style="color:#C9D1D9;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br></div></div><h3 id="\u4EE3\u7801\u751F\u6210" tabindex="-1">\u4EE3\u7801\u751F\u6210 <a class="header-anchor" href="#\u4EE3\u7801\u751F\u6210" aria-hidden="true">#</a></h3><p>\u63A5\u4E0B\u6765\u9700\u8981\u5C06<code>AST</code>\u8BED\u6CD5\u6811\u8F6C<code>render</code>\u51FD\u6570\uFF0C\u5728\u8FD9\u4E2A\u8FC7\u7A0B\u4E2D\u4F1A\u52A0\u5165\u5BF9\u4E8B\u4EF6\u7684\u5904\u7406\uFF0C\u9996\u5148\u6A21\u5757\u5BFC\u51FA\u4E86<code>generate</code>\u51FD\u6570\uFF0C<code>generate</code>\u51FD\u6570\u5373\u4F1A\u8FD4\u56DE<code>render</code>\u5B57\u7B26\u4E32\uFF0C\u5728\u8FD9\u4E4B\u524D\u4F1A\u8C03\u7528<code>genElement</code>\u51FD\u6570\uFF0C\u800C\u5728\u4E0A\u8FF0<code>addHandler</code>\u65B9\u6CD5\u5904\u7406\u7684\u6700\u540E\u6267\u884C\u4E86<code>el.plain = false</code>\uFF0C\u8FD9\u6837\u5728<code>genElement</code>\u51FD\u6570\u4E2D\u4F1A\u8C03\u7528<code>genData</code>\u51FD\u6570\uFF0C\u800C\u5728<code>genData</code>\u51FD\u6570\u4E2D\u5373\u4F1A\u8C03\u7528<code>genHandlers</code>\u51FD\u6570\u3002</p><div class="language-javascript line-numbers-mode"><button class="copy"></button><span class="lang">javascript</span><pre><code><span class="line"><span style="color:#8B949E;">// dev/src/compiler/codegen/index.js line 42</span></span>
<span class="line"><span style="color:#FF7B72;">export</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">function</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">generate</span><span style="color:#C9D1D9;"> (</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FFA657;">ast</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#FFA657;">ASTElement</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">|</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">void</span><span style="color:#C9D1D9;">,</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FFA657;">options</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#FFA657;">CompilerOptions</span></span>
<span class="line"><span style="color:#C9D1D9;">)</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#FFA657;">CodegenResult</span><span style="color:#C9D1D9;"> {</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">state</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">new</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">CodegenState</span><span style="color:#C9D1D9;">(options)</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">code</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> ast </span><span style="color:#FF7B72;">?</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">genElement</span><span style="color:#C9D1D9;">(ast, state) </span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#A5D6FF;">&#39;_c(&quot;div&quot;)&#39;</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">return</span><span style="color:#C9D1D9;"> {</span></span>
<span class="line"><span style="color:#C9D1D9;">    render: </span><span style="color:#A5D6FF;">\`with(this){return \${</span><span style="color:#C9D1D9;">code</span><span style="color:#A5D6FF;">}}\`</span><span style="color:#C9D1D9;">, </span><span style="color:#8B949E;">// \u5373render\u5B57\u7B26\u4E32</span></span>
<span class="line"><span style="color:#C9D1D9;">    staticRenderFns: state.staticRenderFns</span></span>
<span class="line"><span style="color:#C9D1D9;">  }</span></span>
<span class="line"><span style="color:#C9D1D9;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8B949E;">// dev/src/compiler/codegen/index.js line 55</span></span>
<span class="line"><span style="color:#FF7B72;">export</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">function</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">genElement</span><span style="color:#C9D1D9;"> (</span><span style="color:#FFA657;">el</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#FFA657;">ASTElement</span><span style="color:#C9D1D9;">, </span><span style="color:#FFA657;">state</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#FFA657;">CodegenState</span><span style="color:#C9D1D9;">)</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">string</span><span style="color:#C9D1D9;"> {</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#8B949E;">// ...</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">let</span><span style="color:#C9D1D9;"> code</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (el.component) {</span></span>
<span class="line"><span style="color:#C9D1D9;">      code </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">genComponent</span><span style="color:#C9D1D9;">(el.component, el, state)</span></span>
<span class="line"><span style="color:#C9D1D9;">    } </span><span style="color:#FF7B72;">else</span><span style="color:#C9D1D9;"> {</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#FF7B72;">let</span><span style="color:#C9D1D9;"> data</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (</span><span style="color:#FF7B72;">!</span><span style="color:#C9D1D9;">el.plain </span><span style="color:#FF7B72;">||</span><span style="color:#C9D1D9;"> (el.pre </span><span style="color:#FF7B72;">&amp;&amp;</span><span style="color:#C9D1D9;"> state.</span><span style="color:#D2A8FF;">maybeComponent</span><span style="color:#C9D1D9;">(el))) {</span></span>
<span class="line"><span style="color:#C9D1D9;">        data </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">genData</span><span style="color:#C9D1D9;">(el, state)</span></span>
<span class="line"><span style="color:#C9D1D9;">      }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">children</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> el.inlineTemplate </span><span style="color:#FF7B72;">?</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">null</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">genChildren</span><span style="color:#C9D1D9;">(el, state, </span><span style="color:#79C0FF;">true</span><span style="color:#C9D1D9;">)</span></span>
<span class="line"><span style="color:#C9D1D9;">      code </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> </span><span style="color:#A5D6FF;">\`_c(&#39;\${</span><span style="color:#C9D1D9;">el</span><span style="color:#A5D6FF;">.</span><span style="color:#C9D1D9;">tag</span><span style="color:#A5D6FF;">}&#39;\${</span></span>
<span class="line"><span style="color:#A5D6FF;">        </span><span style="color:#C9D1D9;">data</span><span style="color:#A5D6FF;"> </span><span style="color:#FF7B72;">?</span><span style="color:#A5D6FF;"> </span><span style="color:#A5D6FF;">\`,\${</span><span style="color:#C9D1D9;">data</span><span style="color:#A5D6FF;">}\`</span><span style="color:#A5D6FF;"> </span><span style="color:#FF7B72;">:</span><span style="color:#A5D6FF;"> </span><span style="color:#A5D6FF;">&#39;&#39;</span><span style="color:#A5D6FF;"> </span><span style="color:#8B949E;">// data</span></span>
<span class="line"><span style="color:#A5D6FF;">      </span><span style="color:#A5D6FF;">}\${</span></span>
<span class="line"><span style="color:#A5D6FF;">        </span><span style="color:#C9D1D9;">children</span><span style="color:#A5D6FF;"> </span><span style="color:#FF7B72;">?</span><span style="color:#A5D6FF;"> </span><span style="color:#A5D6FF;">\`,\${</span><span style="color:#C9D1D9;">children</span><span style="color:#A5D6FF;">}\`</span><span style="color:#A5D6FF;"> </span><span style="color:#FF7B72;">:</span><span style="color:#A5D6FF;"> </span><span style="color:#A5D6FF;">&#39;&#39;</span><span style="color:#A5D6FF;"> </span><span style="color:#8B949E;">// children</span></span>
<span class="line"><span style="color:#A5D6FF;">      </span><span style="color:#A5D6FF;">})\`</span></span>
<span class="line"><span style="color:#C9D1D9;">    }</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#8B949E;">// ...</span></span>
<span class="line"><span style="color:#C9D1D9;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8B949E;">// dev/src/compiler/codegen/index.js line 219</span></span>
<span class="line"><span style="color:#FF7B72;">export</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">function</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">genData</span><span style="color:#C9D1D9;"> (</span><span style="color:#FFA657;">el</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#FFA657;">ASTElement</span><span style="color:#C9D1D9;">, </span><span style="color:#FFA657;">state</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#FFA657;">CodegenState</span><span style="color:#C9D1D9;">)</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">string</span><span style="color:#C9D1D9;"> {</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">let</span><span style="color:#C9D1D9;"> data </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> </span><span style="color:#A5D6FF;">&#39;{&#39;</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#8B949E;">// ...</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#8B949E;">// event handlers</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (el.events) {</span></span>
<span class="line"><span style="color:#C9D1D9;">    data </span><span style="color:#FF7B72;">+=</span><span style="color:#C9D1D9;"> </span><span style="color:#A5D6FF;">\`\${</span><span style="color:#D2A8FF;">genHandlers</span><span style="color:#A5D6FF;">(</span><span style="color:#C9D1D9;">el</span><span style="color:#A5D6FF;">.</span><span style="color:#C9D1D9;">events</span><span style="color:#A5D6FF;">, </span><span style="color:#79C0FF;">false</span><span style="color:#A5D6FF;">)</span><span style="color:#A5D6FF;">},\`</span></span>
<span class="line"><span style="color:#C9D1D9;">  }</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (el.nativeEvents) {</span></span>
<span class="line"><span style="color:#C9D1D9;">    data </span><span style="color:#FF7B72;">+=</span><span style="color:#C9D1D9;"> </span><span style="color:#A5D6FF;">\`\${</span><span style="color:#D2A8FF;">genHandlers</span><span style="color:#A5D6FF;">(</span><span style="color:#C9D1D9;">el</span><span style="color:#A5D6FF;">.</span><span style="color:#C9D1D9;">nativeEvents</span><span style="color:#A5D6FF;">, </span><span style="color:#79C0FF;">true</span><span style="color:#A5D6FF;">)</span><span style="color:#A5D6FF;">},\`</span></span>
<span class="line"><span style="color:#C9D1D9;">  }</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#8B949E;">// ...</span></span>
<span class="line"><span style="color:#C9D1D9;">  data </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> data.</span><span style="color:#D2A8FF;">replace</span><span style="color:#C9D1D9;">(</span><span style="color:#A5D6FF;">/,</span><span style="color:#FF7B72;">$</span><span style="color:#A5D6FF;">/</span><span style="color:#C9D1D9;">, </span><span style="color:#A5D6FF;">&#39;&#39;</span><span style="color:#C9D1D9;">) </span><span style="color:#FF7B72;">+</span><span style="color:#C9D1D9;"> </span><span style="color:#A5D6FF;">&#39;}&#39;</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#8B949E;">// ...</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">return</span><span style="color:#C9D1D9;"> data</span></span>
<span class="line"><span style="color:#C9D1D9;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8B949E;">// dev/src/compiler/to-function.js line 12 </span></span>
<span class="line"><span style="color:#FF7B72;">function</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">createFunction</span><span style="color:#C9D1D9;"> (</span><span style="color:#FFA657;">code</span><span style="color:#C9D1D9;">, </span><span style="color:#FFA657;">errors</span><span style="color:#C9D1D9;">) {</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">try</span><span style="color:#C9D1D9;"> {</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">return</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">new</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">Function</span><span style="color:#C9D1D9;">(code) </span><span style="color:#8B949E;">// \u5C06render\u5B57\u7B26\u4E32\u8F6C\u4E3Arender\u51FD\u6570</span></span>
<span class="line"><span style="color:#C9D1D9;">  } </span><span style="color:#FF7B72;">catch</span><span style="color:#C9D1D9;"> (err) {</span></span>
<span class="line"><span style="color:#C9D1D9;">    errors.</span><span style="color:#D2A8FF;">push</span><span style="color:#C9D1D9;">({ err, code })</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">return</span><span style="color:#C9D1D9;"> noop</span></span>
<span class="line"><span style="color:#C9D1D9;">  }</span></span>
<span class="line"><span style="color:#C9D1D9;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br></div></div><p>\u53EF\u4EE5\u770B\u5230\u65E0\u8BBA\u662F\u5904\u7406\u666E\u901A\u5143\u7D20\u4E8B\u4EF6\u8FD8\u662F\u7EC4\u4EF6\u6839\u5143\u7D20\u539F\u751F\u4E8B\u4EF6\u90FD\u4F1A\u8C03\u7528<code>genHandlers</code>\u51FD\u6570\uFF0C<code>genHandlers</code>\u51FD\u6570\u5373\u4F1A\u904D\u5386\u89E3\u6790\u597D\u7684<code>AST</code>\u6811\u4E2D\u4E8B\u4EF6\u5C5E\u6027\uFF0C\u62FF\u5230<code>event</code>\u5BF9\u8C61\u5C5E\u6027\uFF0C\u5E76\u6839\u636E\u5C5E\u6027\u4E0A\u7684\u4E8B\u4EF6\u5BF9\u8C61\u62FC\u63A5\u6210\u5B57\u7B26\u4E32\u3002</p><div class="language-javascript line-numbers-mode"><button class="copy"></button><span class="lang">javascript</span><pre><code><span class="line"><span style="color:#8B949E;">// dev/src/compiler/codegen/events.js line 3</span></span>
<span class="line"><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">fnExpRE</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> </span><span style="color:#A5D6FF;">/</span><span style="color:#FF7B72;">^</span><span style="color:#A5D6FF;">(</span><span style="color:#79C0FF;">[\\w$_]</span><span style="color:#FF7B72;">+|</span><span style="color:#7EE787;font-style:italic;">\\(</span><span style="color:#79C0FF;">[</span><span style="color:#FF7B72;">^</span><span style="color:#79C0FF;">)]</span><span style="color:#FF7B72;">*?</span><span style="color:#7EE787;font-style:italic;">\\)</span><span style="color:#A5D6FF;">)</span><span style="color:#79C0FF;">\\s</span><span style="color:#FF7B72;">*</span><span style="color:#A5D6FF;">=&gt;</span><span style="color:#FF7B72;">|^</span><span style="color:#A5D6FF;">function(?:</span><span style="color:#79C0FF;">\\s</span><span style="color:#FF7B72;">+</span><span style="color:#79C0FF;">[\\w$]</span><span style="color:#FF7B72;">+</span><span style="color:#A5D6FF;">)</span><span style="color:#FF7B72;">?</span><span style="color:#79C0FF;">\\s</span><span style="color:#FF7B72;">*</span><span style="color:#7EE787;font-style:italic;">\\(</span><span style="color:#A5D6FF;">/</span></span>
<span class="line"><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">fnInvokeRE</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#A5D6FF;"> /</span><span style="color:#7EE787;font-style:italic;">\\(</span><span style="color:#79C0FF;">[</span><span style="color:#FF7B72;">^</span><span style="color:#79C0FF;">)]</span><span style="color:#FF7B72;">*?</span><span style="color:#7EE787;font-style:italic;">\\)</span><span style="color:#A5D6FF;">;</span><span style="color:#FF7B72;">*$</span><span style="color:#A5D6FF;">/</span></span>
<span class="line"><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">simplePathRE</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#A5D6FF;"> /</span><span style="color:#FF7B72;">^</span><span style="color:#79C0FF;">[A-Za-z_$][\\w$]</span><span style="color:#FF7B72;">*</span><span style="color:#A5D6FF;">(?:</span><span style="color:#7EE787;font-style:italic;">\\.</span><span style="color:#79C0FF;">[A-Za-z_$][\\w$]</span><span style="color:#FF7B72;">*|</span><span style="color:#7EE787;font-style:italic;">\\[</span><span style="color:#A5D6FF;">&#39;</span><span style="color:#79C0FF;">[</span><span style="color:#FF7B72;">^</span><span style="color:#79C0FF;">&#39;]</span><span style="color:#FF7B72;">*?</span><span style="color:#A5D6FF;">&#39;]</span><span style="color:#FF7B72;">|</span><span style="color:#7EE787;font-style:italic;">\\[</span><span style="color:#A5D6FF;">&quot;</span><span style="color:#79C0FF;">[</span><span style="color:#FF7B72;">^</span><span style="color:#79C0FF;">&quot;]</span><span style="color:#FF7B72;">*?</span><span style="color:#A5D6FF;">&quot;]</span><span style="color:#FF7B72;">|</span><span style="color:#7EE787;font-style:italic;">\\[</span><span style="color:#79C0FF;">\\d</span><span style="color:#FF7B72;">+</span><span style="color:#A5D6FF;">]</span><span style="color:#FF7B72;">|</span><span style="color:#7EE787;font-style:italic;">\\[</span><span style="color:#79C0FF;">[A-Za-z_$][\\w$]</span><span style="color:#FF7B72;">*</span><span style="color:#A5D6FF;">])</span><span style="color:#FF7B72;">*$</span><span style="color:#A5D6FF;">/</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8B949E;">// dev/src/compiler/codegen/events.js line 7</span></span>
<span class="line"><span style="color:#8B949E;">// KeyboardEvent.keyCode aliases</span></span>
<span class="line"><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">keyCodes</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> { [</span><span style="color:#FFA657;">key</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">string</span><span style="color:#C9D1D9;">]</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">number</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">|</span><span style="color:#C9D1D9;"> </span><span style="color:#FFA657;">Array</span><span style="color:#C9D1D9;">&lt;</span><span style="color:#79C0FF;">number</span><span style="color:#C9D1D9;">&gt; } </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> {</span></span>
<span class="line"><span style="color:#C9D1D9;">  esc: </span><span style="color:#79C0FF;">27</span><span style="color:#C9D1D9;">,</span></span>
<span class="line"><span style="color:#C9D1D9;">  tab: </span><span style="color:#79C0FF;">9</span><span style="color:#C9D1D9;">,</span></span>
<span class="line"><span style="color:#C9D1D9;">  enter: </span><span style="color:#79C0FF;">13</span><span style="color:#C9D1D9;">,</span></span>
<span class="line"><span style="color:#C9D1D9;">  space: </span><span style="color:#79C0FF;">32</span><span style="color:#C9D1D9;">,</span></span>
<span class="line"><span style="color:#C9D1D9;">  up: </span><span style="color:#79C0FF;">38</span><span style="color:#C9D1D9;">,</span></span>
<span class="line"><span style="color:#C9D1D9;">  left: </span><span style="color:#79C0FF;">37</span><span style="color:#C9D1D9;">,</span></span>
<span class="line"><span style="color:#C9D1D9;">  right: </span><span style="color:#79C0FF;">39</span><span style="color:#C9D1D9;">,</span></span>
<span class="line"><span style="color:#C9D1D9;">  down: </span><span style="color:#79C0FF;">40</span><span style="color:#C9D1D9;">,</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#A5D6FF;">&#39;delete&#39;</span><span style="color:#C9D1D9;">: [</span><span style="color:#79C0FF;">8</span><span style="color:#C9D1D9;">, </span><span style="color:#79C0FF;">46</span><span style="color:#C9D1D9;">]</span></span>
<span class="line"><span style="color:#C9D1D9;">}</span></span>
<span class="line"><span style="color:#8B949E;">// KeyboardEvent.key aliases</span></span>
<span class="line"><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">keyNames</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> { [</span><span style="color:#FFA657;">key</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">string</span><span style="color:#C9D1D9;">]</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">string</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">|</span><span style="color:#C9D1D9;"> </span><span style="color:#FFA657;">Array</span><span style="color:#C9D1D9;">&lt;</span><span style="color:#79C0FF;">string</span><span style="color:#C9D1D9;">&gt; } </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> {</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#8B949E;">// #7880: IE11 and Edge use \`Esc\` for Escape key name.</span></span>
<span class="line"><span style="color:#C9D1D9;">  esc: [</span><span style="color:#A5D6FF;">&#39;Esc&#39;</span><span style="color:#C9D1D9;">, </span><span style="color:#A5D6FF;">&#39;Escape&#39;</span><span style="color:#C9D1D9;">],</span></span>
<span class="line"><span style="color:#C9D1D9;">  tab: </span><span style="color:#A5D6FF;">&#39;Tab&#39;</span><span style="color:#C9D1D9;">,</span></span>
<span class="line"><span style="color:#C9D1D9;">  enter: </span><span style="color:#A5D6FF;">&#39;Enter&#39;</span><span style="color:#C9D1D9;">,</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#8B949E;">// #9112: IE11 uses \`Spacebar\` for Space key name.</span></span>
<span class="line"><span style="color:#C9D1D9;">  space: [</span><span style="color:#A5D6FF;">&#39; &#39;</span><span style="color:#C9D1D9;">, </span><span style="color:#A5D6FF;">&#39;Spacebar&#39;</span><span style="color:#C9D1D9;">],</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#8B949E;">// #7806: IE11 uses key names without \`Arrow\` prefix for arrow keys.</span></span>
<span class="line"><span style="color:#C9D1D9;">  up: [</span><span style="color:#A5D6FF;">&#39;Up&#39;</span><span style="color:#C9D1D9;">, </span><span style="color:#A5D6FF;">&#39;ArrowUp&#39;</span><span style="color:#C9D1D9;">],</span></span>
<span class="line"><span style="color:#C9D1D9;">  left: [</span><span style="color:#A5D6FF;">&#39;Left&#39;</span><span style="color:#C9D1D9;">, </span><span style="color:#A5D6FF;">&#39;ArrowLeft&#39;</span><span style="color:#C9D1D9;">],</span></span>
<span class="line"><span style="color:#C9D1D9;">  right: [</span><span style="color:#A5D6FF;">&#39;Right&#39;</span><span style="color:#C9D1D9;">, </span><span style="color:#A5D6FF;">&#39;ArrowRight&#39;</span><span style="color:#C9D1D9;">],</span></span>
<span class="line"><span style="color:#C9D1D9;">  down: [</span><span style="color:#A5D6FF;">&#39;Down&#39;</span><span style="color:#C9D1D9;">, </span><span style="color:#A5D6FF;">&#39;ArrowDown&#39;</span><span style="color:#C9D1D9;">],</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#8B949E;">// #9112: IE11 uses \`Del\` for Delete key name.</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#A5D6FF;">&#39;delete&#39;</span><span style="color:#C9D1D9;">: [</span><span style="color:#A5D6FF;">&#39;Backspace&#39;</span><span style="color:#C9D1D9;">, </span><span style="color:#A5D6FF;">&#39;Delete&#39;</span><span style="color:#C9D1D9;">, </span><span style="color:#A5D6FF;">&#39;Del&#39;</span><span style="color:#C9D1D9;">]</span></span>
<span class="line"><span style="color:#C9D1D9;">}</span></span>
<span class="line"><span style="color:#C9D1D9;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8B949E;">// dev/src/compiler/codegen/events.js line 37</span></span>
<span class="line"><span style="color:#8B949E;">// #4868: modifiers that prevent the execution of the listener</span></span>
<span class="line"><span style="color:#8B949E;">// need to explicitly return null so that we can determine whether to remove</span></span>
<span class="line"><span style="color:#8B949E;">// the listener for .once</span></span>
<span class="line"><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">genGuard</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> </span><span style="color:#FFA657;">condition</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=&gt;</span><span style="color:#C9D1D9;"> </span><span style="color:#A5D6FF;">\`if(\${</span><span style="color:#C9D1D9;">condition</span><span style="color:#A5D6FF;">})return null;\`</span></span>
<span class="line"><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">modifierCode</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> { [</span><span style="color:#FFA657;">key</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">string</span><span style="color:#C9D1D9;">]</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">string</span><span style="color:#C9D1D9;"> } </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> {</span></span>
<span class="line"><span style="color:#C9D1D9;">  stop: </span><span style="color:#A5D6FF;">&#39;$event.stopPropagation();&#39;</span><span style="color:#C9D1D9;">,</span></span>
<span class="line"><span style="color:#C9D1D9;">  prevent: </span><span style="color:#A5D6FF;">&#39;$event.preventDefault();&#39;</span><span style="color:#C9D1D9;">,</span></span>
<span class="line"><span style="color:#C9D1D9;">  self: </span><span style="color:#D2A8FF;">genGuard</span><span style="color:#C9D1D9;">(</span><span style="color:#A5D6FF;">\`$event.target !== $event.currentTarget\`</span><span style="color:#C9D1D9;">),</span></span>
<span class="line"><span style="color:#C9D1D9;">  ctrl: </span><span style="color:#D2A8FF;">genGuard</span><span style="color:#C9D1D9;">(</span><span style="color:#A5D6FF;">\`!$event.ctrlKey\`</span><span style="color:#C9D1D9;">),</span></span>
<span class="line"><span style="color:#C9D1D9;">  shift: </span><span style="color:#D2A8FF;">genGuard</span><span style="color:#C9D1D9;">(</span><span style="color:#A5D6FF;">\`!$event.shiftKey\`</span><span style="color:#C9D1D9;">),</span></span>
<span class="line"><span style="color:#C9D1D9;">  alt: </span><span style="color:#D2A8FF;">genGuard</span><span style="color:#C9D1D9;">(</span><span style="color:#A5D6FF;">\`!$event.altKey\`</span><span style="color:#C9D1D9;">),</span></span>
<span class="line"><span style="color:#C9D1D9;">  meta: </span><span style="color:#D2A8FF;">genGuard</span><span style="color:#C9D1D9;">(</span><span style="color:#A5D6FF;">\`!$event.metaKey\`</span><span style="color:#C9D1D9;">),</span></span>
<span class="line"><span style="color:#C9D1D9;">  left: </span><span style="color:#D2A8FF;">genGuard</span><span style="color:#C9D1D9;">(</span><span style="color:#A5D6FF;">\`&#39;button&#39; in $event &amp;&amp; $event.button !== 0\`</span><span style="color:#C9D1D9;">),</span></span>
<span class="line"><span style="color:#C9D1D9;">  middle: </span><span style="color:#D2A8FF;">genGuard</span><span style="color:#C9D1D9;">(</span><span style="color:#A5D6FF;">\`&#39;button&#39; in $event &amp;&amp; $event.button !== 1\`</span><span style="color:#C9D1D9;">),</span></span>
<span class="line"><span style="color:#C9D1D9;">  right: </span><span style="color:#D2A8FF;">genGuard</span><span style="color:#C9D1D9;">(</span><span style="color:#A5D6FF;">\`&#39;button&#39; in $event &amp;&amp; $event.button !== 2\`</span><span style="color:#C9D1D9;">)</span></span>
<span class="line"><span style="color:#C9D1D9;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8B949E;">// dev/src/compiler/codegen/events.js line 55</span></span>
<span class="line"><span style="color:#FF7B72;">export</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">function</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">genHandlers</span><span style="color:#C9D1D9;"> (</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FFA657;">events</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#FFA657;">ASTElementHandlers</span><span style="color:#C9D1D9;">,</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FFA657;">isNative</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">boolean</span></span>
<span class="line"><span style="color:#C9D1D9;">)</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">string</span><span style="color:#C9D1D9;"> {</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">prefix</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> isNative </span><span style="color:#FF7B72;">?</span><span style="color:#C9D1D9;"> </span><span style="color:#A5D6FF;">&#39;nativeOn:&#39;</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#A5D6FF;">&#39;on:&#39;</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">let</span><span style="color:#C9D1D9;"> staticHandlers </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> </span><span style="color:#A5D6FF;">\`\`</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">let</span><span style="color:#C9D1D9;"> dynamicHandlers </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> </span><span style="color:#A5D6FF;">\`\`</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">for</span><span style="color:#C9D1D9;"> (</span><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">name</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">in</span><span style="color:#C9D1D9;"> events) { </span><span style="color:#8B949E;">// \u904D\u5386AST\u89E3\u6790\u540E\u7684\u4E8B\u4EF6\u5C5E\u6027</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">handlerCode</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">genHandler</span><span style="color:#C9D1D9;">(events[name]) </span><span style="color:#8B949E;">// \u5C06\u4E8B\u4EF6\u5BF9\u8C61\u8F6C\u6362\u6210\u53EF\u62FC\u63A5\u7684\u5B57\u7B26\u4E32</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (events[name] </span><span style="color:#FF7B72;">&amp;&amp;</span><span style="color:#C9D1D9;"> events[name].dynamic) {</span></span>
<span class="line"><span style="color:#C9D1D9;">      dynamicHandlers </span><span style="color:#FF7B72;">+=</span><span style="color:#C9D1D9;"> </span><span style="color:#A5D6FF;">\`\${</span><span style="color:#C9D1D9;">name</span><span style="color:#A5D6FF;">},\${</span><span style="color:#C9D1D9;">handlerCode</span><span style="color:#A5D6FF;">},\`</span></span>
<span class="line"><span style="color:#C9D1D9;">    } </span><span style="color:#FF7B72;">else</span><span style="color:#C9D1D9;"> {</span></span>
<span class="line"><span style="color:#C9D1D9;">      staticHandlers </span><span style="color:#FF7B72;">+=</span><span style="color:#C9D1D9;"> </span><span style="color:#A5D6FF;">\`&quot;\${</span><span style="color:#C9D1D9;">name</span><span style="color:#A5D6FF;">}&quot;:\${</span><span style="color:#C9D1D9;">handlerCode</span><span style="color:#A5D6FF;">},\`</span></span>
<span class="line"><span style="color:#C9D1D9;">    }</span></span>
<span class="line"><span style="color:#C9D1D9;">  }</span></span>
<span class="line"><span style="color:#C9D1D9;">  staticHandlers </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> </span><span style="color:#A5D6FF;">\`{\${</span><span style="color:#C9D1D9;">staticHandlers</span><span style="color:#A5D6FF;">.</span><span style="color:#D2A8FF;">slice</span><span style="color:#A5D6FF;">(</span><span style="color:#79C0FF;">0</span><span style="color:#A5D6FF;">, </span><span style="color:#FF7B72;">-</span><span style="color:#79C0FF;">1</span><span style="color:#A5D6FF;">)</span><span style="color:#A5D6FF;">}}\`</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (dynamicHandlers) {</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">return</span><span style="color:#C9D1D9;"> prefix </span><span style="color:#FF7B72;">+</span><span style="color:#C9D1D9;"> </span><span style="color:#A5D6FF;">\`_d(\${</span><span style="color:#C9D1D9;">staticHandlers</span><span style="color:#A5D6FF;">},[\${</span><span style="color:#C9D1D9;">dynamicHandlers</span><span style="color:#A5D6FF;">.</span><span style="color:#D2A8FF;">slice</span><span style="color:#A5D6FF;">(</span><span style="color:#79C0FF;">0</span><span style="color:#A5D6FF;">, </span><span style="color:#FF7B72;">-</span><span style="color:#79C0FF;">1</span><span style="color:#A5D6FF;">)</span><span style="color:#A5D6FF;">}])\`</span></span>
<span class="line"><span style="color:#C9D1D9;">  } </span><span style="color:#FF7B72;">else</span><span style="color:#C9D1D9;"> {</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">return</span><span style="color:#C9D1D9;"> prefix </span><span style="color:#FF7B72;">+</span><span style="color:#C9D1D9;"> staticHandlers</span></span>
<span class="line"><span style="color:#C9D1D9;">  }</span></span>
<span class="line"><span style="color:#C9D1D9;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8B949E;">// dev/src/compiler/codegen/events.js line 96</span></span>
<span class="line"><span style="color:#FF7B72;">function</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">genHandler</span><span style="color:#C9D1D9;"> (</span><span style="color:#FFA657;">handler</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#FFA657;">ASTElementHandler</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">|</span><span style="color:#C9D1D9;"> </span><span style="color:#FFA657;">Array</span><span style="color:#C9D1D9;">&lt;</span><span style="color:#FFA657;">ASTElementHandler</span><span style="color:#C9D1D9;">&gt;)</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">string</span><span style="color:#C9D1D9;"> {</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (</span><span style="color:#FF7B72;">!</span><span style="color:#C9D1D9;">handler) {</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">return</span><span style="color:#C9D1D9;"> </span><span style="color:#A5D6FF;">&#39;function(){}&#39;</span></span>
<span class="line"><span style="color:#C9D1D9;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#8B949E;">// \u4E8B\u4EF6\u7ED1\u5B9A\u53EF\u4EE5\u591A\u4E2A\uFF0C\u591A\u4E2A\u5728\u89E3\u6790AST\u6811\u65F6\u4F1A\u4EE5\u6570\u7EC4\u7684\u5F62\u5F0F\u5B58\u5728\uFF0C\u5982\u679C\u6709\u591A\u4E2A\u5219\u4F1A\u9012\u5F52\u8C03\u7528getHandler\u65B9\u6CD5\u8FD4\u56DE\u6570\u7EC4\u3002</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (Array.</span><span style="color:#D2A8FF;">isArray</span><span style="color:#C9D1D9;">(handler)) {</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">return</span><span style="color:#C9D1D9;"> </span><span style="color:#A5D6FF;">\`[\${</span><span style="color:#C9D1D9;">handler</span><span style="color:#A5D6FF;">.</span><span style="color:#D2A8FF;">map</span><span style="color:#A5D6FF;">(</span><span style="color:#79C0FF;">handler</span><span style="color:#A5D6FF;"> </span><span style="color:#FF7B72;">=&gt;</span><span style="color:#A5D6FF;"> </span><span style="color:#D2A8FF;">genHandler</span><span style="color:#A5D6FF;">(</span><span style="color:#C9D1D9;">handler</span><span style="color:#A5D6FF;">)).</span><span style="color:#D2A8FF;">join</span><span style="color:#A5D6FF;">(</span><span style="color:#A5D6FF;">&#39;,&#39;</span><span style="color:#A5D6FF;">)</span><span style="color:#A5D6FF;">}]\`</span></span>
<span class="line"><span style="color:#C9D1D9;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">isMethodPath</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> simplePathRE.</span><span style="color:#D2A8FF;">test</span><span style="color:#C9D1D9;">(handler.value) </span><span style="color:#8B949E;">// \u8C03\u7528\u65B9\u6CD5\u4E3A doThis \u578B</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">isFunctionExpression</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> fnExpRE.</span><span style="color:#D2A8FF;">test</span><span style="color:#C9D1D9;">(handler.value) </span><span style="color:#8B949E;">// \u8C03\u7528\u65B9\u6CD5\u4E3A () =&gt; {} or function() {} \u578B</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">isFunctionInvocation</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> simplePathRE.</span><span style="color:#D2A8FF;">test</span><span style="color:#C9D1D9;">(handler.value.</span><span style="color:#D2A8FF;">replace</span><span style="color:#C9D1D9;">(fnInvokeRE, </span><span style="color:#A5D6FF;">&#39;&#39;</span><span style="color:#C9D1D9;">)) </span><span style="color:#8B949E;">// \u8C03\u7528\u65B9\u6CD5\u4E3A doThis($event) \u578B</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (</span><span style="color:#FF7B72;">!</span><span style="color:#C9D1D9;">handler.modifiers) { </span><span style="color:#8B949E;">// \u6CA1\u6709\u4FEE\u9970\u7B26</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (isMethodPath </span><span style="color:#FF7B72;">||</span><span style="color:#C9D1D9;"> isFunctionExpression) { </span><span style="color:#8B949E;">// \u7B26\u5408\u8FD9\u4E24\u4E2A\u6761\u4EF6\u5219\u76F4\u63A5\u8FD4\u56DE</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#FF7B72;">return</span><span style="color:#C9D1D9;"> handler.value</span></span>
<span class="line"><span style="color:#C9D1D9;">    }</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#8B949E;">/* istanbul ignore if */</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (__WEEX__ </span><span style="color:#FF7B72;">&amp;&amp;</span><span style="color:#C9D1D9;"> handler.params) {</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#FF7B72;">return</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">genWeexHandler</span><span style="color:#C9D1D9;">(handler.params, handler.value)</span></span>
<span class="line"><span style="color:#C9D1D9;">    }</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">return</span><span style="color:#C9D1D9;"> </span><span style="color:#A5D6FF;">\`function($event){\${</span><span style="color:#A5D6FF;"> </span><span style="color:#8B949E;">// \u8FD4\u56DE\u62FC\u63A5\u7684\u533F\u540D\u51FD\u6570\u7684\u5B57\u7B26\u4E32</span></span>
<span class="line"><span style="color:#A5D6FF;">      </span><span style="color:#C9D1D9;">isFunctionInvocation</span><span style="color:#A5D6FF;"> </span><span style="color:#FF7B72;">?</span><span style="color:#A5D6FF;"> </span><span style="color:#A5D6FF;">\`return \${</span><span style="color:#C9D1D9;">handler</span><span style="color:#A5D6FF;">.</span><span style="color:#C9D1D9;">value</span><span style="color:#A5D6FF;">}\`</span><span style="color:#A5D6FF;"> </span><span style="color:#FF7B72;">:</span><span style="color:#A5D6FF;"> </span><span style="color:#C9D1D9;">handler</span><span style="color:#A5D6FF;">.</span><span style="color:#C9D1D9;">value</span></span>
<span class="line"><span style="color:#A5D6FF;">    </span><span style="color:#A5D6FF;">}}\`</span><span style="color:#C9D1D9;"> </span><span style="color:#8B949E;">// inline statement</span></span>
<span class="line"><span style="color:#C9D1D9;">  } </span><span style="color:#FF7B72;">else</span><span style="color:#C9D1D9;"> { </span><span style="color:#8B949E;">// \u5904\u7406\u5177\u6709\u4FEE\u9970\u7B26\u7684\u60C5\u51B5</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">let</span><span style="color:#C9D1D9;"> code </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> </span><span style="color:#A5D6FF;">&#39;&#39;</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">let</span><span style="color:#C9D1D9;"> genModifierCode </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> </span><span style="color:#A5D6FF;">&#39;&#39;</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">keys</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> []</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">for</span><span style="color:#C9D1D9;"> (</span><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">key</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">in</span><span style="color:#C9D1D9;"> handler.modifiers) {  </span><span style="color:#8B949E;">// \u904D\u5386modifiers\u4E0A\u8BB0\u5F55\u7684\u4FEE\u9970\u7B26</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (modifierCode[key]) {</span></span>
<span class="line"><span style="color:#C9D1D9;">        genModifierCode </span><span style="color:#FF7B72;">+=</span><span style="color:#C9D1D9;"> modifierCode[key]  </span><span style="color:#8B949E;">// \u6839\u636E\u4FEE\u9970\u7B26\u6DFB\u52A0\u5BF9\u5E94js\u7684\u4EE3\u7801</span></span>
<span class="line"><span style="color:#C9D1D9;">        </span><span style="color:#8B949E;">// left/right</span></span>
<span class="line"><span style="color:#C9D1D9;">        </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (keyCodes[key]) {</span></span>
<span class="line"><span style="color:#C9D1D9;">          keys.</span><span style="color:#D2A8FF;">push</span><span style="color:#C9D1D9;">(key)</span></span>
<span class="line"><span style="color:#C9D1D9;">        }</span></span>
<span class="line"><span style="color:#C9D1D9;">      } </span><span style="color:#FF7B72;">else</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (key </span><span style="color:#FF7B72;">===</span><span style="color:#C9D1D9;"> </span><span style="color:#A5D6FF;">&#39;exact&#39;</span><span style="color:#C9D1D9;">) { </span><span style="color:#8B949E;">// \u9488\u5BF9exact\u7684\u5904\u7406</span></span>
<span class="line"><span style="color:#C9D1D9;">        </span><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">modifiers</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#FFA657;">ASTModifiers</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> (handler.modifiers: any)</span></span>
<span class="line"><span style="color:#C9D1D9;">        genModifierCode </span><span style="color:#FF7B72;">+=</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">genGuard</span><span style="color:#C9D1D9;">(</span></span>
<span class="line"><span style="color:#C9D1D9;">          [</span><span style="color:#A5D6FF;">&#39;ctrl&#39;</span><span style="color:#C9D1D9;">, </span><span style="color:#A5D6FF;">&#39;shift&#39;</span><span style="color:#C9D1D9;">, </span><span style="color:#A5D6FF;">&#39;alt&#39;</span><span style="color:#C9D1D9;">, </span><span style="color:#A5D6FF;">&#39;meta&#39;</span><span style="color:#C9D1D9;">]</span></span>
<span class="line"><span style="color:#C9D1D9;">            .</span><span style="color:#D2A8FF;">filter</span><span style="color:#C9D1D9;">(</span><span style="color:#FFA657;">keyModifier</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=&gt;</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">!</span><span style="color:#C9D1D9;">modifiers[keyModifier])</span></span>
<span class="line"><span style="color:#C9D1D9;">            .</span><span style="color:#D2A8FF;">map</span><span style="color:#C9D1D9;">(</span><span style="color:#FFA657;">keyModifier</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=&gt;</span><span style="color:#C9D1D9;"> </span><span style="color:#A5D6FF;">\`$event.\${</span><span style="color:#C9D1D9;">keyModifier</span><span style="color:#A5D6FF;">}Key\`</span><span style="color:#C9D1D9;">)</span></span>
<span class="line"><span style="color:#C9D1D9;">            .</span><span style="color:#D2A8FF;">join</span><span style="color:#C9D1D9;">(</span><span style="color:#A5D6FF;">&#39;||&#39;</span><span style="color:#C9D1D9;">)</span></span>
<span class="line"><span style="color:#C9D1D9;">        )</span></span>
<span class="line"><span style="color:#C9D1D9;">      } </span><span style="color:#FF7B72;">else</span><span style="color:#C9D1D9;"> {</span></span>
<span class="line"><span style="color:#C9D1D9;">        keys.</span><span style="color:#D2A8FF;">push</span><span style="color:#C9D1D9;">(key) </span><span style="color:#8B949E;">// \u5982\u679C\u4FEE\u9970\u7B26\u4E0D\u662F\u4EE5\u4E0A\u4FEE\u9970\u7B26\uFF0C\u5219\u4F1A\u6DFB\u52A0\u5230keys\u6570\u7EC4\u4E2D</span></span>
<span class="line"><span style="color:#C9D1D9;">      }</span></span>
<span class="line"><span style="color:#C9D1D9;">    }</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (keys.</span><span style="color:#79C0FF;">length</span><span style="color:#C9D1D9;">) {</span></span>
<span class="line"><span style="color:#C9D1D9;">      code </span><span style="color:#FF7B72;">+=</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">genKeyFilter</span><span style="color:#C9D1D9;">(keys) </span><span style="color:#8B949E;">// \u5904\u7406\u5176\u4ED6\u4FEE\u9970\u7B26 \u5373keyCodes\u4E2D\u5B9A\u4E49\u7684\u4FEE\u9970\u7B26</span></span>
<span class="line"><span style="color:#C9D1D9;">    }</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#8B949E;">// Make sure modifiers like prevent and stop get executed after key filtering</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (genModifierCode) {</span></span>
<span class="line"><span style="color:#C9D1D9;">      code </span><span style="color:#FF7B72;">+=</span><span style="color:#C9D1D9;"> genModifierCode</span></span>
<span class="line"><span style="color:#C9D1D9;">    }</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#8B949E;">// \u6839\u636E\u4E09\u79CD\u4E0D\u540C\u7684\u4E66\u5199\u6A21\u677F\u8FD4\u56DE\u4E0D\u540C\u7684\u5B57\u7B26\u4E32</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">handlerCode</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> isMethodPath</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#FF7B72;">?</span><span style="color:#C9D1D9;"> </span><span style="color:#A5D6FF;">\`return \${</span><span style="color:#C9D1D9;">handler</span><span style="color:#A5D6FF;">.</span><span style="color:#C9D1D9;">value</span><span style="color:#A5D6FF;">}($event)\`</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> isFunctionExpression</span></span>
<span class="line"><span style="color:#C9D1D9;">        </span><span style="color:#FF7B72;">?</span><span style="color:#C9D1D9;"> </span><span style="color:#A5D6FF;">\`return (\${</span><span style="color:#C9D1D9;">handler</span><span style="color:#A5D6FF;">.</span><span style="color:#C9D1D9;">value</span><span style="color:#A5D6FF;">})($event)\`</span></span>
<span class="line"><span style="color:#C9D1D9;">        </span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> isFunctionInvocation</span></span>
<span class="line"><span style="color:#C9D1D9;">          </span><span style="color:#FF7B72;">?</span><span style="color:#C9D1D9;"> </span><span style="color:#A5D6FF;">\`return \${</span><span style="color:#C9D1D9;">handler</span><span style="color:#A5D6FF;">.</span><span style="color:#C9D1D9;">value</span><span style="color:#A5D6FF;">}\`</span></span>
<span class="line"><span style="color:#C9D1D9;">          </span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> handler.value</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#8B949E;">/* istanbul ignore if */</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (__WEEX__ </span><span style="color:#FF7B72;">&amp;&amp;</span><span style="color:#C9D1D9;"> handler.params) {</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#FF7B72;">return</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">genWeexHandler</span><span style="color:#C9D1D9;">(handler.params, code </span><span style="color:#FF7B72;">+</span><span style="color:#C9D1D9;"> handlerCode)</span></span>
<span class="line"><span style="color:#C9D1D9;">    }</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">return</span><span style="color:#C9D1D9;"> </span><span style="color:#A5D6FF;">\`function($event){\${</span><span style="color:#C9D1D9;">code</span><span style="color:#A5D6FF;">}\${</span><span style="color:#C9D1D9;">handlerCode</span><span style="color:#A5D6FF;">}}\`</span></span>
<span class="line"><span style="color:#C9D1D9;">  }</span></span>
<span class="line"><span style="color:#C9D1D9;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8B949E;">// dev/src/compiler/codegen/events.js line 175</span></span>
<span class="line"><span style="color:#FF7B72;">function</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">genFilterCode</span><span style="color:#C9D1D9;"> (</span><span style="color:#FFA657;">key</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">string</span><span style="color:#C9D1D9;">)</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">string</span><span style="color:#C9D1D9;"> {</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">keyVal</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">parseInt</span><span style="color:#C9D1D9;">(key, </span><span style="color:#79C0FF;">10</span><span style="color:#C9D1D9;">)</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (keyVal) { </span><span style="color:#8B949E;">// \u5982\u679Ckey\u662F\u6570\u5B57\uFF0C\u5219\u76F4\u63A5\u8FD4\u56DE$event.keyCode!==\${keyVal}</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">return</span><span style="color:#C9D1D9;"> </span><span style="color:#A5D6FF;">\`$event.keyCode!==\${</span><span style="color:#C9D1D9;">keyVal</span><span style="color:#A5D6FF;">}\`</span></span>
<span class="line"><span style="color:#C9D1D9;">  }</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">keyCode</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> keyCodes[key]</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">keyName</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> keyNames[key]</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#8B949E;">// \u8FD4\u56DE_k\u51FD\u6570\uFF0C\u5B83\u7684\u7B2C\u4E00\u4E2A\u53C2\u6570\u662F$event.keyCode\uFF0C</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#8B949E;">// \u7B2C\u4E8C\u4E2A\u53C2\u6570\u662Fkey\u7684\u503C\uFF0C</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#8B949E;">// \u7B2C\u4E09\u4E2A\u53C2\u6570\u5C31\u662Fkey\u5728keyCodes\u4E2D\u5BF9\u5E94\u7684\u6570\u5B57\u3002</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">return</span><span style="color:#C9D1D9;"> (</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#A5D6FF;">\`_k($event.keyCode,\`</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">+</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#A5D6FF;">\`\${</span><span style="color:#79C0FF;">JSON</span><span style="color:#A5D6FF;">.</span><span style="color:#D2A8FF;">stringify</span><span style="color:#A5D6FF;">(</span><span style="color:#C9D1D9;">key</span><span style="color:#A5D6FF;">)</span><span style="color:#A5D6FF;">},\`</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">+</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#A5D6FF;">\`\${</span><span style="color:#79C0FF;">JSON</span><span style="color:#A5D6FF;">.</span><span style="color:#D2A8FF;">stringify</span><span style="color:#A5D6FF;">(</span><span style="color:#C9D1D9;">keyCode</span><span style="color:#A5D6FF;">)</span><span style="color:#A5D6FF;">},\`</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">+</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#A5D6FF;">\`$event.key,\`</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">+</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#A5D6FF;">\`\${</span><span style="color:#79C0FF;">JSON</span><span style="color:#A5D6FF;">.</span><span style="color:#D2A8FF;">stringify</span><span style="color:#A5D6FF;">(</span><span style="color:#C9D1D9;">keyName</span><span style="color:#A5D6FF;">)</span><span style="color:#A5D6FF;">}\`</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">+</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#A5D6FF;">\`)\`</span></span>
<span class="line"><span style="color:#C9D1D9;">  )</span></span>
<span class="line"><span style="color:#C9D1D9;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br></div></div><h3 id="\u4E8B\u4EF6\u7ED1\u5B9A" tabindex="-1">\u4E8B\u4EF6\u7ED1\u5B9A <a class="header-anchor" href="#\u4E8B\u4EF6\u7ED1\u5B9A" aria-hidden="true">#</a></h3><p>\u524D\u9762\u4ECB\u7ECD\u4E86\u5982\u4F55\u7F16\u8BD1\u6A21\u677F\u63D0\u53D6\u4E8B\u4EF6\u6536\u96C6\u6307\u4EE4\u4EE5\u53CA\u751F\u6210<code>render</code>\u5B57\u7B26\u4E32\u548C<code>render</code>\u51FD\u6570\uFF0C\u4F46\u662F\u4E8B\u4EF6\u771F\u6B63\u7684\u7ED1\u5B9A\u5230<code>DOM</code>\u4E0A\u8FD8\u662F\u79BB\u4E0D\u5F00\u4E8B\u4EF6\u6CE8\u518C\uFF0C\u6B64\u9636\u6BB5\u5C31\u53D1\u751F\u5728<code>patchVnode</code>\u8FC7\u7A0B\u4E2D\uFF0C\u5728\u751F\u6210\u5B8C\u6210<code>VNode</code>\u540E\uFF0C\u8FDB\u884C<code>patchVnode</code>\u8FC7\u7A0B\u4E2D\u521B\u5EFA\u771F\u5B9E<code>DOM</code>\u65F6\u4F1A\u8FDB\u884C\u4E8B\u4EF6\u6CE8\u518C\u7684\u76F8\u5173\u94A9\u5B50\u5904\u7406\u3002</p><div class="language-javascript line-numbers-mode"><button class="copy"></button><span class="lang">javascript</span><pre><code><span class="line"><span style="color:#8B949E;">// dev/src/core/vdom/patch.js line 33</span></span>
<span class="line"><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">hooks</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> [</span><span style="color:#A5D6FF;">&#39;create&#39;</span><span style="color:#C9D1D9;">, </span><span style="color:#A5D6FF;">&#39;activate&#39;</span><span style="color:#C9D1D9;">, </span><span style="color:#A5D6FF;">&#39;update&#39;</span><span style="color:#C9D1D9;">, </span><span style="color:#A5D6FF;">&#39;remove&#39;</span><span style="color:#C9D1D9;">, </span><span style="color:#A5D6FF;">&#39;destroy&#39;</span><span style="color:#C9D1D9;">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8B949E;">// dev/src/core/vdom/patch.js line 125</span></span>
<span class="line"><span style="color:#FF7B72;">function</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">createElm</span><span style="color:#C9D1D9;"> (</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FFA657;">vnode</span><span style="color:#C9D1D9;">,</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FFA657;">insertedVnodeQueue</span><span style="color:#C9D1D9;">,</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FFA657;">parentElm</span><span style="color:#C9D1D9;">,</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FFA657;">refElm</span><span style="color:#C9D1D9;">,</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FFA657;">nested</span><span style="color:#C9D1D9;">,</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FFA657;">ownerArray</span><span style="color:#C9D1D9;">,</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FFA657;">index</span></span>
<span class="line"><span style="color:#C9D1D9;">  ) {</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#8B949E;">// ...</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (</span><span style="color:#D2A8FF;">isDef</span><span style="color:#C9D1D9;">(data)) {</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#D2A8FF;">invokeCreateHooks</span><span style="color:#C9D1D9;">(vnode, insertedVnodeQueue)</span></span>
<span class="line"><span style="color:#C9D1D9;">  }</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#8B949E;">// ...</span></span>
<span class="line"><span style="color:#C9D1D9;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8B949E;">// dev/src/core/vdom/patch.js line 303</span></span>
<span class="line"><span style="color:#8B949E;">// \u5728\u4E4B\u524Dcbs\u7ECF\u8FC7\u5904\u7406 </span></span>
<span class="line"><span style="color:#8B949E;">// \u8FD9\u91CCcbs.create\u5305\u542B\u5982\u4E0B\u51E0\u4E2A\u56DE\u8C03\uFF1A</span></span>
<span class="line"><span style="color:#8B949E;">// updateAttrs\u3001updateClass\u3001updateDOMListeners\u3001updateDOMProps\u3001updateStyle\u3001update\u3001updateDirectives</span></span>
<span class="line"><span style="color:#FF7B72;">function</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">invokeCreateHooks</span><span style="color:#C9D1D9;"> (</span><span style="color:#FFA657;">vnode</span><span style="color:#C9D1D9;">, </span><span style="color:#FFA657;">insertedVnodeQueue</span><span style="color:#C9D1D9;">) {</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">for</span><span style="color:#C9D1D9;"> (</span><span style="color:#FF7B72;">let</span><span style="color:#C9D1D9;"> i </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">0</span><span style="color:#C9D1D9;">; i </span><span style="color:#FF7B72;">&lt;</span><span style="color:#C9D1D9;"> cbs.create.</span><span style="color:#79C0FF;">length</span><span style="color:#C9D1D9;">; </span><span style="color:#FF7B72;">++</span><span style="color:#C9D1D9;">i) {</span></span>
<span class="line"><span style="color:#C9D1D9;">      cbs.create[i](emptyNode, vnode)</span></span>
<span class="line"><span style="color:#C9D1D9;">    }</span></span>
<span class="line"><span style="color:#C9D1D9;">    i </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> vnode.data.hook </span><span style="color:#8B949E;">// Reuse variable</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (</span><span style="color:#D2A8FF;">isDef</span><span style="color:#C9D1D9;">(i)) {</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (</span><span style="color:#D2A8FF;">isDef</span><span style="color:#C9D1D9;">(i.create)) i.</span><span style="color:#D2A8FF;">create</span><span style="color:#C9D1D9;">(emptyNode, vnode)</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (</span><span style="color:#D2A8FF;">isDef</span><span style="color:#C9D1D9;">(i.insert)) insertedVnodeQueue.</span><span style="color:#D2A8FF;">push</span><span style="color:#C9D1D9;">(vnode)</span></span>
<span class="line"><span style="color:#C9D1D9;">    }</span></span>
<span class="line"><span style="color:#C9D1D9;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br></div></div><p><code>invokeCreateHooks</code>\u5C31\u662F\u4E00\u4E2A\u6A21\u677F\u6307\u4EE4\u5904\u7406\u7684\u4EFB\u52A1\uFF0C\u4ED6\u5206\u522B\u9488\u5BF9\u4E0D\u540C\u7684\u6307\u4EE4\u4E3A\u771F\u5B9E\u9636\u6BB5\u521B\u5EFA\u4E0D\u540C\u7684\u4EFB\u52A1\uFF0C\u9488\u5BF9\u4E8B\u4EF6\uFF0C\u8FD9\u91CC\u4F1A\u8C03<code>updateDOMListeners</code>\u5BF9\u771F\u5B9E\u7684<code>DOM</code>\u8282\u70B9\u6CE8\u518C\u4E8B\u4EF6\u4EFB\u52A1\u3002</p><div class="language-javascript line-numbers-mode"><button class="copy"></button><span class="lang">javascript</span><pre><code><span class="line"><span style="color:#8B949E;">// dev/src/platforms/web/runtime/modules/events.js line 105</span></span>
<span class="line"><span style="color:#FF7B72;">function</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">updateDOMListeners</span><span style="color:#C9D1D9;"> (</span><span style="color:#FFA657;">oldVnode</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#FFA657;">VNodeWithData</span><span style="color:#C9D1D9;">, </span><span style="color:#FFA657;">vnode</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#FFA657;">VNodeWithData</span><span style="color:#C9D1D9;">) {</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (</span><span style="color:#D2A8FF;">isUndef</span><span style="color:#C9D1D9;">(oldVnode.data.on) </span><span style="color:#FF7B72;">&amp;&amp;</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">isUndef</span><span style="color:#C9D1D9;">(vnode.data.on)) {  </span><span style="color:#8B949E;">// on\u662F\u4E8B\u4EF6\u6307\u4EE4\u7684\u6807\u5FD7</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">return</span></span>
<span class="line"><span style="color:#C9D1D9;">  }</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#8B949E;">// \u65B0\u65E7\u8282\u70B9\u4E0D\u540C\u7684\u4E8B\u4EF6\u7ED1\u5B9A\u89E3\u7ED1</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">on</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> vnode.data.on </span><span style="color:#FF7B72;">||</span><span style="color:#C9D1D9;"> {}</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">oldOn</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> oldVnode.data.on </span><span style="color:#FF7B72;">||</span><span style="color:#C9D1D9;"> {}</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#8B949E;">// \u62FF\u5230\u9700\u8981\u6DFB\u52A0\u4E8B\u4EF6\u7684\u771F\u5B9EDOM\u8282\u70B9</span></span>
<span class="line"><span style="color:#C9D1D9;">  target </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> vnode.elm</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#8B949E;">// normalizeEvents\u662F\u5BF9\u4E8B\u4EF6\u517C\u5BB9\u6027\u7684\u5904\u7406</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#D2A8FF;">normalizeEvents</span><span style="color:#C9D1D9;">(on)</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#8B949E;">// \u8C03\u7528updateListeners\u65B9\u6CD5\uFF0C\u5E76\u5C06on\u4F5C\u4E3A\u53C2\u6570\u4F20\u8FDB\u53BB</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#D2A8FF;">updateListeners</span><span style="color:#C9D1D9;">(on, oldOn, add, remove, createOnceHandler, vnode.context)</span></span>
<span class="line"><span style="color:#C9D1D9;">  target </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">undefined</span></span>
<span class="line"><span style="color:#C9D1D9;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8B949E;">// dev/src/core/vdom/helpers/update-listeners.js line line 53</span></span>
<span class="line"><span style="color:#FF7B72;">export</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">function</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">updateListeners</span><span style="color:#C9D1D9;"> (</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FFA657;">on</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#FFA657;">Object</span><span style="color:#C9D1D9;">,</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FFA657;">oldOn</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#FFA657;">Object</span><span style="color:#C9D1D9;">,</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#D2A8FF;">add</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#FFA657;">Function</span><span style="color:#C9D1D9;">,</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#D2A8FF;">remove</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#FFA657;">Function</span><span style="color:#C9D1D9;">,</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#D2A8FF;">createOnceHandler</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#FFA657;">Function</span><span style="color:#C9D1D9;">,</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FFA657;">vm</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#FFA657;">Component</span></span>
<span class="line"><span style="color:#C9D1D9;">) {</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">let</span><span style="color:#C9D1D9;"> name, def, cur, old, event</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">for</span><span style="color:#C9D1D9;"> (name </span><span style="color:#FF7B72;">in</span><span style="color:#C9D1D9;"> on) { </span><span style="color:#8B949E;">// \u904D\u5386\u4E8B\u4EF6</span></span>
<span class="line"><span style="color:#C9D1D9;">    def </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> cur </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> on[name]</span></span>
<span class="line"><span style="color:#C9D1D9;">    old </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> oldOn[name]</span></span>
<span class="line"><span style="color:#C9D1D9;">    event </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">normalizeEvent</span><span style="color:#C9D1D9;">(name)</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#8B949E;">/* istanbul ignore if */</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (__WEEX__ </span><span style="color:#FF7B72;">&amp;&amp;</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">isPlainObject</span><span style="color:#C9D1D9;">(def)) {</span></span>
<span class="line"><span style="color:#C9D1D9;">      cur </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> def.handler</span></span>
<span class="line"><span style="color:#C9D1D9;">      event.params </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> def.params</span></span>
<span class="line"><span style="color:#C9D1D9;">    }</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (</span><span style="color:#D2A8FF;">isUndef</span><span style="color:#C9D1D9;">(cur)) { </span><span style="color:#8B949E;">// \u4E8B\u4EF6\u540D\u975E\u6CD5\u7684\u62A5\u9519\u5904\u7406</span></span>
<span class="line"><span style="color:#C9D1D9;">      p<wbr>rocess.env.</span><span style="color:#79C0FF;">NODE_ENV</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">!==</span><span style="color:#C9D1D9;"> </span><span style="color:#A5D6FF;">&#39;production&#39;</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">&amp;&amp;</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">warn</span><span style="color:#C9D1D9;">(</span></span>
<span class="line"><span style="color:#C9D1D9;">        </span><span style="color:#A5D6FF;">\`Invalid handler for event &quot;\${</span><span style="color:#C9D1D9;">event</span><span style="color:#A5D6FF;">.</span><span style="color:#C9D1D9;">name</span><span style="color:#A5D6FF;">}&quot;: got \`</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">+</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">String</span><span style="color:#C9D1D9;">(cur),</span></span>
<span class="line"><span style="color:#C9D1D9;">        vm</span></span>
<span class="line"><span style="color:#C9D1D9;">      )</span></span>
<span class="line"><span style="color:#C9D1D9;">    } </span><span style="color:#FF7B72;">else</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (</span><span style="color:#D2A8FF;">isUndef</span><span style="color:#C9D1D9;">(old)) { </span><span style="color:#8B949E;">// \u65E7\u8282\u70B9\u4E0D\u5B58\u5728</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (</span><span style="color:#D2A8FF;">isUndef</span><span style="color:#C9D1D9;">(cur.fns)) { </span><span style="color:#8B949E;">// createFunInvoker\u8FD4\u56DE\u4E8B\u4EF6\u6700\u7EC8\u6267\u884C\u7684\u56DE\u8C03\u51FD\u6570</span></span>
<span class="line"><span style="color:#C9D1D9;">        cur </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> on[name] </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">createFnInvoker</span><span style="color:#C9D1D9;">(cur, vm)</span></span>
<span class="line"><span style="color:#C9D1D9;">      }</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (</span><span style="color:#D2A8FF;">isTrue</span><span style="color:#C9D1D9;">(event.once)) {  </span><span style="color:#8B949E;">// \u53EA\u89E6\u53D1\u4E00\u6B21\u7684\u4E8B\u4EF6</span></span>
<span class="line"><span style="color:#C9D1D9;">        cur </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> on[name] </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">createOnceHandler</span><span style="color:#C9D1D9;">(event.name, cur, event.capture)</span></span>
<span class="line"><span style="color:#C9D1D9;">      }</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#8B949E;">// \u6267\u884C\u771F\u6B63\u6CE8\u518C\u4E8B\u4EF6\u7684\u6267\u884C\u51FD\u6570</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#D2A8FF;">add</span><span style="color:#C9D1D9;">(event.name, cur, event.capture, event.passive, event.params)</span></span>
<span class="line"><span style="color:#C9D1D9;">    } </span><span style="color:#FF7B72;">else</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (cur </span><span style="color:#FF7B72;">!==</span><span style="color:#C9D1D9;"> old) {</span></span>
<span class="line"><span style="color:#C9D1D9;">      old.fns </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> cur</span></span>
<span class="line"><span style="color:#C9D1D9;">      on[name] </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> old</span></span>
<span class="line"><span style="color:#C9D1D9;">    }</span></span>
<span class="line"><span style="color:#C9D1D9;">  }</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">for</span><span style="color:#C9D1D9;"> (name </span><span style="color:#FF7B72;">in</span><span style="color:#C9D1D9;"> oldOn) { </span><span style="color:#8B949E;">// \u65E7\u8282\u70B9\u5B58\u5728\uFF0C\u89E3\u9664\u65E7\u8282\u70B9\u4E0A\u7684\u7ED1\u5B9A\u4E8B\u4EF6</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (</span><span style="color:#D2A8FF;">isUndef</span><span style="color:#C9D1D9;">(on[name])) {</span></span>
<span class="line"><span style="color:#C9D1D9;">      event </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">normalizeEvent</span><span style="color:#C9D1D9;">(name)</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#8B949E;">// \u79FB\u9664\u4E8B\u4EF6\u76D1\u542C</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#D2A8FF;">remove</span><span style="color:#C9D1D9;">(event.name, oldOn[name], event.capture)</span></span>
<span class="line"><span style="color:#C9D1D9;">    }</span></span>
<span class="line"><span style="color:#C9D1D9;">  }</span></span>
<span class="line"><span style="color:#C9D1D9;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8B949E;">// dev/src/platforms/web/runtime/modules/events.js line 32</span></span>
<span class="line"><span style="color:#8B949E;">// \u5728\u6267\u884C\u5B8C\u56DE\u8C03\u4E4B\u540E\uFF0C\u79FB\u9664\u4E8B\u4EF6\u7ED1\u5B9A</span></span>
<span class="line"><span style="color:#FF7B72;">function</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">createOnceHandler</span><span style="color:#C9D1D9;"> (</span><span style="color:#FFA657;">event</span><span style="color:#C9D1D9;">, </span><span style="color:#FFA657;">handler</span><span style="color:#C9D1D9;">, </span><span style="color:#FFA657;">capture</span><span style="color:#C9D1D9;">) {</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">_target</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> target </span><span style="color:#8B949E;">// save current target element in closure</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">return</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">function</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">onceHandler</span><span style="color:#C9D1D9;"> () {</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">res</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> handler.</span><span style="color:#D2A8FF;">apply</span><span style="color:#C9D1D9;">(</span><span style="color:#79C0FF;">null</span><span style="color:#C9D1D9;">, </span><span style="color:#79C0FF;">arguments</span><span style="color:#C9D1D9;">)</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (res </span><span style="color:#FF7B72;">!==</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">null</span><span style="color:#C9D1D9;">) {</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#D2A8FF;">remove</span><span style="color:#C9D1D9;">(event, onceHandler, capture, _target)</span></span>
<span class="line"><span style="color:#C9D1D9;">    }</span></span>
<span class="line"><span style="color:#C9D1D9;">  }</span></span>
<span class="line"><span style="color:#C9D1D9;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br></div></div><p>\u6700\u7EC8\u6DFB\u52A0\u4E0E\u79FB\u9664\u4E8B\u4EF6\u90FD\u662F\u8C03\u7528\u7684<code>add</code>\u4E0E<code>remove</code>\u65B9\u6CD5\uFF0C\u6700\u7EC8\u8C03\u7528\u7684\u65B9\u6CD5\u5373<code>DOM</code>\u7684<code>addEventListener</code>\u65B9\u6CD5\u4E0E<code>removeEventListener</code>\u65B9\u6CD5\u3002</p><div class="language-javascript line-numbers-mode"><button class="copy"></button><span class="lang">javascript</span><pre><code><span class="line"><span style="color:#8B949E;">// dev/src/platforms/web/runtime/modules/events.js line 46</span></span>
<span class="line"><span style="color:#FF7B72;">function</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">add</span><span style="color:#C9D1D9;"> (</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FFA657;">name</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">string</span><span style="color:#C9D1D9;">,</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#D2A8FF;">handler</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#FFA657;">Function</span><span style="color:#C9D1D9;">,</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FFA657;">capture</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">boolean</span><span style="color:#C9D1D9;">,</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FFA657;">passive</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">boolean</span></span>
<span class="line"><span style="color:#C9D1D9;">) {</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#8B949E;">// async edge case #6566: inner click event triggers patch, event handler</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#8B949E;">// attached to outer element during patch, and triggered again. This</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#8B949E;">// happens because browsers fire microtask ticks between event propagation.</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#8B949E;">// the solution is simple: we save the timestamp when a handler is attached,</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#8B949E;">// and the handler would only fire if the event passed to it was fired</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#8B949E;">// AFTER it was attached.</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (useMicrotaskFix) {</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">attachedTimestamp</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> currentFlushTimestamp</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">original</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> handler</span></span>
<span class="line"><span style="color:#C9D1D9;">    handler </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> original.</span><span style="color:#D2A8FF;">_wrapper</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">function</span><span style="color:#C9D1D9;"> (</span><span style="color:#FFA657;">e</span><span style="color:#C9D1D9;">) {</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (</span></span>
<span class="line"><span style="color:#C9D1D9;">        </span><span style="color:#8B949E;">// no bubbling, should always fire.</span></span>
<span class="line"><span style="color:#C9D1D9;">        </span><span style="color:#8B949E;">// this is just a safety net in case event.timeStamp is unreliable in</span></span>
<span class="line"><span style="color:#C9D1D9;">        </span><span style="color:#8B949E;">// certain weird environments...</span></span>
<span class="line"><span style="color:#C9D1D9;">        e.target </span><span style="color:#FF7B72;">===</span><span style="color:#C9D1D9;"> e.currentTarget </span><span style="color:#FF7B72;">||</span></span>
<span class="line"><span style="color:#C9D1D9;">        </span><span style="color:#8B949E;">// event is fired after handler attachment</span></span>
<span class="line"><span style="color:#C9D1D9;">        e.timeStamp </span><span style="color:#FF7B72;">&gt;=</span><span style="color:#C9D1D9;"> attachedTimestamp </span><span style="color:#FF7B72;">||</span></span>
<span class="line"><span style="color:#C9D1D9;">        </span><span style="color:#8B949E;">// bail for environments that have buggy event.timeStamp implementations</span></span>
<span class="line"><span style="color:#C9D1D9;">        </span><span style="color:#8B949E;">// #9462 iOS 9 bug: event.timeStamp is 0 after history.pushState</span></span>
<span class="line"><span style="color:#C9D1D9;">        </span><span style="color:#8B949E;">// #9681 QtWebEngine event.timeStamp is negative value</span></span>
<span class="line"><span style="color:#C9D1D9;">        e.timeStamp </span><span style="color:#FF7B72;">&lt;=</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">0</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">||</span></span>
<span class="line"><span style="color:#C9D1D9;">        </span><span style="color:#8B949E;">// #9448 bail if event is fired in another document in a multi-page</span></span>
<span class="line"><span style="color:#C9D1D9;">        </span><span style="color:#8B949E;">// electron/nw.js app, since event.timeStamp will be using a different</span></span>
<span class="line"><span style="color:#C9D1D9;">        </span><span style="color:#8B949E;">// starting reference</span></span>
<span class="line"><span style="color:#C9D1D9;">        e.target.ownerDocument </span><span style="color:#FF7B72;">!==</span><span style="color:#C9D1D9;"> document</span></span>
<span class="line"><span style="color:#C9D1D9;">      ) {</span></span>
<span class="line"><span style="color:#C9D1D9;">        </span><span style="color:#FF7B72;">return</span><span style="color:#C9D1D9;"> original.</span><span style="color:#D2A8FF;">apply</span><span style="color:#C9D1D9;">(</span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">, </span><span style="color:#79C0FF;">arguments</span><span style="color:#C9D1D9;">)</span></span>
<span class="line"><span style="color:#C9D1D9;">      }</span></span>
<span class="line"><span style="color:#C9D1D9;">    }</span></span>
<span class="line"><span style="color:#C9D1D9;">  }</span></span>
<span class="line"><span style="color:#C9D1D9;">  target.</span><span style="color:#D2A8FF;">addEventListener</span><span style="color:#C9D1D9;">(</span></span>
<span class="line"><span style="color:#C9D1D9;">    name,</span></span>
<span class="line"><span style="color:#C9D1D9;">    handler,</span></span>
<span class="line"><span style="color:#C9D1D9;">    supportsPassive</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#FF7B72;">?</span><span style="color:#C9D1D9;"> { capture, passive }</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> capture</span></span>
<span class="line"><span style="color:#C9D1D9;">  )</span></span>
<span class="line"><span style="color:#C9D1D9;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8B949E;">// dev/src/platforms/web/runtime/modules/events.js line 92</span></span>
<span class="line"><span style="color:#FF7B72;">function</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">remove</span><span style="color:#C9D1D9;"> (</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FFA657;">name</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">string</span><span style="color:#C9D1D9;">,</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#D2A8FF;">handler</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#FFA657;">Function</span><span style="color:#C9D1D9;">,</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FFA657;">capture</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">boolean</span><span style="color:#C9D1D9;">,</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FFA657;">_target</span><span style="color:#FF7B72;">?:</span><span style="color:#C9D1D9;"> </span><span style="color:#FFA657;">HTMLElement</span></span>
<span class="line"><span style="color:#C9D1D9;">) {</span></span>
<span class="line"><span style="color:#C9D1D9;">  (_target </span><span style="color:#FF7B72;">||</span><span style="color:#C9D1D9;"> target).</span><span style="color:#D2A8FF;">removeEventListener</span><span style="color:#C9D1D9;">(</span></span>
<span class="line"><span style="color:#C9D1D9;">    name,</span></span>
<span class="line"><span style="color:#C9D1D9;">    handler._wrapper </span><span style="color:#FF7B72;">||</span><span style="color:#C9D1D9;"> handler,</span></span>
<span class="line"><span style="color:#C9D1D9;">    capture</span></span>
<span class="line"><span style="color:#C9D1D9;">  )</span></span>
<span class="line"><span style="color:#C9D1D9;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br></div></div><h2 id="\u53C2\u8003" tabindex="-1">\u53C2\u8003 <a class="header-anchor" href="#\u53C2\u8003" aria-hidden="true">#</a></h2><div class="language- line-numbers-mode"><button class="copy"></button><span class="lang"></span><pre><code><span class="line"><span style="color:#c9d1d9;">https://cn.vuejs.org/v2/api/#v-on</span></span>
<span class="line"><span style="color:#c9d1d9;">https://juejin.im/post/6844903919290679304</span></span>
<span class="line"><span style="color:#c9d1d9;">https://juejin.im/post/6844904061897015310</span></span>
<span class="line"><span style="color:#c9d1d9;">https://juejin.im/post/6844904126250221576</span></span>
<span class="line"><span style="color:#c9d1d9;">https://segmentfault.com/a/1190000009750348</span></span>
<span class="line"><span style="color:#c9d1d9;">https://blog.csdn.net/weixin_41275295/article/details/100549145</span></span>
<span class="line"><span style="color:#c9d1d9;">https://developer.mozilla.org/zh-CN/docs/Web/API/EventTarget/addEventListener</span></span>
<span class="line"><span style="color:#c9d1d9;">https://github.com/liutao/vue2.0-source/blob/master/%E4%BA%8B%E4%BB%B6%E5%A4%84%E7%90%86.md</span></span>
<span class="line"><span style="color:#c9d1d9;"></span></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div>`,31),o=[e];function r(c,t,D,y,F,i){return a(),n("div",null,o)}const u=s(p,[["render",r]]);export{b as __pageData,u as default};
